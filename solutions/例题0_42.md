# 例题0.42

## 题目

条件期望： （1）E(X|Y ) 的意义； （2）EX = E(E(X|Y ))； （3）掷一个均匀骰子，点数记为 N，再掷 N 次，点数记为 X1，X2，....，XN ，求 E(PXi)。

## 解答

**Revising Solution and Formatting**

I've finalized the solution, ensuring the distinction between conditional expectation and its realization is crystal clear. The LaTeX formatting has been double-checked for accuracy. Further, I've confirmed the "Sum" interpretation, as the most logical and standard for this textbook example, with a note regarding the typo.


### 题目分析

本题主要考查概率论中的**条件期望**（Conditional Expectation）及其核心性质。
1.  题目中符号 $E(X|Y)$ 表示给定随机变量 $Y$ 条件下 $X$ 的条件期望，这是一个随机变量。
2.  $EX = E(E(X|Y))$ 是全期望公式（Law of Total Expectation），也称为平滑引理或塔式性质（Tower Property）。
3.  第三问是全期望公式的典型应用场景：**随机变量和的期望**（Random Sum of Random Variables）。题目中的“PXi”根据上下文推断为排版错误，应指代求和符号 $\sum X_i$（即求 $S_N = X_1 + \dots + X_N$ 的期望）。如果是指乘积，计算复杂度远超常规例题范畴，故按随机和处理。

### 解题过程

#### （1）$E(X|Y)$ 的意义

条件期望 $E(X|Y)$ 本质上是一个**随机变量**，它是 $Y$ 的函数。
设 $g(y) = E(X|Y=y)$，其中 $E(X|Y=y)$ 是一个实数，表示当 $Y$ 取特定值 $y$ 时 $X$ 的期望值。
那么，$E(X|Y) = g(Y)$。

其具体含义如下：
1.  **作为估计量**：$E(X|Y)$ 是在已知 $Y$ 的信息下，对 $X$ 的最佳均方预测（即 $E[(X - f(Y))^2]$ 达到最小的函数 $f(Y)$ 就是 $E(X|Y)$）。
2.  **取值特性**：当随机变量 $Y$ 取值为 $y$ 时，随机变量 $E(X|Y)$ 的取值等于普通期望 $E(X|Y=y)$。

#### （2）证明 $EX = E(E(X|Y))$

此性质称为**全期望公式**。以下以离散型随机变量为例进行推导（连续型同理，只需将求和改为积分）：

根据期望的定义，对于随机变量 $Z = E(X|Y)$，其期望为：
$$
E[E(X|Y)] = \sum_{y} E(X|Y=y) \cdot P(Y=y)
$$
将条件期望 $E(X|Y=y)$ 展开为条件概率的加权和：
$$
E(X|Y=y) = \sum_{x} x \cdot P(X=x | Y=y)
$$
代入上式：
$$
\begin{aligned}
E[E(X|Y)] &= \sum_{y} \left( \sum_{x} x \cdot P(X=x | Y=y) \right) P(Y=y) \\
&= \sum_{y} \sum_{x} x \cdot P(X=x | Y=y) P(Y=y)
\end{aligned}
$$
利用乘法公式 $P(X=x | Y=y) P(Y=y) = P(X=x, Y=y)$：
$$
\begin{aligned}
E[E(X|Y)] &= \sum_{x} x \sum_{y} P(X=x, Y=y) \\
&= \sum_{x} x \cdot P(X=x) \quad (\text{利用边缘概率公式}) \\
&= E[X]
\end{aligned}
$$
证毕。

#### （3）掷骰子问题

**设定变量：**
*   设 $N$ 为第一次掷骰子的点数，$N \sim U\{1, 2, 3, 4, 5, 6\}$。
*   设 $X_i$ 为第 $i$ 次掷骰子的点数（$i=1, \dots, N$），$X_i \sim U\{1, 2, 3, 4, 5, 6\}$。
*   假设各次掷骰子相互独立，即 $X_i$ 相互独立且与 $N$ 独立。
*   令 $S = \sum_{i=1}^{N} X_i$ （即题目中的 $PXi$）。

**目标：** 求解 $E[S]$。

**步骤 1：计算 $N$ 和 $X_i$ 的期望**
由于是均匀骰子：
$$
E[N] = \frac{1+2+3+4+5+6}{6} = 3.5
$$
同理，对于任意 $i$：
$$
E[X_i] = 3.5
$$

**步骤 2：利用全期望公式**
根据第（2）问的结论：
$$
E[S] = E[E(S|N)]
$$

**步骤 3：计算内部条件期望 $E(S|N)$**
当 $N=n$ 时，$S$ 是 $n$ 个独立同分布随机变量的和：
$$
E(S|N=n) = E\left[ \sum_{i=1}^{n} X_i \right] = \sum_{i=1}^{n} E[X_i] = n \cdot E[X_1]
$$
因此，作为一个随机变量（关于 $N$ 的函数）：
$$
E(S|N) = N \cdot E[X_1]
$$

**步骤 4：计算最终期望**
$$
\begin{aligned}
E[S] &= E[N \cdot E[X_1]] \\
&= E[X_1] \cdot E[N] \quad (\text{因为 } E[X_1] \text{ 是常数}) \\
&= 3.5 \times 3.5 \\
&= 12.25
\end{aligned}
$$

### 答案

1.  $E(X|Y)$ 是一个随机变量，它是 $Y$ 的函数，表示在给定 $Y$ 的条件下 $X$ 的平均取值。
2.  $EX = E(E(X|Y))$。
3.  $E\left(\sum_{i=1}^N X_i\right) = 12.25$。

### 知识延伸

1.  **瓦尔德等式 (Wald's Equation)**：
    本题第（3）问推导出的结论 $E[\sum_{i=1}^N X_i] = E[N] \cdot E[X]$ 即为著名的瓦尔德等式。
    *   **适用条件**：$X_i$ 独立同分布，$N$ 是取正整数值的停时（Stopping Time）或与 $X_i$ 序列独立。

2.  **随机和的方差 (Eve's Law / Law of Total Variance)**：
    如果要求方差，需使用公式：
    $$
    Var(S) = E[N]Var(X) + (E[X])^2 Var(N)
    $$
    这体现了随机和的波动来源两部分：各项数值本身的波动（第一项）和项数 $N$ 的波动（第二项）。

3.  **几何意义**：
    在希尔伯特空间 $L^2$ 中，条件期望 $E(X|Y)$ 可以看作是随机变量 $X$ 在由 $Y$ 生成的子空间上的**正交投影**。全期望公式 $E[X] = E[E(X|Y)]$ 对应于投影的平均性质。

---
