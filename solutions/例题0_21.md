# 例题0.21

## 题目

已知X 的密度函数，Y 的密度函数。若 X，Y 独立，求Z = X + Y 的密度函数。

## 解答

**Calculating**

\n\nI've now finalized the structure and steps for solving the problem. The core will involve deriving the convolution formula, as specific density functions aren't provided. I'm focusing on rigorous mathematical presentation and ensuring LaTeX is used correctly. The emphasis remains on a clear, direct derivation of the formula and avoiding any unnecessary introduction or explanation.


### 题目分析

本题考查的核心概念是**连续型随机变量函数的分布**，具体为**独立随机变量之和的概率密度函数**。

*   **符号识别**：
    *   $X, Y$：连续型随机变量。
    *   $f_X(x), f_Y(y)$：分别为 $X$ 和 $Y$ 的概率密度函数（PDF）。
    *   $Z = X + Y$：目标随机变量。
    *   $f_Z(z)$：待求的 $Z$ 的概率密度函数。
*   **核心考点**：
    *   利用分布函数法（CDF）求解随机变量函数的分布。
    *   二重积分的计算与求导。
    *   **卷积公式（Convolution Formula）**的推导与应用。
*   **求解目标**：推导并给出 $Z = X + Y$ 的概率密度函数 $f_Z(z)$ 的一般表达式。

### 解题过程

设 $Z = X + Y$，首先求 $Z$ 的分布函数 $F_Z(z)$。根据定义：
$$F_Z(z) = P(Z \le z) = P(X + Y \le z)$$

由于 $X$ 和 $Y$ 相互独立，其联合概率密度函数 $f(x, y)$ 等于边缘密度函数的乘积：
$$f(x, y) = f_X(x) f_Y(y)$$

根据连续型随机变量概率的计算公式，上述概率可以表示为积分区域 $D = \{(x, y) \mid x + y \le z\}$ 上的二重积分：
$$F_Z(z) = \iint_{x+y \le z} f_X(x) f_Y(y) \, dx \, dy$$

我们将积分化为累次积分。固定 $x$，则 $y$ 的范围是 $(-\infty, z-x]$；$x$ 的范围是 $(-\infty, +\infty)$：
$$F_Z(z) = \int_{-\infty}^{+\infty} \left[ \int_{-\infty}^{z-x} f_Y(y) \, dy \right] f_X(x) \, dx$$

为了求概率密度函数 $f_Z(z)$，我们需要对分布函数 $F_Z(z)$ 关于 $z$ 求导：
$$f_Z(z) = \frac{d}{dz} F_Z(z) = \frac{d}{dz} \int_{-\infty}^{+\infty} f_X(x) \left[ \int_{-\infty}^{z-x} f_Y(y) \, dy \right] dx$$

假设积分与求导运算可以交换顺序（满足莱布尼茨积分法则的正则性条件），我们将求导符号移入积分号内部：
$$f_Z(z) = \int_{-\infty}^{+\infty} f_X(x) \left[ \frac{d}{dz} \int_{-\infty}^{z-x} f_Y(y) \, dy \right] dx$$

观察中括号内的部分，令 $G(u) = \int_{-\infty}^{u} f_Y(y) dy$，则中括号内为 $\frac{d}{dz} G(z-x)$。根据链式法则：
$$\frac{d}{dz} \int_{-\infty}^{z-x} f_Y(y) \, dy = f_Y(z-x) \cdot \frac{d}{dz}(z-x) = f_Y(z-x) \cdot 1 = f_Y(z-x)$$

将此结果代回原积分式，得到：
$$f_Z(z) = \int_{-\infty}^{+\infty} f_X(x) f_Y(z-x) \, dx$$

同理，若交换 $X$ 和 $Y$ 的积分次序，也可得到对称形式：
$$f_Z(z) = \int_{-\infty}^{+\infty} f_Y(y) f_X(z-y) \, dy$$

### 答案

若 $X$ 和 $Y$ 独立，且具有密度函数 $f_X$ 和 $f_Y$，则 $Z = X + Y$ 的密度函数为：
$$f_Z(z) = \int_{-\infty}^{+\infty} f_X(x) f_Y(z-x) \, dx$$
或者
$$f_Z(z) = \int_{-\infty}^{+\infty} f_Y(y) f_X(z-y) \, dy$$
此公式称为 $f_X$ 与 $f_Y$ 的**卷积**，记作 $f_Z = f_X * f_Y$。

### 知识延伸

1.  **卷积定理**：
    两个独立连续随机变量之和的密度函数是它们各自密度函数的卷积。
    公式：$f_{X+Y}(z) = (f_X * f_Y)(z)$。

2.  **离散情况**：
    若 $X, Y$ 为独立离散随机变量，其和的分布律为卷积和：
    $$P(Z=k) = \sum_{i} P(X=i) P(Y=k-i)$$

3.  **重要性质**：
    *   **交换律**：$f_X * f_Y = f_Y * f_X$。
    *   **正态分布的可加性**：若 $X \sim N(\mu_1, \sigma_1^2), Y \sim N(\mu_2, \sigma_2^2)$ 且独立，则 $X+Y \sim N(\mu_1+\mu_2, \sigma_1^2+\sigma_2^2)$。直接利用卷积公式计算较为繁琐，通常利用特征函数或矩母函数证明。
    *   **伽玛分布的可加性**：若 $X \sim \Gamma(\alpha_1, \lambda), Y \sim \Gamma(\alpha_2, \lambda)$ 且独立，则 $X+Y \sim \Gamma(\alpha_1+\alpha_2, \lambda)$。

4.  **解题技巧与易错点**：
    *   **确定积分限**：这是应用卷积公式最关键的一步。虽然公式写的是 $(-\infty, +\infty)$，但实际计算时必须根据 $f_X(x)$ 和 $f_Y(z-x)$ 的非零区间确定有效的积分范围（即 $f_X(x) > 0$ 且 $f_Y(z-x) > 0$ 的交集）。
    *   **特征函数法**：对于某些复杂的密度函数，先求特征函数（或矩母函数），利用 $\varphi_{X+Y}(t) = \varphi_X(t)\varphi_Y(t)$，再进行逆变换往往更简单。

---
