# 习题0.8

## 题目

在《万里归途》电影里有一个情景，穆夫塔刁难宗大伟，发起“轮盘赌”。现设枪中子弹数服从概率为 $\frac{1} {2}$ 的0-1 两点分布。请细化概率模型，分析随着“轮盘赌”进行，枪中无子弹的概率是如何变化的？具体地，无子弹的初始概率为 $\frac1 2$ 。选择至少两个概率模型（必要时可以改变两轮之间的规则)，分析第 $i \geq1$ 枪后无子弹的概率。

## 解答

**Refining the Models**

I'm now putting the finishing touches on the probability models. I've successfully drafted both the "no respin" and "respin" scenarios, including the necessary calculations. I'm focusing on clarifying the language and ensuring the mathematical rigor meets the standard expected by a probability professor. The knowledge extension section is also taking shape.


### 题目分析

本题考查的核心概念是**贝叶斯公式（Bayes' Theorem）**与**条件概率**。题目描述了一个参数推断问题：基于观测到的数据（连续 $i$ 次扣动扳机未击发），更新对系统内部状态（枪中是否有子弹）的概率估计。

我们需要建立数学模型来描述“轮盘赌”的机制，设定假设空间（枪空 $H_0$ vs 枪有一弹 $H_1$），并计算在事件 $A_i$（前 $i$ 枪均为哑火）发生的条件下，事件 $H_0$ 的后验概率。

需要求解的目标是：$P(\text{无子弹} \mid \text{前 } i \text{ 枪未响})$。

### 解题过程

设随机变量 $K$ 表示枪中的子弹数量。根据题意，初始分布（先验概率）为：
$$P(K=0) = \frac{1}{2}, \quad P(K=1) = \frac{1}{2}$$
设左轮手枪的弹巢容量为 $N$（通常 $N=6$）。
记事件 $A_i$ 为“前 $i$ 次扣动扳机均未击发子弹”（即幸存了 $i$ 轮）。

我们需要计算的是第 $i$ 枪之后，枪中无子弹的后验概率，即 $P(K=0 \mid A_i)$。
根据贝叶斯公式：
$$P(K=0 \mid A_i) = \frac{P(A_i \mid K=0)P(K=0)}{P(A_i \mid K=0)P(K=0) + P(A_i \mid K=1)P(K=1)}$$
由于 $P(K=0) = P(K=1) = \frac{1}{2}$，公式可简化为：
$$P(K=0 \mid A_i) = \frac{P(A_i \mid K=0)}{P(A_i \mid K=0) + P(A_i \mid K=1)}$$
显然，如果枪中无子弹，无论扣动多少次都不会击发，故对于任意模型：
$$P(A_i \mid K=0) = 1$$
因此，核心在于计算似然概率 $P(A_i \mid K=1)$，这取决于具体的游戏规则。

#### 模型一：标准轮盘赌（不重转模型）

**规则设定**：
在装入子弹（如果有）后，转动一次弹巢，随后连续扣动扳机，中间不再转动弹巢。这对应于**不放回抽样**。

**推导**：
假设枪中有1颗子弹，分布在 $N$ 个弹巢中的任意一个位置是等可能的。
在前 $i$ 次射击中，只要子弹不在前 $i$ 个被撞击的弹巢位置，就不会击发。
共有 $N$ 种可能的子弹位置，其中有 $N-i$ 种位置会导致前 $i$ 枪不响（即子弹位于剩下的 $N-i$ 个位置中）。
因此，在 $K=1$ 的条件下，前 $i$ 枪不响的概率为：
$$P(A_i \mid K=1) = \frac{N-i}{N}, \quad \text{其中 } 1 \leq i < N$$
*注：若 $i=N$ 且未响，则必然无子弹（假设枪支功能正常），此时概率跃升为1。*

代入贝叶斯公式：
$$
\begin{aligned}
P(K=0 \mid A_i) &= \frac{1}{1 + \frac{N-i}{N}} \\
&= \frac{N}{N + N - i} \\
&= \frac{N}{2N - i}
\end{aligned}
$$

**分析**：
随着 $i$ 的增加，分母 $2N-i$ 减小，概率 $P(K=0 \mid A_i)$ 单调递增。这意味着每幸存一枪，枪里没子弹的可能性就越大。

#### 模型二：独立轮盘赌（重转模型）

**规则设定**：
每次扣动扳机前，都重新随机转动弹巢。这对应于**有放回抽样**（独立伯努利试验）。

**推导**：
假设枪中有1颗子弹。每次射击时，击发的概率为 $\frac{1}{N}$，未击发的概率为 $1 - \frac{1}{N}$。
由于每次射击前都重转，各次射击结果相互独立。
因此，在 $K=1$ 的条件下，连续 $i$ 次不击发的概率为：
$$P(A_i \mid K=1) = \left(1 - \frac{1}{N}\right)^i$$

代入贝叶斯公式：
$$
\begin{aligned}
P(K=0 \mid A_i) &= \frac{1}{1 + \left(1 - \frac{1}{N}\right)^i} \\
&= \frac{1}{1 + \left(\frac{N-1}{N}\right)^i}
\end{aligned}
$$

**分析**：
由于 $0 < \frac{N-1}{N} < 1$，当 $i$ 增加时，$\left(\frac{N-1}{N}\right)^i$ 单调递减趋向于0。因此分母减小，整体概率 $P(K=0 \mid A_i)$ 单调递增并趋向于1。

---

### 答案

设弹巢容量为 $N$（一般 $N=6$），第 $i$ 枪后无子弹的概率记为 $P_i$。

1.  **模型一（不重转，不放回）**：
    $$P_i = \frac{N}{2N - i}, \quad (1 \leq i < N)$$
    若 $N=6$，则 $P_i = \frac{6}{12-i}$。

2.  **模型二（每次重转，有放回）**：
    $$P_i = \frac{1}{1 + \left(\frac{N-1}{N}\right)^i}, \quad (i \geq 1)$$
    若 $N=6$，则 $P_i = \frac{1}{1 + (5/6)^i}$。

### 知识延伸

1.  **贝叶斯推断（Bayesian Inference）**：本题是典型的贝叶斯更新过程。初始概率（先验）为 $0.5$，随着观测数据（枪未响）的积累，我们不断修正对假设（无子弹）的信心（后验概率）。
2.  **似然比（Likelihood Ratio）**：
    $$L(Data) = \frac{P(Data \mid H_0)}{P(Data \mid H_1)}$$
    在本题中，随着 $i$ 增大，似然比 $L$ 迅速增大，导致后验概率向 $H_0$ 倾斜。
3.  **易错点**：
    *   混淆“下一枪不响的概率”与“枪中无子弹的概率”。前者是预测未来，后者是推断状态。
    *   在模型一中忽略 $i$ 的取值范围。当 $i=N$ 时，如果还没响，模型一中无子弹的概率直接变为 1（确定性事件），而模型二中永远只能无限接近 1。
4.  **直观理解**：如果枪里真的有子弹，连续很多次不响是小概率事件。既然发生了“连续不响”这个事实，那么“枪里其实没子弹”这个解释就变得越来越可信。

---
