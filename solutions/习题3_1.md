# 习题3.1

## 题目

假设 $\mathrm{X}=( X_{n} , \; \; n \geq0 )$ 是一个状态空间为 $\{1 , \ 2 , \ 3 \}$ 的马尔可夫链，转移矩阵为 $$ \mathrm{P}=\left( \begin{array} {c c c} {0 . 3} & {0 . 2} & {0 . 5} \\ {0 . 5} & {0 . 1} & {0 . 4} \\ {0 . 5} & {0 . 2} & {0 . 3} \\ \end{array} \right) $$ 如果 $\boldsymbol{p}_{0}=( 0 . 5 , ~ 0 . 5 , ~ 0 )$ ，求 （1) $P ( X_{0}=2 , \, \, \, X_{1}=2 , \, \, \, X_{2}=1 ) .$ , (2) $P ( X_{1}=2 , \, \, \, X_{2}=2 , \, \, \, X_{3}=1 ) .$

## 解答

**Summarizing Calculations**

I've confirmed the matrix indices, initial distribution, and all calculations. The output is accurate, the notation is standard, and it directly addresses the prompt's requirements. Now, the final response is ready to be generated in the requested format.


### 题目分析

本题考查离散时间马尔可夫链（Discrete-time Markov Chain, DTMC）的基本性质。
题目给出了状态空间 $S=\{1, 2, 3\}$、一步转移概率矩阵 $P$ 以及初始分布 $\boldsymbol{p}_{0}$。
需要求解的目标是两个特定路径（有限维联合分布）的概率：
1.  从 $n=0$ 时刻开始的路径概率 $P ( X_{0}=2 , \, X_{1}=2 , \, X_{2}=1 )$。
2.  从 $n=1$ 时刻开始的路径概率 $P ( X_{1}=2 , \, X_{2}=2 , \, X_{3}=1 )$。

解题的核心在于利用马尔可夫性（无后效性）将联合概率分解为初始概率与转移概率的乘积。

### 解题过程

已知转移矩阵为：
$$
P = \begin{pmatrix} P_{11} & P_{12} & P_{13} \\ P_{21} & P_{22} & P_{23} \\ P_{31} & P_{32} & P_{33} \end{pmatrix} = \begin{pmatrix} 0.3 & 0.2 & 0.5 \\ 0.5 & 0.1 & 0.4 \\ 0.5 & 0.2 & 0.3 \end{pmatrix}
$$
初始分布为 $\boldsymbol{p}_{0}=( P(X_0=1) , ~ P(X_0=2) , ~ P(X_0=3) ) = ( 0.5 , ~ 0.5 , ~ 0 )$。

#### (1) 求解 $P ( X_{0}=2 , \, X_{1}=2 , \, X_{2}=1 )$

根据马尔可夫链的定义，有限维联合分布可以表示为：
$$
P(X_0=i_0, X_1=i_1, \dots, X_n=i_n) = P(X_0=i_0) P_{i_0 i_1} P_{i_1 i_2} \dots P_{i_{n-1} i_n}
$$
对于本题，令 $i_0=2, i_1=2, i_2=1$，则有：
$$
P ( X_{0}=2 , \, X_{1}=2 , \, X_{2}=1 ) = P(X_0=2) \cdot P_{22} \cdot P_{21}
$$
从已知条件中获取数值：
-   $P(X_0=2) = 0.5$ （由 $\boldsymbol{p}_{0}$ 给出）
-   $P_{22} = 0.1$ （矩阵 $P$ 第2行第2列）
-   $P_{21} = 0.5$ （矩阵 $P$ 第2行第1列）

代入计算：
$$
\begin{aligned}
P ( X_{0}=2 , \, X_{1}=2 , \, X_{2}=1 ) &= 0.5 \times 0.1 \times 0.5 \\
&= 0.025
\end{aligned}
$$

#### (2) 求解 $P ( X_{1}=2 , \, X_{2}=2 , \, X_{3}=1 )$

利用条件概率公式和马尔可夫性，该联合概率可写为：
$$
P ( X_{1}=2 , \, X_{2}=2 , \, X_{3}=1 ) = P(X_1=2) \cdot P(X_2=2 | X_1=2) \cdot P(X_3=1 | X_2=2)
$$
即：
$$
P ( X_{1}=2 , \, X_{2}=2 , \, X_{3}=1 ) = P(X_1=2) \cdot P_{22} \cdot P_{21}
$$
首先需要计算 $X_1$ 的边缘分布 $P(X_1=2)$。根据全概率公式（或矩阵乘法 $\boldsymbol{p}_{1} = \boldsymbol{p}_{0}P$）：
$$
\begin{aligned}
P(X_1=2) &= \sum_{i=1}^{3} P(X_0=i) P_{i2} \\
&= P(X_0=1)P_{12} + P(X_0=2)P_{22} + P(X_0=3)P_{32}
\end{aligned}
$$
代入数值：
$$
\begin{aligned}
P(X_1=2) &= 0.5 \times 0.2 + 0.5 \times 0.1 + 0 \times 0.2 \\
&= 0.1 + 0.05 + 0 \\
&= 0.15
\end{aligned}
$$
现在计算最终结果：
$$
\begin{aligned}
P ( X_{1}=2 , \, X_{2}=2 , \, X_{3}=1 ) &= P(X_1=2) \times P_{22} \times P_{21} \\
&= 0.15 \times 0.1 \times 0.5 \\
&= 0.15 \times 0.05 \\
&= 0.0075
\end{aligned}
$$

### 答案

(1) $P ( X_{0}=2 , \, X_{1}=2 , \, X_{2}=1 ) = 0.025$

(2) $P ( X_{1}=2 , \, X_{2}=2 , \, X_{3}=1 ) = 0.0075$

### 知识延伸

1.  **马尔可夫性（Markov Property）**：
    核心思想是“将来只与现在有关，而与过去无关”。数学表达为：
    $$P(X_{n+1}=j | X_n=i, X_{n-1}=i_{n-1}, \dots, X_0=i_0) = P(X_{n+1}=j | X_n=i) = P_{ij}$$
2.  **路径概率公式**：
    对于齐次马尔可夫链，任意路径的概率等于初始状态概率乘以路径上每一步转移概率的乘积。
3.  **状态分布的演化**：
    $n$ 时刻的状态分布 $\boldsymbol{p}_n$ 可以通过初始分布和转移矩阵的幂次计算：$\boldsymbol{p}_n = \boldsymbol{p}_0 P^n$。在第(2)问中，我们实际上计算了 $\boldsymbol{p}_1$ 的分量。
4.  **易错点提示**：
    -   混淆 $P(X_0=i)$ 和 $P(X_1=i)$。计算非 $0$ 时刻起始的路径时，必须先求出起始时刻的边缘分布。
    -   矩阵行列索引弄反。$P_{ij}$ 表示从 $i$ 到 $j$，对应矩阵的第 $i$ 行第 $j$ 列。

---
