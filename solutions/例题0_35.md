# 例题0.35

## 题目

观察到n 次正面朝上时，共掷了多少次？

## 解答

**Reviewing Problem Interpretation**

I'm now revisiting the problem's core to solidify the approach. I am confident it's a Negative Binomial scenario, but I want to be *absolutely* clear on the interpretation of "how many tosses". The phrasing strongly suggests an expected value, not a specific value given some fixed total tosses. Therefore, I will define N as the total number of tosses and find its expectation. The variance could be a bonus, but not expected.


### 题目分析

本题考查的是**伯努利试验（Bernoulli Trials）**序列中的等待时间问题。具体而言，题目询问的是在独立重复试验中，累积获得 $n$ 次成功（正面朝上）时，所需的总试验次数。这对应于**负二项分布（Negative Binomial Distribution）**的概念。我们需要将总试验次数视为一个随机变量，并求解其**数学期望**。

### 解题过程

设每次掷硬币正面朝上的概率为 $p$（$0 < p \le 1$）。
设随机变量 $N$ 表示观察到第 $n$ 次正面朝上时，总共进行的掷硬币次数。

我们可以将 $N$ 分解为 $n$ 个相互独立的阶段。
设 $X_1$ 为第一次掷出正面朝上所需的次数；
设 $X_2$ 为在第一次正面朝上之后，直到第二次正面朝上所需的额外次数；
...
设 $X_i$ 为在第 $i-1$ 次正面朝上之后，直到第 $i$ 次正面朝上所需的额外次数。

显然，总次数 $N$ 可以表示为：
$$N = X_1 + X_2 + \dots + X_n = \sum_{i=1}^{n} X_i$$

对于每一个 $X_i$，其代表的是在独立重复伯努利试验中，直到获得一次成功所需的试验次数。因此，$X_i$ 服从**几何分布（Geometric Distribution）**。
记为 $X_i \sim Ge(p)$。

根据几何分布的性质，其概率质量函数为：
$$P(X_i = k) = (1-p)^{k-1}p, \quad k=1, 2, \dots$$

几何分布的数学期望为：
$$E[X_i] = \frac{1}{p}$$

利用数学期望的线性性质（Linearity of Expectation），总次数 $N$ 的期望为：
$$
\begin{aligned}
E[N] &= E\left[ \sum_{i=1}^{n} X_i \right] \\
&= \sum_{i=1}^{n} E[X_i] \\
&= \sum_{i=1}^{n} \frac{1}{p} \\
&= n \cdot \frac{1}{p} \\
&= \frac{n}{p}
\end{aligned}
$$

此外，随机变量 $N$ 服从参数为 $(n, p)$ 的负二项分布，其概率质量函数（PMF）为：
$$P(N=k) = \binom{k-1}{n-1} p^n (1-p)^{k-n}, \quad k=n, n+1, \dots$$
这表示在第 $k$ 次试验时恰好出现第 $n$ 次正面，意味着前 $k-1$ 次中有 $n-1$ 次正面，且第 $k$ 次一定是正面。

### 答案

若硬币正面朝上的概率为 $p$，则观察到 $n$ 次正面朝上时，共掷次数的数学期望为：
$$E[N] = \frac{n}{p}$$

（特别地，如果是公平硬币，即 $p=0.5$，则期望次数为 $2n$。）

### 知识延伸

1.  **负二项分布（Negative Binomial Distribution）**：
    本题中的随机变量 $N$ 服从负二项分布。它描述了在伯努利试验序列中，达到指定数量的“成功”所需的试验次数。
    -   期望：$E[N] = \frac{n}{p}$
    -   方差：$Var(N) = \frac{n(1-p)}{p^2}$

2.  **几何分布与无记忆性**：
    负二项分布可以看作是 $n$ 个独立同分布的几何分布随机变量之和。几何分布具有无记忆性，即之前的失败不会影响下一次成功的概率，这是将 $N$ 分解为 $X_i$ 求和的关键依据。

3.  **易错点提示**：
    在处理几何分布和负二项分布时，需注意定义的差异。
    -   **定义一**：计算总试验次数（本题情况），支持集为 $\{n, n+1, \dots\}$，期望为 $n/p$。
    -   **定义二**：计算失败次数（即拿到 $n$ 次成功前的失败次数），支持集为 $\{0, 1, \dots\}$，期望为 $n(1-p)/p$。
    解题时务必根据“共掷了多少次”这一描述选择定义一。

---
