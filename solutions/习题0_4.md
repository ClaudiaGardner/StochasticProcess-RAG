# 习题0.4

## 题目

甲乙两人比赛，规定只要中间有一人赢得了 $n$ 局，比赛立即结束。假定比赛在两人间公平进行，即每人赢得一局比赛的概率都是1/2,与其他不同局的结果无关.那么比赛结束时，失败一方已经赢得 $k$ 局的概率是多少？ 5.投掷10枚标准的六面体骰子，假定投掷每枚骰子是独立的。它们的点数之和能被6整除的概率是多少？ 6.对 $n$ 个人进行核酸检测。每个人可以单独检测，但费用过高。合并检测可以减少费用。把 $k$ 个人的样本合起来同时分析，如果检测结果呈阴性，对这 $k$ 个人的组，这一次检测就好了。如果检测结果呈阳性，则这 $k$ 个人需要再进行单独检测，因此这 $k$ 个人需要进行 $k+1$ 次检测。假定我们产生了 $n / k$ 个不同的组，每组 $k$ 个人 ( $k$ 能整除 $n$ )，并用合并法进行检测。假设对于独立检测，每个人呈阳性的概率为 $p$ . （1）对 $k$ 个人的合并样本，检测呈阳性的概率是多少？ (2）需要检测的期望次数是多少？ （3）描述如何求最优的 $k$ 值。 （4）给出一个不等式，说明对什么样的 $p$ 值，合并检测比每个人单独检测更好。

## 解答

**Reviewing and Refining Formulas**

I'm now meticulously reviewing the formulas and notation, especially for Problem 0.4 and Problem 6. I'm focusing on ensuring consistent notation and clarity within the LaTeX environment, double-checking the indexing, and simplifying expressions where possible for a cleaner presentation. I also am making minor adjustments in language for added precision.


### 题目分析

本组习题包含三个独立的概率问题，分别涉及以下核心概念：

1.  **习题 0.4（比赛问题）**：考查**负二项分布（Negative Binomial Distribution）**或**巴斯卡分布**的变体。核心在于理解在独立重复试验（伯努利试验）中，达到特定成功次数所需的试验次数分布，并结合对称性进行求解。
2.  **习题 5（骰子整除问题）**：考查随机变量和的模运算性质。核心在于利用**独立性**和**条件概率**（或生成函数/单位根性质）来简化计算。
3.  **习题 6（分组检测问题）**：考查**期望值的线性性质**以及基于概率模型的**最优化问题**。这是经典的“多尔夫曼分组检测（Dorfman Group Testing）”模型。

需要求解的目标分别为：特定比赛结果的概率、骰子点数和被6整除的概率、分组检测的阳性概率、期望次数、最优分组策略及分组检测优于单独检测的条件。

---

### 解题过程

#### 习题 0.4：比赛结束时失败方赢得 $k$ 局的概率

设甲、乙两人赢得一局的概率均为 $p = \frac{1}{2}$。比赛规则为“先胜 $n$ 局者赢”。
我们需要计算比赛结束时，失败的一方恰好赢了 $k$ 局的概率，其中 $0 \le k < n$。

1.  **分析特定一方获胜的情况**：
    不妨假设**甲赢得了比赛**，且甲赢的时候乙恰好赢了 $k$ 局。
    这意味着比赛总共进行了 $n + k$ 局。
    
    必须满足两个条件：
    *   第 $n+k$ 局（最后一局）必须是甲赢。
    *   在前 $n+k-1$ 局中，甲赢了 $n-1$ 局，乙赢了 $k$ 局。

2.  **计算概率**：
    由于每局比赛独立，这是一个伯努利试验序列。
    前 $n+k-1$ 局中甲赢 $n-1$ 局的组合数为 $\binom{n+k-1}{n-1}$（或者等价地 $\binom{n+k-1}{k}$）。
    
    因此，甲赢且乙赢 $k$ 局的概率 $P_A$ 为：
    $$
    P_A = \binom{n+k-1}{k} \left(\frac{1}{2}\right)^{n-1} \left(\frac{1}{2}\right)^{k} \times \frac{1}{2} = \binom{n+k-1}{k} \left(\frac{1}{2}\right)^{n+k}
    $$

3.  **利用对称性**：
    题目问的是“失败一方已经赢得 $k$ 局”，并没有指定是谁失败。由于甲乙水平相当（$p=1/2$），乙赢且甲赢 $k$ 局的概率 $P_B$ 与 $P_A$ 相同。
    
    互斥事件（甲赢或乙赢）的概率相加：
    $$
    P = P_A + P_B = 2 \times \binom{n+k-1}{k} \left(\frac{1}{2}\right)^{n+k} = \binom{n+k-1}{k} \left(\frac{1}{2}\right)^{n+k-1}
    $$

#### 习题 5：10枚骰子点数之和能被6整除的概率

设 $X_i$ 为第 $i$ 枚骰子的点数，$i=1, 2, \dots, 10$。$X_i$ 独立且在 $\{1, 2, 3, 4, 5, 6\}$ 上服从均匀分布。
令 $S_{10} = \sum_{i=1}^{10} X_i$。我们需要求 $P(S_{10} \equiv 0 \pmod 6)$。

1.  **考虑前9枚骰子**：
    令 $S_9 = \sum_{i=1}^{9} X_i$。无论 $S_9$ 的结果是多少，记为 $s$。
    
2.  **考虑第10枚骰子**：
    我们需要 $S_{10} = s + X_{10} \equiv 0 \pmod 6$，即 $X_{10} \equiv -s \pmod 6$。
    
    观察标准骰子的点数集合 $D = \{1, 2, 3, 4, 5, 6\}$。在模 6 的意义下，这个集合对应于剩余类 $\{1, 2, 3, 4, 5, 0\}$。
    这是一个模 6 的完全剩余系。这意味着对于任意整数 $r$（此处 $r = -s$），在集合 $D$ 中**恰好有一个**数值 $x$ 满足 $x \equiv r \pmod 6$。

3.  **计算概率**：
    由于 $X_{10}$ 取 $D$ 中任意值的概率均为 $\frac{1}{6}$，且对于任意固定的 $S_9$，恰好有一个 $X_{10}$ 的取值使得总和能被 6 整除。
    
    利用全概率公式：
    $$
    \begin{aligned}
    P(S_{10} \equiv 0 \pmod 6) &= \sum_{s} P(S_{10} \equiv 0 \pmod 6 \mid S_9 = s) P(S_9 = s) \\
    &= \sum_{s} \frac{1}{6} P(S_9 = s) \\
    &= \frac{1}{6} \sum_{s} P(S_9 = s) \\
    &= \frac{1}{6} \times 1 = \frac{1}{6}
    \end{aligned}
    $$

#### 习题 6：合并核酸检测

设总人数为 $n$，每组 $k$ 人，共 $m = n/k$ 组。每个人呈阳性的概率为 $p$，呈阴性的概率为 $q = 1-p$。

**（1）对 $k$ 个人的合并样本，检测呈阳性的概率是多少？**

一个组检测呈阳性，当且仅当该组中**至少有一个人**呈阳性。
其对立事件是该组中**所有人都呈阴性**。
由于每个人独立，所有人呈阴性的概率为 $(1-p)^k$。
因此，该组检测呈阳性的概率为：
$$
P(\text{组阳性}) = 1 - (1-p)^k
$$

**（2）需要检测的期望次数是多少？**

令随机变量 $Y_i$ 表示第 $i$ 组需要的检测次数。
*   如果该组检测为阴性（概率为 $(1-p)^k$），则只需要 **1** 次检测。
*   如果该组检测为阳性（概率为 $1 - (1-p)^k$），则需要 1 次混合检测 + $k$ 次单独检测，共 **$k+1$** 次。

第 $i$ 组的期望检测次数为：
$$
\begin{aligned}
E[Y_i] &= 1 \cdot P(\text{组阴性}) + (k+1) \cdot P(\text{组阳性}) \\
&= 1 \cdot (1-p)^k + (k+1) \left[ 1 - (1-p)^k \right] \\
&= (1-p)^k + k + 1 - (k+1)(1-p)^k \\
&= k + 1 - k(1-p)^k
\end{aligned}
$$
或者更直观的理解：必然有 1 次检测，若阳性则额外增加 $k$ 次。
$$ E[Y_i] = 1 + k \cdot P(\text{组阳性}) = 1 + k(1 - (1-p)^k) $$

总检测次数 $X = \sum_{i=1}^{n/k} Y_i$。由于期望的线性性质：
$$
E[X] = \frac{n}{k} E[Y_i] = \frac{n}{k} \left[ 1 + k - k(1-p)^k \right] = n \left[ \frac{1}{k} + 1 - (1-p)^k \right]
$$

**（3）描述如何求最优的 $k$ 值。**

我们要最小化总期望检测次数，即最小化函数 $f(k) = \frac{1}{k} + 1 - (1-p)^k$（因为 $n$ 是常数）。
这等价于最小化每人的平均检测次数。

方法如下：
1.  将 $k$ 视为连续变量，对 $f(k)$ 求导并令其为 0：
    $$
    f'(k) = -\frac{1}{k^2} - (1-p)^k \ln(1-p) = 0
    $$
    $$
    \Rightarrow \frac{1}{k^2} = -(1-p)^k \ln(1-p)
    $$
    这是一个超越方程，通常没有解析解，需要通过数值方法（如牛顿法）求解近似值。
2.  由于 $k$ 必须是整数且 $k$ 必须能整除 $n$（或在实际操作中忽略整除限制取整），我们通常计算 $f(k)$ 在 $k \approx \sqrt{\frac{1}{p}}$ 附近的几个整数值，比较大小得出最优解。当 $p$ 很小时，近似最优解为 $k \approx \frac{1}{\sqrt{p}}$。

**（4）给出一个不等式，说明对什么样的 $p$ 值，合并检测比每个人单独检测更好。**

合并检测更好意味着总期望次数小于单独检测次数 $n$。
$$
E[X] < n
$$
代入公式：
$$
n \left[ \frac{1}{k} + 1 - (1-p)^k \right] < n
$$
$$
\frac{1}{k} + 1 - (1-p)^k < 1
$$
$$
\frac{1}{k} < (1-p)^k
$$
两边开 $k$ 次方：
$$
\left(\frac{1}{k}\right)^{1/k} < 1-p
$$
整理得关于 $p$ 的不等式：
$$
p < 1 - \left(\frac{1}{k}\right)^{\frac{1}{k}} \quad \text{或} \quad p < 1 - k^{-1/k}
$$
只要存在一个整数 $k \ge 2$ 满足上述不等式，合并检测就优于单独检测。

---

### 答案

**习题 0.4**
比赛结束时，失败一方已经赢得 $k$ 局的概率为：
$$ \binom{n+k-1}{k} \left(\frac{1}{2}\right)^{n+k-1} $$

**习题 5**
点数之和能被 6 整除的概率为：
$$ \frac{1}{6} $$

**习题 6**
(1) 检测呈阳性的概率：
$$ 1 - (1-p)^k $$
(2) 需要检测的期望次数：
$$ n \left( 1 + \frac{1}{k} - (1-p)^k \right) $$
(3) 求最优 $k$ 值的方法：
建立目标函数 $f(k) = \frac{1}{k} + 1 - (1-p)^k$，通过求解 $f'(k)=0$ 或数值比较法寻找使函数最小的整数 $k$。
(4) 合并检测优于单独检测的不等式条件：
$$ p < 1 - k^{-1/k} $$

---

### 知识延伸

1.  **负二项分布与巴斯卡分布**：习题 0.4 是经典的“分赌本问题”的变体。一般地，若成功概率为 $p$，第 $r$ 次成功发生在第 $x$ 次试验的概率服从负二项分布。本题特殊在没有指定谁赢，且 $p=1/2$，因此多了一个系数 2 并简化了幂次。
2.  **模运算与随机变量和**：习题 5 展示了一个重要性质：若 $X$ 在模 $m$ 的完全剩余系上均匀分布，且 $X$ 与 $Y$ 独立，则 $X+Y$ 在模 $m$ 上也服从均匀分布。这可以通过特征函数（离散傅里叶变换）严格证明。
3.  **多尔夫曼分组检测（Dorfman Group Testing）**：
    *   **稀疏性利用**：该方法在 $p$ 很小（稀疏信号）时非常有效。
    *   **近似公式**：当 $p \to 0$ 时，最优分组大小 $k \approx \frac{1}{\sqrt{p}}$，此时每人的平均检测次数约为 $2\sqrt{p}$。
    *   **易错点**：在计算期望时，容易忘记“第一步混合检测”总是要发生的，无论结果阴阳，这一步贡献了 $n/k$ 次检测。

---
