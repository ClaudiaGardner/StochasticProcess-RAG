# 例题0.33

## 题目

P olya 的传染病罐子模型：罐子里有b 个黑球，w 个白球(n = b + w)。均匀随机取一个球，然 后放回a 个同色球。记 Bk 是第 k 次取到黑球的事件，Wk 是第 k 次取到白球的事件。求： （1）P(B2|W1)； （2）P(B1B2)。 0.5.2 独立掷硬币多次，正面朝上的概率为 p

## 解答

**Outlining a Response**

I'm now structuring the answer into sections: 题目分析, 解题过程, 答案, and 知识延伸, per the plan.  I'm also paying close attention to the use of LaTeX for mathematical notation and the required level of detail, to provide a proper proof. Further, I have explicitly stated to ignore the extraneous coin toss text.


### 题目分析
本题考查的是经典的 **Polya 罐子模型（Polya's Urn Model）**。题目给出了初始状态：罐中有 $b$ 个黑球和 $w$ 个白球，总数 $n=b+w$。规则是“随机取球，放回原球并加进 $a$ 个同色球”。这是一种**随机过程**，具体表现为**依赖过去的随机试验**（非独立同分布），涉及的核心概念包括**条件概率**和**乘法公式**。题目末尾关于“独立掷硬币”的文字属于无关信息（可能是下一题的题干），在此忽略。本题的目标是求解特定条件下的概率 $P(B_2|W_1)$ 以及联合概率 $P(B_1B_2)$。

### 解题过程

令 $b$ 表示初始黑球数，$w$ 表示初始白球数，初始总球数为 $n = b + w$。
每次取球后，罐中的球总数会增加 $a$ 个。

#### 第一部分：求解 $P(B_2|W_1)$

该式表示在**第1次取到白球**（事件 $W_1$ 发生）的条件下，**第2次取到黑球**（事件 $B_2$ 发生）的概率。

1.  **分析第1次取球后的状态变化：**
    *   已知第1次取到了白球（$W_1$）。
    *   根据规则，我们需要将取出的白球放回，并额外放入 $a$ 个白球。
    *   此时罐中球的数量变化如下：
        *   黑球数量：保持不变，仍为 $b$。
        *   白球数量：变为 $w + a$。
        *   此时罐中球的总数变为：$n + a = b + w + a$。

2.  **计算第2次取到黑球的概率：**
    *   在上述新的状态下，从罐中随机取出一个球。
    *   取到黑球的概率等于黑球数量除以总球数。
    $$
    P(B_2 | W_1) = \frac{\text{当前黑球数}}{\text{当前总球数}} = \frac{b}{b + w + a}
    $$

#### 第二部分：求解 $P(B_1B_2)$

该式表示**第1次取到黑球且第2次也取到黑球**的联合概率。根据概率的乘法公式：
$$
P(B_1 B_2) = P(B_1) \cdot P(B_2 | B_1)
$$

1.  **计算 $P(B_1)$：**
    *   初始状态下，罐中有 $b$ 个黑球，$w$ 个白球，总数 $b+w$。
    *   第1次取到黑球的概率为：
    $$
    P(B_1) = \frac{b}{b + w}
    $$

2.  **计算 $P(B_2 | B_1)$：**
    *   假设第1次取到了黑球（$B_1$ 发生）。
    *   根据规则，放回原黑球并放入 $a$ 个黑球。
    *   此时罐中球的数量变化如下：
        *   黑球数量：变为 $b + a$。
        *   白球数量：保持不变，仍为 $w$。
        *   此时罐中球的总数变为：$b + a + w$。
    *   在此条件下，第2次取到黑球的概率为：
    $$
    P(B_2 | B_1) = \frac{b + a}{b + w + a}
    $$

3.  **计算联合概率：**
    将上述两步结果代入乘法公式：
    $$
    \begin{aligned}
    P(B_1 B_2) &= P(B_1) \cdot P(B_2 | B_1) \\
    &= \frac{b}{b + w} \cdot \frac{b + a}{b + w + a}
    \end{aligned}
    $$

### 答案

(1) $P(B_2|W_1) = \frac{b}{b + w + a}$

(2) $P(B_1B_2) = \frac{b(b + a)}{(b + w)(b + w + a)}$

### 知识延伸

1.  **可交换性 (Exchangeability)**：
    Polya 罐子模型的一个重要性质是序列的可交换性。即只要取出的黑球和白球总数相同，其发生的概率与顺序无关。例如：
    $$P(B_1 W_2) = \frac{b}{b+w} \cdot \frac{w}{b+w+a} = P(W_1 B_2)$$
    这也意味着第 $k$ 次取到黑球的边缘概率与第 1 次相同，即 $P(B_k) = P(B_1) = \frac{b}{b+w}$。

2.  **相关公式**：
    *   **条件概率定义**：$P(A|B) = \frac{P(AB)}{P(B)}$。
    *   **乘法公式**：$P(AB) = P(A)P(B|A)$。

3.  **模型特例**：
    *   当 $a=0$ 时，为**有放回抽样**（独立同分布），$P(B_2|B_1) = P(B_1)$。
    *   当 $a=-1$ 时，为**无放回抽样**（超几何分布模型）。

4.  **易错点**：
    *   混淆总球数的变化。务必注意分母是随着抽取次数增加而增加的（每次增加 $a$）。
    *   混淆联合概率 $P(B_1 B_2)$ 与条件概率 $P(B_2 | B_1)$。联合概率是两个事件同时发生的概率，而条件概率是已知前一个事件发生后，后一个事件发生的概率。

---
