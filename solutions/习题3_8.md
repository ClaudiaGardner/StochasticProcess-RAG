# 习题3.8

## 题目

在一系列独立抛掷一个公平硬币的试验中，以 $N$ 记直至出现连续3 次正面时的抛掷次数。求 (1) $P ( N \leq8 )$ (2) $P ( N=8 )$

## 解答

**Formulating the Presentation**

I'm now carefully structuring the solution, considering the user's specific output format. I'm focusing on concise titles and clear step-by-step explanations, utilizing LaTeX formatting for mathematical expressions. I've also incorporated the self-corrections I identified regarding the explanation of the recurrence relation and the expectation. All is ready to generate the final response.


### 题目分析

本题考查**伯努利试验（Bernoulli Trials）**中的**模式等待时间（Waiting Time for Patterns）**问题。
- **核心概念**：独立重复试验、互斥事件、递推关系（Recurrence Relations）。
- **数学模型**：可以将问题转化为计数问题，即计算长度为 $n$ 且不包含特定模式（连续3次正面，记为 HHH）的序列数量。
- **求解目标**：
  1.  $P(N \leq 8)$：在前8次抛掷中，出现过连续3次正面的概率。
  2.  $P(N = 8)$：恰好在第8次抛掷时，首次完成连续3次正面的概率。

### 解题过程

设每次抛掷硬币的结果为 H (正面) 或 T (反面)，且 $P(H) = P(T) = 1/2$。
令 $a_n$ 表示长度为 $n$ 的抛掷序列中，**不包含**连续3次正面（HHH）的序列总数。
总的可能序列数为 $2^n$。

#### 1. 建立递推关系

对于一个长度为 $n$ 且不含 HHH 的序列，我们考察其结尾情况：
- 如果第 $n$ 次是 T，则前 $n-1$ 次必须是不含 HHH 的合法序列。此类序列数为 $a_{n-1}$。
- 如果第 $n$ 次是 H，则必须向前看：
    - 如果结尾是 HT，则前 $n-2$ 次必须是合法序列。此类序列数为 $a_{n-2}$。
    - 如果结尾是 HHT，则前 $n-3$ 次必须是合法序列。此类序列数为 $a_{n-3}$。
    - 结尾不能是 HHH，因为题目要求序列不含 HHH。

因此，对于 $n \geq 3$，递推公式为：
$$a_n = a_{n-1} + a_{n-2} + a_{n-3}$$

#### 2. 计算 $a_n$ 的值

我们需要计算 $n$ 从 0 到 8 的 $a_n$ 值：
- $n=0$: 空集，视为合法，$a_0 = 1$
- $n=1$: H, T，均合法，$a_1 = 2$
- $n=2$: HH, HT, TH, TT，均合法，$a_2 = 4$
- $n=3$: HHH 不合法，其余 $2^3 - 1 = 7$ 个合法，$a_3 = 7$

验证递推：$a_3 = a_2 + a_1 + a_0 = 4 + 2 + 1 = 7$（成立）。

继续计算后续项：
$$a_4 = a_3 + a_2 + a_1 = 7 + 4 + 2 = 13$$
$$a_5 = a_4 + a_3 + a_2 = 13 + 7 + 4 = 24$$
$$a_6 = a_5 + a_4 + a_3 = 24 + 13 + 7 = 44$$
$$a_7 = a_6 + a_5 + a_4 = 44 + 24 + 13 = 81$$
$$a_8 = a_7 + a_6 + a_5 = 81 + 44 + 24 = 149$$

#### 3. 求解 (1) $P(N \leq 8)$

事件 $\{N \leq 8\}$ 等价于“前8次试验中出现了 HHH”。
其对立事件 $\{N > 8\}$ 等价于“前8次试验中**没有**出现 HHH”。

根据定义，长度为 8 且不含 HHH 的序列数为 $a_8 = 149$。
总序列数为 $2^8 = 256$。

$$P(N > 8) = \frac{a_8}{2^8} = \frac{149}{256}$$

因此：
$$P(N \leq 8) = 1 - P(N > 8) = 1 - \frac{149}{256} = \frac{107}{256}$$

#### 4. 求解 (2) $P(N = 8)$

事件 $\{N = 8\}$ 意味着第 8 次抛掷完成了首次 HHH。这要求：
1.  第 6, 7, 8 次抛掷结果必须是 H, H, H。
2.  为了保证这是**首次**出现，第 5 次抛掷必须是 T（否则 HHH 会在第 7 次或更早完成）。
3.  前 4 次抛掷构成的序列必须不包含 HHH。

因此，满足条件的序列结构为：
$$ \underbrace{X_1 X_2 X_3 X_4}_{\text{不含HHH}} \quad \underbrace{T}_{X_5} \quad \underbrace{H \quad H \quad H}_{X_6, X_7, X_8} $$

满足条件的序列数等于长度为 4 且不含 HHH 的序列数，即 $a_4$。
我们已知 $a_4 = 13$。

所以：
$$P(N = 8) = \frac{a_4}{2^8} = \frac{13}{256}$$

---

### 答案

(1) $P(N \leq 8) = \frac{107}{256}$

(2) $P(N = 8) = \frac{13}{256}$

---

### 知识延伸

1.  **Tribonacci 数列**：本题中 $a_n$ 的递推关系 $a_n = a_{n-1} + a_{n-2} + a_{n-3}$ 类似于斐波那契数列，被称为 Tribonacci 数列（三波那契数列）的变体。
2.  **通用公式**：对于首次出现连续 $k$ 次正面的等待时间 $N$，其概率分布满足：
    $$P(N=n) = \frac{a_{n-k-1}}{2^n}, \quad \text{对于 } n > k$$
    其中 $a_m$ 是长度为 $m$ 不含该模式的序列数。
3.  **期望值**：首次出现连续 $k$ 次正面的平均等待时间公式为 $E[N] = 2^{k+1} - 2$。对于本题 $k=3$，期望值为 $2^4 - 2 = 14$。
4.  **易错点**：计算 $P(N=n)$ 时，容易直接认为是在 $a_{n-1}$ 的基础上加一个 H，而忽略了必须确保 HHH 是**首次**出现，因此必须强制第 $n-k$ 位为 T（反面）。

---
