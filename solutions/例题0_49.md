# 例题0.49

## 题目

用均匀硬币序列产生一个二元变量X，使得PX(1) = 1 √e，PX(0) = 1 − 1 √e。

## 解答

### 题目分析

本题要求用均匀硬币（即每次抛掷正反面概率均为1/2）的序列来产生一个二元随机变量X，使其满足特定的概率分布：$P_X(1) = \frac{1}{\sqrt{e}}$，$P_X(0) = 1 - \frac{1}{\sqrt{e}}$。这是一个随机模拟问题，考查如何用简单的均匀随机源（硬币）来生成任意给定概率分布的随机变量。核心思想是将目标概率用二进制展开，通过硬币序列的结果来逼近该概率。

### 解题过程

**方法：二进制展开法**

将目标概率 $p = \frac{1}{\sqrt{e}}$ 用二进制小数展开：

$$p = \frac{1}{\sqrt{e}} = \sum_{i=1}^{\infty} b_i \cdot 2^{-i}$$

其中 $b_i \in \{0,1\}$ 是二进制位。

**算法步骤：**

1. 计算 $p = \frac{1}{\sqrt{e}} = e^{-1/2} \approx 0.6065306597$

2. 将 $p$ 转换为二进制：
   - $p \times 2 = 1.213...$，取整数部分 $b_1 = 1$，余 $0.213...$
   - $0.213 \times 2 = 0.426...$，$b_2 = 0$，余 $0.426...$
   - $0.426 \times 2 = 0.852...$，$b_3 = 0$，余 $0.852...$
   - $0.852 \times 2 = 1.704...$，$b_4 = 1$，余 $0.704...$
   - 继续此过程...
   
   得到 $p \approx (0.1001101...)_2$

3. **生成算法：**
   - 依次抛掷硬币，设第 $i$ 次结果为 $C_i$（正面为1，反面为0）
   - 从 $i=1$ 开始比较：
     - 如果 $C_i = 1$ 且 $b_i = 0$，则输出 $X = 0$（停止）
     - 如果 $C_i = 0$ 且 $b_i = 1$，则输出 $X = 1$（停止）
     - 如果 $C_i = b_i$，则继续抛下一次硬币
   
4. **正确性验证：**

   算法停止在第 $k$ 次的概率为：
   $$P(\text{停止在第}k\text{次}) = 2^{-k}$$
   
   输出 $X=1$ 当且仅当在某次 $C_i = 0$ 且 $b_i = 1$：
   $$P(X=1) = \sum_{i=1}^{\infty} P(C_1=b_1, \ldots, C_{i-1}=b_{i-1}, C_i=0, b_i=1)$$
   $$= \sum_{i: b_i=1} 2^{-i} = \sum_{i=1}^{\infty} b_i \cdot 2^{-i} = p = \frac{1}{\sqrt{e}}$$

   类似地，$P(X=0) = 1 - \frac{1}{\sqrt{e}}$

### 答案

**算法描述：**

1. 计算 $p = \frac{1}{\sqrt{e}}$ 的二进制展开 $(0.b_1b_2b_3...)_2$

2. 依次抛掷均匀硬币，得到序列 $C_1, C_2, C_3, ...$

3. 对于第 $i$ 次抛掷：
   - 若 $C_i \neq b_i$：输出 $X = b_i$，停止
   - 若 $C_i = b_i$：继续抛掷

该算法以概率 $\frac{1}{\sqrt{e}}$ 输出1，以概率 $1-\frac{1}{\sqrt{e}}$ 输出0。

### 知识延伸

**涉及的核心定理：**
- **二进制展开定理**：任何 $[0,1]$ 区间的实数都可以表示为二进制小数
- **几何分布性质**：算法的期望停止时间为2次抛掷

**重要技巧：**
- 用均匀分布生成任意离散分布的通用方法
- 对于有理概率，可用更简单的方法（如拒绝采样）
- 对于无理概率，二进制展开法是理论上精确的方法

**易错点：**
- 注意算法的停止条件是 $C_i \neq b_i$，而非其他条件
- 二进制展开可能是无限的，但算法几乎必然在有限步内停止
- 实际实现时需要足够精度计算二进制位

---
