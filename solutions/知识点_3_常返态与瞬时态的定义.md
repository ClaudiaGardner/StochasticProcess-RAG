# 常返态与瞬时态的定义和判定

**Considering Examples Carefully**

I'm now deep in the process of fleshing out the example section. I've decided to refine the simple random walk example, ensuring the use of Stirling's approximation to rigorously prove recurrence in the symmetric case. Simultaneously, I'm working through a concise finite-state chain example to clearly illustrate transience.


你好！我是概率论与随机过程课程的教授。关于**常返态（Recurrent State）与瞬时态（Transient State）**这一马尔可夫链（Markov Chain）中的核心主题，我将为你提供系统且严谨的讲解。

这两个概念描述了马尔可夫链在长期演化过程中，状态是否会无限次重复出现，是理解链的渐近行为（Asymptotic Behavior）的基石。

---

## 1. 基本定义

在离散时间马尔可夫链（DTMC） $\{X_n, n \ge 0\}$ 中，状态空间为 $S$。

### 1.1 首达时间 (First Passage Time)
定义 $T_i$ 为从状态 $i$ 出发，首次返回状态 $i$ 的时间（步数）：
$$T_i = \min \{n \ge 1 : X_n = i \mid X_0 = i\}$$
如果过程永远不返回 $i$，则规定 $T_i = \infty$。

### 1.2 首达概率 (First Passage Probability)
定义 $f_{ii}^{(n)}$ 为从状态 $i$ 出发，恰好在第 $n$ 步**首次**返回状态 $i$ 的概率：
$$f_{ii}^{(n)} = P(T_i = n) = P(X_n = i, X_{n-1} \neq i, \dots, X_1 \neq i \mid X_0 = i)$$

定义 $f_{ii}$ 为从状态 $i$ 出发，**最终**能返回状态 $i$ 的概率：
$$f_{ii} = P(T_i < \infty) = \sum_{n=1}^{\infty} f_{ii}^{(n)}$$

### 1.3 常返与瞬时的定义
根据 $f_{ii}$ 的值，我们将状态 $i$ 分类：

1.  **常返态 (Recurrent State)**：
    如果 $f_{ii} = 1$，即从状态 $i$ 出发，以概率 1 最终会返回该状态。
    
2.  **瞬时态 (Transient State)**：
    如果 $f_{ii} < 1$，即从状态 $i$ 出发，有正概率 $1 - f_{ii}$ 永远不再返回该状态。

### 1.4 正常返与零常返 (Positive vs Null Recurrent)
对于常返态（$f_{ii}=1$），我们进一步根据平均返回时间 $\mu_i$ 进行分类：
$$\mu_i = E[T_i] = \sum_{n=1}^{\infty} n f_{ii}^{(n)}$$

*   **正常返 (Positive Recurrent)**: $f_{ii} = 1$ 且 $\mu_i < \infty$。
*   **零常返 (Null Recurrent)**: $f_{ii} = 1$ 且 $\mu_i = \infty$。

---

## 2. 核心性质

### 性质 1：充要判定准则（级数判别法）
这是判定常返与瞬时最强有力的数学工具。令 $P_{ii}^{(n)}$ 为 $n$ 步转移概率 $P(X_n=i|X_0=i)$。

*   状态 $i$ 是**常返**的，当且仅当：
    $$\sum_{n=0}^{\infty} P_{ii}^{(n)} = \infty$$
    *(直观理解：平均访问次数是无穷大)*

*   状态 $i$ 是**瞬时**的，当且仅当：
    $$\sum_{n=0}^{\infty} P_{ii}^{(n)} < \infty$$
    *(直观理解：平均访问次数是有限的)*

### 性质 2：类性质 (Class Property)
常返性和瞬时性是**类性质**。
如果状态 $i$ 和状态 $j$ 互通（记为 $i \leftrightarrow j$），即 $i$ 能到达 $j$ 且 $j$ 能到达 $i$，那么 $i$ 和 $j$ 具有相同的类型（同为常返或同为瞬时）。
*   推论：在一个不可约（Irreducible）马尔可夫链中，所有状态要么全是常返，要么全是瞬时。

### 性质 3：有限状态空间的限制
对于状态空间 $S$ 为**有限**集合的马尔可夫链：
1.  不可能所有状态都是瞬时态。
2.  如果链是不可约的，则所有状态都是**正常返**态（不存在零常返）。

### 性质 4：访问次数
令 $N_i$ 为过程访问状态 $i$ 的总次数（$\sum_{n=1}^\infty \mathbb{I}_{\{X_n=i\}}$）。
*   若 $i$ 为瞬时态：$P(N_i = k | X_0=i) = (f_{ii})^k (1-f_{ii})$，且 $E[N_i] = \frac{f_{ii}}{1-f_{ii}} < \infty$。
*   若 $i$ 为常返态：$P(N_i = \infty | X_0=i) = 1$。

---

## 3. 关键公式

以下是解决此类问题时常用的公式列表：

1.  **$n$ 步转移概率与首达概率的关系（卷积公式）**：
    $$P_{ii}^{(n)} = \sum_{k=1}^{n} f_{ii}^{(k)} P_{ii}^{(n-k)}$$
    其中规定 $P_{ii}^{(0)} = 1$。

2.  **格林函数（Green's Function）/ 期望访问次数**：
    对于瞬时态，期望访问次数 $G_{ii}$ 为：
    $$G_{ii} = E\left[ \sum_{n=0}^{\infty} \mathbb{I}_{\{X_n=i\}} \mid X_0=i \right] = \sum_{n=0}^{\infty} P_{ii}^{(n)} = \frac{1}{1 - f_{ii}}$$

3.  **平稳分布与正常返的关系**：
    若马尔可夫链不可约且非周期，状态 $j$ 是正常返的，当且仅当存在唯一的平稳分布 $\pi$，且满足：
    $$\pi_j = \frac{1}{\mu_j} = \frac{1}{E[T_j]} > 0$$
    若状态是零常返或瞬时，则 $\pi_j = 0$（即不存在非零平稳分布）。

---

## 4. 典型例子

### 例 1：一维简单随机游走 (Simple Random Walk)

**场景**：$S = \mathbb{Z}$，从原点出发。向右概率为 $p$，向左概率为 $q = 1-p$。
$$X_{n} = X_{n-1} + \xi_n, \quad P(\xi_n=1)=p, P(\xi_n=-1)=q$$

**判定过程**：
我们要计算 $\sum_{n=1}^\infty P_{00}^{(n)}$ 的敛散性。
只有在偶数步 $2n$ 才可能返回原点（奇数步不可能，概率为0）。
在 $2n$ 步中，必须有 $n$ 步向右，$n$ 步向左。
$$P_{00}^{(2n)} = \binom{2n}{n} p^n q^n$$

利用斯特林公式（Stirling's Approximation） $n! \sim \sqrt{2\pi n} (\frac{n}{e})^n$：
$$P_{00}^{(2n)} \approx \frac{\sqrt{4\pi n} (2n/e)^{2n}}{(\sqrt{2\pi n} (n/e)^n)^2} (pq)^n = \frac{1}{\sqrt{\pi n}} (4pq)^n$$

**分类讨论**：
1.  **对称游走 ($p = 1/2$)**：
    此时 $4pq = 4(1/4) = 1$。
    $$P_{00}^{(2n)} \sim \frac{1}{\sqrt{\pi n}}$$
    级数 $\sum \frac{1}{\sqrt{n}}$ 发散（$p$-级数，$p=1/2 \le 1$）。
    $\therefore \sum P_{00}^{(n)} = \infty \implies$ **常返**（且为零常返）。

2.  **非对称游走 ($p \neq 1/2$)**：
    此时 $4pq < 1$（因为 $(p+q)^2 > 4pq$）。
    令 $\rho = 4pq < 1$。
    $$P_{00}^{(2n)} \sim \frac{1}{\sqrt{\pi n}} \rho^n$$
    这是一个收敛的几何级数（被 $\sqrt{n}$ 衰减得更快）。
    $\therefore \sum P_{00}^{(n)} < \infty \implies$ **瞬时**。

### 例 2：有限状态链的判定

**场景**：状态空间 $S=\{1, 2, 3\}$，转移矩阵为：
$$P = \begin{pmatrix} 0.5 & 0.5 & 0 \\ 0 & 0.5 & 0.5 \\ 0 & 0 & 1 \end{pmatrix}$$

**分析**：
1.  **状态 3**：$P_{33}=1$，这是一个吸收态（Absorbing State）。一旦进入，永远停留。
    $$f_{33} = 1 \implies \text{常返}$$
2.  **状态 2**：$2 \to 3$ 的概率是 0.5。一旦到达 3，就无法回到 2。
    $$f_{22} = P(T_2 < \infty)$$
    从 2 出发，路径可能是 $2\to 2 \to 2 \dots$。只要有一步跳到 3，就回不来了。
    $$f_{22} = P(X_1=2) + P(X_1=3) \times 0 = 0.5 < 1 \implies \text{瞬时}$$
3.  **状态 1**：同理，从 1 可以到达 2，进而到达 3（吸收态），且 3 无法回到 1。
    $\therefore$ 状态 1 也是 **瞬时**。

---

## 5. 与其他概念的联系

1.  **随机游走 (Random Walks)**：
    *   **波利亚定理 (Polya's Theorem)**：简单对称随机游走在 $d=1, 2$ 维是**常返**的，在 $d \ge 3$ 维是**瞬时**的。（"醉汉总能回家，但醉鸟可能回不来"）。

2.  **马尔可夫链的极限分布**：
    *   若状态是瞬时或零常返，则 $\lim_{n\to\infty} P_{ij}^{(n)} = 0$。
    *   只有在**正常返**且非周期的情况下，极限分布 $\lim_{n\to\infty} P_{ij}^{(n)} = \pi_j > 0$ 才存在。

3.  **分支过程 (Branching Processes)**：
    *   在分支过程中，种群灭绝的问题等价于状态 $0$ 是否为吸收态（常返）。如果灭绝概率 $<1$，则种群数量趋于无穷的那些状态是瞬时的（因为系统一直在膨胀，不再返回特定数值）。

---

## 6. 常见考点与易错点

### 学习要点
*   **判别优先级**：
    1.  先看状态空间是否有限。若是有限且不可约 $\to$ 正常返。
    2.  若有吸收态 $\to$ 吸收态常返，能到达吸收态但回不来的状态为瞬时。
    3.  若是无限状态，尝试使用 $\sum P_{ii}^{(n)}$ 判别法。

### 常见错误
1.  **混淆零常返与瞬时**：
    *   错误观点：如果 $P_{ii}^{(n)} \to 0$，则 $i$ 是瞬时态。
    *   纠正：零常返状态也有 $P_{ii}^{(n)} \to 0$。必须检查级数 $\sum P_{ii}^{(n)}$ 是否收敛，而不仅仅是通项趋于0。

2.  **误解 $f_{ii}$ 的含义**：
    *   $f_{ii}$ 是“至少返回一次”的概率，而不是“只返回一次”。如果 $f_{ii}=1$，意味着会返回无穷多次。

3.  **忽略类性质**：
    *   在解题时，不需要对每个状态单独计算。先对状态进行分类（画出状态转移图），找出互通类。一个类里的状态性质相同。

### 解题技巧
*   **画图**：对于有限状态链，画出状态转移图（State Transition Diagram）能直观判断连通性。
*   **利用平稳分布**：如果题目让你证明是正常返，尝试解方程 $\pi P = \pi, \sum \pi_i = 1$。如果能找到合法的概率分布解，则必为正常返。

---
希望这份讲解能帮助你深入理解常返态与瞬时态。如果有具体的习题需要解答，欢迎继续提问。
