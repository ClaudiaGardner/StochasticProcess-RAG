# 习题4.9

## 题目

假设乘客按照一个更新过程来到一火车站，其平均来到间隔时间为 $\mu$ 。每当有 $N$ 个人在车站上等待时， 就开出一辆火车。若每当有 $n$ 个乘客等待时，车站就以每单位时间 $n c$ 元的比率开支费用，且每开出一辆火车要多开支 $\mathit{K}$ 元，那么此车站每单位时间的平均费用是多少？

## 解答

**Refining Cycle Calculations**

The core of the problem lies in the cycle definition and subsequent cost calculations. Focusing now on precisely determining the holding cost over each inter-arrival period. I'm double-checking the indices in the summation to ensure the rate corresponds to the correct number of waiting passengers throughout the cycle. It appears the initial derivation needs a slight adjustment, but the general approach remains sound.


### 题目分析

本题描述了一个典型的**更新过程（Renewal Process）**应用场景，结合了**更新报酬定理（Renewal Reward Theorem）**。
题目中涉及的数学符号包括：
- $\mu$：乘客到达的平均间隔时间，即 $E[X_i] = \mu$。
- $N$：触发火车发车的乘客数量阈值。
- $n$：当前等待的乘客数量变量。
- $c$：单位时间每位乘客的等待费用系数。
- $K$：每次发车的固定费用。

核心考查点是利用更新报酬定理求解**长远平均费用（Long-run average cost）**。我们需要定义一个“更新周期”，并计算该周期内的期望总费用和期望周期长度，两者的比值即为所求。

### 解题过程

**1. 定义更新周期**

我们将“一辆火车开出”到“下一辆火车开出”之间的时间段定义为一个更新周期。
设 $X_i$ 为第 $i-1$ 个乘客和第 $i$ 个乘客到达车站的时间间隔（其中 $X_1$ 为上一辆车走后第一个乘客到达的时间）。
根据题意，乘客到达是一个更新过程，因此 $X_1, X_2, \dots, X_N$ 是独立同分布（i.i.d.）的非负随机变量，且期望值为：
$$E[X_i] = \mu, \quad i=1, 2, \dots, N$$

**2. 计算期望周期长度**

当第 $N$ 个乘客到达时，火车立即开出，周期结束。因此，一个周期的总时长 $T$ 为前 $N$ 个到达间隔之和：
$$T = \sum_{i=1}^{N} X_i$$
利用期望的线性性质，周期的期望长度为：
$$E[T] = E\left[ \sum_{i=1}^{N} X_i \right] = \sum_{i=1}^{N} E[X_i] = N\mu$$

**3. 计算期望周期总费用**

一个周期内的总费用 $C_{total}$ 由两部分组成：**等待费用（Holding Cost）** 和 **发车费用（Fixed Cost）**。

*   **发车费用**：
    每个周期结束时开出一辆火车，固定费用为 $K$。

*   **等待费用**：
    题目指出，当有 $n$ 个乘客等待时，费用率为 $nc$。我们需要分析每个时间段内的等待人数：
    - 在时间段 $X_1$ 内（第1个乘客到达前）：车站上有 $0$ 人等待。
      费用 = $0 \cdot c \cdot X_1 = 0$。
    - 在时间段 $X_2$ 内（第1个到达后，第2个到达前）：车站上有 $1$ 人等待。
      费用 = $1 \cdot c \cdot X_2$。
    - 在时间段 $X_k$ 内（第 $k-1$ 个到达后，第 $k$ 个到达前）：车站上有 $k-1$ 人等待。
      费用 = $(k-1) \cdot c \cdot X_k$。
    - ...
    - 在时间段 $X_N$ 内（第 $N-1$ 个到达后，第 $N$ 个到达前）：车站上有 $N-1$ 人等待。
      费用 = $(N-1) \cdot c \cdot X_N$。
    
    注意：第 $N$ 个乘客到达瞬间火车开走，等待人数清零，周期结束。

    因此，一个周期内的总等待费用 $C_{wait}$ 为：
    $$C_{wait} = \sum_{k=1}^{N} c(k-1)X_k$$

    计算总等待费用的期望值：
    $$E[C_{wait}] = E\left[ \sum_{k=1}^{N} c(k-1)X_k \right] = \sum_{k=1}^{N} c(k-1)E[X_k]$$
    代入 $E[X_k] = \mu$：
    $$E[C_{wait}] = c\mu \sum_{k=1}^{N} (k-1) = c\mu (0 + 1 + 2 + \dots + N-1)$$
    利用等差数列求和公式：
    $$E[C_{wait}] = c\mu \frac{(N-1)N}{2}$$

    所以，一个周期的期望总费用为：
    $$E[C_{total}] = K + E[C_{wait}] = K + \frac{c\mu N(N-1)}{2}$$

**4. 计算单位时间的平均费用**

根据更新报酬定理，长远平均费用等于期望周期总费用除以期望周期长度：
$$\text{Average Cost} = \frac{E[C_{total}]}{E[T]}$$

代入上述结果：
$$\text{Average Cost} = \frac{K + \frac{1}{2} c\mu N(N-1)}{N\mu}$$

化简表达式：
$$\text{Average Cost} = \frac{K}{N\mu} + \frac{c\mu N(N-1)}{2N\mu} = \frac{K}{N\mu} + \frac{c(N-1)}{2}$$

### 答案

此车站每单位时间的平均费用是：
$$ \frac{K}{N\mu} + \frac{c(N-1)}{2} $$

### 知识延伸

1.  **更新报酬定理 (Renewal Reward Theorem)**：
    这是解决此类问题的核心工具。如果一个随机过程包含重复的循环（周期），且每个周期的演化是独立同分布的，那么：
    $$ \lim_{t \to \infty} \frac{C(t)}{t} = \frac{E[\text{Reward per Cycle}]}{E[\text{Cycle Length}]} $$
    其中 $C(t)$ 是时间 $t$ 内累积的总报酬（或费用）。

2.  **常见解题技巧**：
    - **准确定义周期**：周期的开始和结束点必须是系统状态“再生”的时刻（例如本题中等待人数归零的时刻）。
    - **分段积分/求和**：计算累积费用时，通常需要将时间轴按事件发生点分割，针对每一段的费率乘以持续时间进行求和。

3.  **易错点**：
    - **索引混淆**：在计算等待费用时，容易搞错 $X_k$ 对应的是 $k$ 人等待还是 $k-1$ 人等待。务必画出时间轴确认：$X_k$ 是第 $k$ 个到达间隔，此时第 $k$ 个人还没到，只有 $k-1$ 个人在等。
    - **期望计算**：不要忘记 $X_i$ 是随机变量，最终结果必须是参数（如 $\mu$）的函数，而非随机变量。

---
