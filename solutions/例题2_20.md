# 例题2.20

## 题目

假设某零件受到外来撞击的次数服从参数为 λ 的泊松过程。已知该零件受到撞击次数超过 k 时就不能正常工作，求该零件的使用寿命 T 的分布密度函数。

## 解答

**Refining the Solution**

The solution process is now focusing on the differentiation of the CDF to find the PDF. I'm carefully working through the derivative of the Poisson terms, verifying the results, and ensuring the final answer aligns with the Gamma distribution representation, which confirms the correctness of the approach. I am also finalizing the problem analysis and knowledge extension sections.


### 题目分析

本题考查泊松过程（Poisson Process）的基本性质及其与到达时间（Arrival Times）分布之间的关系。题目中定义了零件的寿命 $T$ 与泊松过程的计数过程 $N(t)$ 之间的逻辑关系。
关键点在于理解“超过 $k$ 次撞击”意味着第 $k+1$ 次撞击发生时零件损坏。因此，寿命 $T$ 等价于泊松过程的第 $k+1$ 个到达时间 $S_{k+1}$。解题的核心在于利用事件 $\{T > t\}$ 与 $\{N(t) \le k\}$ 的等价性，通过求导分布函数来获得概率密度函数。

### 解题过程

**1. 定义随机变量与事件**

设 $\{N(t), t \ge 0\}$ 是参数为 $\lambda$ 的泊松过程，表示在时间区间 $(0, t]$ 内零件受到的撞击次数。根据泊松过程的定义，对于任意 $t > 0$，$N(t)$ 服从参数为 $\lambda t$ 的泊松分布，其概率质量函数为：
$$P(N(t) = n) = \frac{(\lambda t)^n}{n!} e^{-\lambda t}, \quad n = 0, 1, 2, \dots$$

设 $T$ 为零件的使用寿命。题目条件指出，当撞击次数**超过** $k$ 时零件不能工作。这意味着只要撞击次数 $N(t) \le k$，零件依然正常工作；当第 $k+1$ 次撞击发生时，零件损坏。

**2. 建立分布函数关系**

零件的寿命 $T$ 大于 $t$ 的事件，等价于在时间 $t$ 内受到的撞击次数不超过 $k$。即：
$$\{ T > t \} \iff \{ N(t) \le k \}$$

由此可得 $T$ 的生存函数（Survival Function）：
$$P(T > t) = P(N(t) \le k) = \sum_{j=0}^{k} P(N(t) = j)$$

代入泊松分布公式：
$$P(T > t) = \sum_{j=0}^{k} \frac{(\lambda t)^j}{j!} e^{-\lambda t}$$

因此，$T$ 的分布函数 $F_T(t)$ 为：
$$F_T(t) = P(T \le t) = 1 - P(T > t) = 1 - \sum_{j=0}^{k} \frac{(\lambda t)^j}{j!} e^{-\lambda t}, \quad t > 0$$
当 $t \le 0$ 时，$F_T(t) = 0$。

**3. 求解概率密度函数**

对分布函数 $F_T(t)$ 关于 $t$ 求导，得到概率密度函数 $f_T(t)$：
$$f_T(t) = \frac{d}{dt} F_T(t) = - \frac{d}{dt} \left( e^{-\lambda t} \sum_{j=0}^{k} \frac{(\lambda t)^j}{j!} \right)$$

利用乘积求导法则，逐项求导：
$$
\begin{aligned}
\frac{d}{dt} \left( \frac{(\lambda t)^j}{j!} e^{-\lambda t} \right) &= \frac{j \lambda (\lambda t)^{j-1}}{j!} e^{-\lambda t} + \frac{(\lambda t)^j}{j!} (-\lambda) e^{-\lambda t} \\
&= \lambda e^{-\lambda t} \left( \frac{(\lambda t)^{j-1}}{(j-1)!} - \frac{(\lambda t)^j}{j!} \right)
\end{aligned}
$$
注意：当 $j=0$ 时，$\frac{d}{dt}(e^{-\lambda t}) = -\lambda e^{-\lambda t}$。上式中若规定 $(-1)! = \infty$ 或理解为第一项为0，则通项公式成立。

我们将求和展开观察（这是一个裂项相消的过程）：
$$
\begin{aligned}
\frac{d}{dt} \sum_{j=0}^{k} \frac{(\lambda t)^j}{j!} e^{-\lambda t} &= \sum_{j=0}^{k} \left[ \lambda \frac{(\lambda t)^{j-1}}{(j-1)!} e^{-\lambda t} - \lambda \frac{(\lambda t)^j}{j!} e^{-\lambda t} \right] \\
&= \lambda e^{-\lambda t} \left[ \underbrace{\left( 0 - 1 \right)}_{j=0} + \underbrace{\left( 1 - \lambda t \right)}_{j=1} + \dots + \left( \frac{(\lambda t)^{k-1}}{(k-1)!} - \frac{(\lambda t)^k}{k!} \right) \right]
\end{aligned}
$$
更严谨的代数推导如下：
令 $u_j(t) = \frac{(\lambda t)^j}{j!} e^{-\lambda t}$。
$$
\begin{aligned}
\sum_{j=0}^k u_j'(t) &= u_0'(t) + \sum_{j=1}^k u_j'(t) \\
&= -\lambda e^{-\lambda t} + \sum_{j=1}^k \lambda e^{-\lambda t} \left( \frac{(\lambda t)^{j-1}}{(j-1)!} - \frac{(\lambda t)^j}{j!} \right) \\
&= -\lambda e^{-\lambda t} + \lambda e^{-\lambda t} \left( \sum_{j=1}^k \frac{(\lambda t)^{j-1}}{(j-1)!} - \sum_{j=1}^k \frac{(\lambda t)^j}{j!} \right) \\
&= -\lambda e^{-\lambda t} + \lambda e^{-\lambda t} \left( \sum_{m=0}^{k-1} \frac{(\lambda t)^m}{m!} - \sum_{j=1}^k \frac{(\lambda t)^j}{j!} \right) \\
&= -\lambda e^{-\lambda t} + \lambda e^{-\lambda t} \left( 1 + \sum_{j=1}^{k-1} \frac{(\lambda t)^j}{j!} - \sum_{j=1}^{k-1} \frac{(\lambda t)^j}{j!} - \frac{(\lambda t)^k}{k!} \right) \\
&= -\lambda e^{-\lambda t} + \lambda e^{-\lambda t} \left( 1 - \frac{(\lambda t)^k}{k!} \right) \\
&= - \lambda \frac{(\lambda t)^k}{k!} e^{-\lambda t}
\end{aligned}
$$

回到 $f_T(t)$ 的表达式：
$$f_T(t) = - \left( - \lambda \frac{(\lambda t)^k}{k!} e^{-\lambda t} \right) = \frac{\lambda (\lambda t)^k}{k!} e^{-\lambda t}$$

### 答案

该零件使用寿命 $T$ 的概率密度函数为：
$$
f_T(t) = \begin{cases} 
\frac{\lambda (\lambda t)^k}{k!} e^{-\lambda t}, & t > 0 \\
0, & t \le 0 
\end{cases}
$$
即 $T$ 服从参数为 $(k+1, \lambda)$ 的 **爱尔朗分布（Erlang Distribution）** 或 **伽玛分布（Gamma Distribution）** $\Gamma(k+1, \lambda)$。

### 知识延伸

1.  **伽玛分布与泊松过程的关系**：
    泊松过程的第 $n$ 个到达时间 $S_n$ 服从参数为 $(n, \lambda)$ 的伽玛分布（当 $n$ 为整数时也称为爱尔朗分布）。本题中，零件在第 $k+1$ 次撞击时失效，故 $T = S_{k+1} \sim \Gamma(k+1, \lambda)$。直接利用此性质可以快速验证答案。

2.  **重要公式**：
    *   泊松分布概率：$P(N(t)=k) = \frac{(\lambda t)^k}{k!}e^{-\lambda t}$
    *   伽玛分布 $\Gamma(\alpha, \lambda)$ 密度函数：$f(t) = \frac{\lambda^\alpha}{\Gamma(\alpha)} t^{\alpha-1} e^{-\lambda t}$
    *   泊松过程与到达时间的对偶关系：
        $$P(S_n \le t) = P(N(t) \ge n)$$

3.  **解题技巧与易错点**：
    *   **易错点**：仔细区分题目中的“超过 $k$”是 $>k$ 还是 $\ge k$。本题是“超过 $k$”，即失效发生在第 $k+1$ 次；如果是“达到 $k$ 次即失效”，则对应第 $k$ 次。
    *   **技巧**：在处理泊松过程的等待时间问题时，先转化为计数过程 $N(t)$ 的概率问题通常通过求导更容易求解，避免了复杂的多重积分。

---
