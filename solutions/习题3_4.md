# 习题3.4

## 题目

假设 $\mathrm{X}=( X_{n} , \; \; n \geq0 )$ 是马尔可夫链，请分别考虑以下两个转移矩阵 $$ \mathrm{P 1}=\left( \begin{matrix} {\frac{1} {2}} & {\frac{1} {2}} & {0} & {0} & {0} \\ {\frac{1} {4}} & {\frac{3} {4}} & {0} & {0} & {0} \\ {0} & {0} & {0} & {1} & {0} \\ {0} & {0} & {\frac{1} {2}} & {0} & {\frac{1} {2}} \\ {0} & {0} & {0} & {1} & {0} \\ \end{matrix} \right) \mathrm{P 2}=\left( \begin{matrix} {\frac{1} {2}} & {\frac{1} {2}} & {0} & {0} & {0} \\ {\frac{1} {4}} & {0} & {\frac{3} {4}} & {0} & {0} \\ {0} & {0} & {0} & {1} & {0} \\ {0} & {0} & {\frac{1} {2}} & {0} & {\frac{1} {2}} \\ {0} & {0} & {0} & {1} & {0} \\ \end{matrix} \right) $$ （1）分别对上述两个状态空间进行分类； (2）分别列出上述两个状态空间各自对应的连通类； （3）上述两个状态空间各自连通类之间互通吗？

## 解答

**Reviewing Output Strategy**

I'm now carefully examining the structured output I've constructed, verifying the formatting compliance and mathematical accuracy. The emphasis is on a concise, professional tone, ensuring LaTeX is correctly implemented, and that the analysis is free of any conversational filler. The states are classified according to their properties, and communicating classes and their relation to one another are properly presented.


### 题目分析

本题考查**离散时间马尔可夫链（Discrete-time Markov Chain, DTMC）**的状态分类与结构分析。
核心考点包括：
1.  **互通性与连通类（Communicating Classes）**：根据转移概率矩阵判断状态之间是否互通，并将状态空间划分为若干个连通类。
2.  **状态分类**：判断连通类的性质，包括**常返性（Recurrence）**与**瞬变性（Transience）**，以及**周期性（Periodicity）**。
3.  **类间关系**：分析不同连通类之间的可达性。

题目要求对给定的两个 $5 \times 5$ 转移矩阵 $P_1$ 和 $P_2$ 进行上述分析。我们将状态空间记为 $S = \{1, 2, 3, 4, 5\}$。

---

### 解题过程

#### 第一部分：分析矩阵 $P_1$

$$ \mathrm{P}_1=\left( \begin{matrix} {\frac{1} {2}} & {\frac{1} {2}} & {0} & {0} & {0} \\ {\frac{1} {4}} & {\frac{3} {4}} & {0} & {0} & {0} \\ {0} & {0} & {0} & {1} & {0} \\ {0} & {0} & {\frac{1} {2}} & {0} & {\frac{1} {2}} \\ {0} & {0} & {0} & {1} & {0} \\ \end{matrix} \right) $$

**1. 确定连通类**
观察矩阵 $P_1$ 的结构，可以看出它是一个分块对角矩阵。
-   **状态集合 $\{1, 2\}$**：
    -   $1 \to 2$ ($P_{12} > 0$)， $2 \to 1$ ($P_{21} > 0$)，故 $1 \leftrightarrow 2$。
    -   对于 $i \in \{1, 2\}$ 和 $j \in \{3, 4, 5\}$，有 $P_{ij} = 0$。即一旦进入 $\{1, 2\}$，永远不会离开。
    -   因此，$\{1, 2\}$ 是一个闭集（Closed Set），且是不可约的（Irreducible）。

-   **状态集合 $\{3, 4, 5\}$**：
    -   $3 \to 4$ ($P_{34}=1$)。
    -   $4 \to 3$ ($P_{43}=1/2$)，故 $3 \leftrightarrow 4$。
    -   $4 \to 5$ ($P_{45}=1/2$)， $5 \to 4$ ($P_{54}=1$)，故 $4 \leftrightarrow 5$。
    -   由传递性，$3 \leftrightarrow 5$。
    -   对于 $i \in \{3, 4, 5\}$ 和 $j \in \{1, 2\}$，有 $P_{ij} = 0$。
    -   因此，$\{3, 4, 5\}$ 也是一个闭集，且是不可约的。

**2. 状态分类（常返/瞬变，周期性）**
-   **类 $C_1 = \{1, 2\}$**：
    -   **常返性**：这是一个有限状态的闭集，因此其中的状态都是**正常返（Positive Recurrent）**的。
    -   **周期性**：检查状态 1，由于 $P_{11} = 1/2 > 0$，即一步可返回自身，故周期 $d(1) = 1$。因为周期性是类性质，故该类为**非周期（Aperiodic）**的。

-   **类 $C_2 = \{3, 4, 5\}$**：
    -   **常返性**：这是一个有限状态的闭集，因此其中的状态都是**正常返（Positive Recurrent）**的。
    -   **周期性**：
        -   从状态 3 出发返回 3 的路径：$3 \to 4 \to 3$（步数 2），$3 \to 4 \to 5 \to 4 \to 3$（步数 4）。
        -   从状态 4 出发返回 4 的路径：$4 \to 3 \to 4$（步数 2），$4 \to 5 \to 4$（步数 2）。
        -   集合 $\{3, 4, 5\}$ 具有二部图结构：$\{4\}$ 与 $\{3, 5\}$ 交替。从 $\{3, 5\}$ 必须去 $\{4\}$，从 $\{4\}$ 必须去 $\{3, 5\}$。
        -   所有回路的长度均为偶数，最大公约数 $d = \gcd\{2, 4, \dots\} = 2$。
        -   故该类是**周期为 2** 的。

---

#### 第二部分：分析矩阵 $P_2$

$$ \mathrm{P}_2=\left( \begin{matrix} {\frac{1} {2}} & {\frac{1} {2}} & {0} & {0} & {0} \\ {\frac{1} {4}} & {0} & {\frac{3} {4}} & {0} & {0} \\ {0} & {0} & {0} & {1} & {0} \\ {0} & {0} & {\frac{1} {2}} & {0} & {\frac{1} {2}} \\ {0} & {0} & {0} & {1} & {0} \\ \end{matrix} \right) $$

**1. 确定连通类**
-   **状态 1 和 2**：
    -   $1 \to 2$ ($P_{12} > 0$)， $2 \to 1$ ($P_{21} > 0$)，故 $1 \leftrightarrow 2$。
    -   但是，从状态 2 可以到达状态 3 ($P_{23} = 3/4 > 0$)。
    -   观察第 3、4、5 行，这三行前两列均为 0，说明一旦进入 $\{3, 4, 5\}$，无法返回 $\{1, 2\}$。
    -   因此，$\{1, 2\}$ 互通，但不是闭集。

-   **状态 3, 4, 5**：
    -   这部分的子矩阵结构与 $P_1$ 完全相同。
    -   $3 \leftrightarrow 4 \leftrightarrow 5$。
    -   这是一个闭集。

**2. 状态分类**
-   **类 $C_1 = \{1, 2\}$**：
    -   **常返性**：由于从该类出发（具体是从状态 2）可以到达类 $C_2$ 且无法返回，存在正概率逃离该集合，故该类中的状态是**瞬变（Transient）**的。
    -   **周期性**：虽然对于瞬变态讨论周期性意义较小，但根据定义 $d(1) = \gcd\{n \mid P_{11}^{(n)} > 0\}$。由于 $P_{11} > 0$，周期为 1。

-   **类 $C_2 = \{3, 4, 5\}$**：
    -   **常返性**：有限闭集，**正常返（Positive Recurrent）**。
    -   **周期性**：结构与 $P_1$ 中相同，**周期为 2**。

---

#### 第三部分：综合回答问题

**(1) 状态空间分类**
*   **对于 $P_1$**：
    *   状态 $\{1, 2\}$：正常返、非周期。
    *   状态 $\{3, 4, 5\}$：正常返、周期为 2。
*   **对于 $P_2$**：
    *   状态 $\{1, 2\}$：瞬变。
    *   状态 $\{3, 4, 5\}$：正常返、周期为 2。

**(2) 连通类**
*   **对于 $P_1$**：有两个连通类 $C_1 = \{1, 2\}$ 和 $C_2 = \{3, 4, 5\}$。
*   **对于 $P_2$**：有两个连通类 $C_1 = \{1, 2\}$ 和 $C_2 = \{3, 4, 5\}$。

**(3) 连通类之间是否互通**
*   **对于 $P_1$**：
    *   $C_1$ 与 $C_2$ **不互通**。
    *   即：从 $C_1$ 无法到达 $C_2$，从 $C_2$ 也无法到达 $C_1$。
*   **对于 $P_2$**：
    *   $C_1$ 与 $C_2$ **单向连通**（$C_1 \to C_2$），但**不互通**。
    *   即：从 $C_1$ 可以到达 $C_2$（通过 $2 \to 3$），但从 $C_2$ 无法到达 $C_1$。

### 答案

**(1) 状态分类：**
*   **$P_1$ 状态空间：**
    *   $\{1, 2\}$：正常返（Positive Recurrent），非周期（Aperiodic）。
    *   $\{3, 4, 5\}$：正常返（Positive Recurrent），周期（Periodic，周期 $d=2$）。
*   **$P_2$ 状态空间：**
    *   $\{1, 2\}$：瞬变（Transient）。
    *   $\{3, 4, 5\}$：正常返（Positive Recurrent），周期（Periodic，周期 $d=2$）。

**(2) 连通类：**
*   **$P_1$ 的连通类：** $C_1 = \{1, 2\}$， $C_2 = \{3, 4, 5\}$。
*   **$P_2$ 的连通类：** $C_1 = \{1, 2\}$， $C_2 = \{3, 4, 5\}$。

**(3) 连通类之间的互通性：**
*   **$P_1$：** 两个连通类之间**互不相通**（即 $C_1 \nleftrightarrow C_2$）。这是一个可约马尔可夫链，且由两个独立的闭集组成。
*   **$P_2$：** 两个连通类之间**不互通**，但存在单向可达性。具体为 $C_1$ 可到达 $C_2$，但 $C_2$ 不可到达 $C_1$（即 $C_1 \to C_2$ 但 $C_2 \nrightarrow C_1$）。

### 知识延伸

1.  **状态空间的分解定理**：
    对于任意马尔可夫链，状态空间 $S$ 可以唯一分解为 $S = T \cup C_1 \cup C_2 \cup \dots$，其中 $T$ 是所有瞬变状态的集合，$C_i$ 是互不相通的常返闭集。
    *   在本题 $P_2$ 中，$T=\{1, 2\}$，$C_1=\{3, 4, 5\}$。

2.  **有限状态马尔可夫链的性质**：
    *   不可能所有状态都是瞬变的。
    *   如果是不可约的（只有一个连通类），则所有状态都是正常返的。
    *   如果一个连通类是闭集且有限，则该类是常返的。
    *   如果一个连通类不是闭集（能出去回不来），则该类是瞬变的。

3.  **周期的判定技巧**：
    *   周期 $d_i = \gcd\{n \geq 1 \mid P_{ii}^{(n)} > 0\}$。
    *   只要发现矩阵对角线上有非零元素 $P_{ii} > 0$，则该状态（及其所在的类）必定是非周期的（$d=1$）。
    *   对于二部图结构（状态分为两组 $A, B$，只能 $A \to B \to A$），周期通常为 2 的倍数。

---
