# 随机游走及其性质

**Formulating Definitions**

\n\nI am now focusing on the introduction and definition sections. I am making sure the Simple Random Walk (SRW) on $\mathbb{Z}$ is clearly and rigorously defined, including the steps, probabilities, and the position's evolution. I will be sure to emphasize the state and index spaces. Generalizations to other spaces can be mentioned.


你好。我是概率论与随机过程课程的教授。今天我们将深入探讨随机过程中的一个基石概念——**随机游走 (Random Walk)**。它不仅是马尔可夫链的典型代表，也是布朗运动的离散原型，在物理学、金融学和计算机科学中有着广泛的应用。

以下是关于一维简单随机游走的系统讲解。

---

## 1. 基本定义

随机游走最经典的形式是**一维简单随机游走 (Simple Random Walk, SRW)**。

**定义**：
设 $X_1, X_2, \dots$ 是一列独立同分布 (i.i.d.) 的随机变量序列，其取值为 $+1$ 或 $-1$。定义分布律如下：
$$P(X_i = 1) = p, \quad P(X_i = -1) = q$$
其中 $0 < p < 1$，且 $q = 1 - p$。

定义随机游走的过程 $\{S_n, n \geq 0\}$ 为部分和序列：
$$S_0 = 0$$
$$S_n = \sum_{i=1}^{n} X_i, \quad n \geq 1$$

这里，$S_n$ 表示粒子在时刻 $n$ 的位置。
- 若 $p = q = 1/2$，称该过程为**对称简单随机游走 (Symmetric Simple Random Walk)**。
- 状态空间为整数集 $\mathbb{Z}$，时间参数集为非负整数集 $\mathbb{N}_0$。

---

## 2. 核心性质

随机游走具有许多深刻的数学性质，以下是几个核心定理：

### 2.1 独立增量性与平稳增量性
随机游走具有独立且平稳的增量。对于任意 $0 \leq m < n$，增量 $S_n - S_m$ 的分布仅依赖于时间差 $n-m$，且与 $S_m$ 独立：
$$S_n - S_m = \sum_{i=m+1}^{n} X_i \sim S_{n-m}$$

### 2.2 马尔可夫性 (Markov Property)
随机游走是一个马尔可夫链。给定当前位置，未来的走向与过去无关：
$$P(S_{n+1} = j \mid S_n = i, S_{n-1} = i_{n-1}, \dots, S_0 = 0) = P(S_{n+1} = j \mid S_n = i)$$
其一步转移概率为：
$$P_{i, i+1} = p, \quad P_{i, i-1} = q$$

### 2.3 空间齐次性
转移概率仅依赖于相对位置的变化，与绝对位置无关：
$$P(S_n = j \mid S_0 = i) = P(S_n = j-i \mid S_0 = 0)$$

### 2.4 反射原理 (Reflection Principle)
这是一个处理路径计数的强大工具。
**定理**：对于对称随机游走 ($p=1/2$)，设 $k, n > 0$，从原点出发在时刻 $n$ 到达 $k$ 且过程中曾经触及或穿过位置 $a$ ($a > 0, a < k$) 的路径数，等于从位置 $2a$ 出发在时刻 $n$ 到达 $k$ 的路径数。
这常用于计算首达时间 (First Passage Time) 的分布。

### 2.5 常返性 (Recurrence) - 波利亚定理 (Polya's Theorem)
- **一维和二维**对称简单随机游走是**常返的 (Recurrent)**。即粒子以概率 1 无穷多次返回原点：
  $$P(S_n = 0 \text{ for infinitely many } n) = 1$$
- **三维及以上**的对称简单随机游走是**暂留的 (Transient)**。粒子最终会趋向无穷远，不再返回原点。

---

## 3. 关键公式

以下公式均基于一维简单随机游走 $\{S_n\}$。

### 3.1 矩 (Moments)
*   **期望**：
    $$E[S_n] = \sum_{i=1}^n E[X_i] = n(p-q)$$
    特别地，若 $p=1/2$，则 $E[S_n] = 0$。

*   **方差**：
    由于 $X_i$ 独立，
    $$\operatorname{Var}(S_n) = \sum_{i=1}^n \operatorname{Var}(X_i) = n \cdot [1 - (p-q)^2] = 4npq$$
    特别地，若 $p=1/2$，则 $\operatorname{Var}(S_n) = n$。

### 3.2 概率分布公式
粒子在时刻 $n$ 位于位置 $k$ 的概率 $P(S_n = k)$。
设向右走了 $r$ 步，向左走了 $l$ 步，则必须满足：
$$\begin{cases} r + l = n \\ r - l = k \end{cases} \implies r = \frac{n+k}{2}, \quad l = \frac{n-k}{2}$$

若 $n+k$ 为偶数且 $|k| \leq n$，则：
$$P(S_n = k) = \binom{n}{\frac{n+k}{2}} p^{\frac{n+k}{2}} q^{\frac{n-k}{2}}$$
若 $n+k$ 为奇数或 $|k| > n$，则 $P(S_n = k) = 0$。

### 3.3 赌徒破产问题 (Gambler's Ruin)
设 $S_0 = i$，吸收壁为 $0$ 和 $N$ ($0 < i < N$)。令 $P_i$ 为从 $i$ 出发先到达 $N$ (赢) 而非 $0$ (输) 的概率。
$$P_i = \begin{cases} \frac{1 - (q/p)^i}{1 - (q/p)^N} & \text{if } p \neq q \\ \frac{i}{N} & \text{if } p = q = 1/2 \end{cases}$$

---

## 4. 典型例子

**题目**：
考虑一个对称简单随机游走 ($p=q=1/2$)，粒子从原点 $S_0=0$ 出发。
1. 计算 $n=4$ 步后，粒子位于原点的概率。
2. 计算 $n=4$ 步后，粒子位于位置 $+2$ 的概率。
3. 验证 $S_4$ 的期望和方差。

**解答**：

**1. 计算 $P(S_4 = 0)$**
这里 $n=4, k=0$。
根据公式，向右步数 $r = (4+0)/2 = 2$。
$$P(S_4 = 0) = \binom{4}{2} \left(\frac{1}{2}\right)^2 \left(\frac{1}{2}\right)^2 = \frac{4 \times 3}{2 \times 1} \cdot \left(\frac{1}{2}\right)^4 = 6 \cdot \frac{1}{16} = \frac{3}{8}$$

**2. 计算 $P(S_4 = 2)$**
这里 $n=4, k=2$。
向右步数 $r = (4+2)/2 = 3$。
$$P(S_4 = 2) = \binom{4}{3} \left(\frac{1}{2}\right)^3 \left(\frac{1}{2}\right)^1 = 4 \cdot \frac{1}{16} = \frac{1}{4}$$

**3. 验证期望与方差**
根据公式：
$$E[S_4] = 4 \times (0.5 - 0.5) = 0$$
$$\operatorname{Var}(S_4) = 4 \times 4 \times 0.5 \times 0.5 = 4$$

我们也可以通过定义直接计算验证：
可能的路径及对应 $S_4$ 的值：
- 4右 ($S_4=4$): $\binom{4}{4}=1$ 种
- 3右1左 ($S_4=2$): $\binom{4}{3}=4$ 种
- 2右2左 ($S_4=0$): $\binom{4}{2}=6$ 种
- 1右3左 ($S_4=-2$): $\binom{4}{1}=4$ 种
- 0右4左 ($S_4=-4$): $\binom{4}{0}=1$ 种

总路径数 $2^4 = 16$。
$$E[S_4] = \frac{1}{16}(1\cdot4 + 4\cdot2 + 6\cdot0 + 4\cdot(-2) + 1\cdot(-4)) = \frac{1}{16}(4+8+0-8-4) = 0 \quad (\text{验证通过})$$
$$E[S_4^2] = \frac{1}{16}(1\cdot4^2 + 4\cdot2^2 + 6\cdot0^2 + 4\cdot(-2)^2 + 1\cdot(-4)^2) = \frac{1}{16}(16 + 16 + 0 + 16 + 16) = \frac{64}{16} = 4$$
$$\operatorname{Var}(S_4) = E[S_4^2] - (E[S_4])^2 = 4 - 0 = 4 \quad (\text{验证通过})$$

---

## 5. 与其他概念的联系

1.  **马尔可夫链 (Markov Chain)**：
    随机游走是状态空间为 $\mathbb{Z}$ 的时齐马尔可夫链。它是理解更复杂马尔可夫链（如生灭过程）的基础模型。

2.  **布朗运动 (Brownian Motion)**：
    根据**唐斯克定理 (Donsker's Theorem)**，如果我们将随机游走的时间步长 $\Delta t \to 0$ 且空间步长 $\Delta x \to 0$，并满足 $(\Delta x)^2 / \Delta t \to \sigma^2$，则随机游走弱收敛于布朗运动（维纳过程）。
    $$W(t) \approx \frac{S_{\lfloor nt \rfloor}}{\sqrt{n}}$$

3.  **鞅 (Martingale)**：
    - 对称简单随机游走 ($p=1/2$) 本身就是一个鞅：$E[S_{n+1} | S_0, \dots, S_n] = S_n$。
    - 非对称随机游走 ($p \neq q$)，虽然 $S_n$ 不是鞅，但 $Y_n = (q/p)^{S_n}$ 是一个鞅（沃尔德鞅，Wald's Martingale），常用于计算破产概率。

4.  **中心极限定理 (CLT)**：
    当 $n$ 很大时，由 CLT 可知，$S_n$ 近似服从正态分布：
    $$\frac{S_n - n(p-q)}{\sqrt{4npq}} \xrightarrow{d} N(0, 1)$$

---

## 6. 常见考点与易错点

### 学习要点
- **奇偶性 (Parity)**：这是随机游走最基本的几何约束。$S_n$ 与 $n$ 具有相同的奇偶性（即 $S_n - n$ 是偶数）。
- **首达时间 (Hitting Time)**：利用反射原理计算首次到达某位置的概率分布是高频考点。
- **条件概率**：熟练运用全概率公式和马尔可夫性分解复杂路径。

### 常见错误
1.  **忽略奇偶性**：
    *错误示例*：计算 $P(S_3 = 0)$。
    *纠正*：3是奇数，0是偶数，奇数步不可能回到原点，概率直接为0，无需计算。
2.  **混淆位移与距离**：
    $E[S_n]$ 是位移的期望（对称时为0），而 $E[|S_n|]$ 是距离的期望（随 $\sqrt{n}$ 增长）。
3.  **赌徒破产边界条件**：
    在使用公式时，搞错 $p$ 和 $q$ 的位置，或者混淆起始资金 $i$ 和总资金 $N$。

### 解题技巧
- 遇到“首次到达”、“最大值”等问题，优先考虑**反射原理**。
- 遇到“最终获胜概率”、“平均停止时间”等问题，优先考虑构造**鞅**并使用停时定理 (Optional Stopping Theorem)，或者建立**差分方程**求解。

希望这份讲解能帮助你深入理解随机游走。如果有具体的习题需要解答，欢迎继续提问。
