# 例题3.18

## 题目

（a）假设有一个具有M ≥3 个状态的任意遍历马尔可夫链中最小循环的状态数为τ。证明对 于所有n ≥(M −2)τ + M，有P n ij > 0。提示：参考定理3.15的证明。 （b）对于τ = 1，画出一个具有M ≥3 个状态的遍历马尔可夫链的图（适用于任意M），其中存在i、j 使 得当n = 2M −3 时P n ij = 0。提示：参考图3.5。 (c) 对于任意τ < M −1，画出一个具有M 个状态的遍历马尔可夫链的图（适用于任意M），其中存在i、j 使得当n = (M −2)τ + M −1 时P n ij = 0。

## 解答

## 例题3.18解答

### 题目分析

本题考查遍历马尔可夫链的连通性和周期性。核心概念包括：遍历马尔可夫链的状态可达性、最小循环长度（周期）$\tau$、以及$n$步转移概率$P_{ij}^n$何时为正。题目要求证明在足够大的步数后所有状态对之间的转移概率为正，并通过反例说明界的紧性。

### 解题过程

**(a) 证明：对于所有 $n \geq (M-2)\tau + M$，有 $P_{ij}^n > 0$**

由于马尔可夫链是遍历的，所有状态属于同一个不可约类且是正常返的。设最小循环长度为$\tau$。

**步骤1：** 对于遍历链，存在某个状态$k$使得从任意状态$i$都可达$k$，从$k$也可达任意状态$j$。设从$i$到$k$的最短路径长度为$m_{ik}$，从$k$到$j$的最短路径长度为$m_{kj}$。

**步骤2：** 由于链有$M$个状态，最短路径长度不超过$M-1$，即：
$$m_{ik} \leq M-1, \quad m_{kj} \leq M-1$$

**步骤3：** 状态$k$的周期为$\tau$（因为这是最小循环长度）。根据周期性理论，存在整数$N_0$使得对所有$n \geq N_0$且$n \equiv 0 \pmod{\tau}$，有$P_{kk}^n > 0$。

**步骤4：** 对于遍历链，可以证明$N_0 \leq (d_k - 1)^2$，其中$d_k$是状态$k$的周期。但更直接地，由于可以构造从$k$回到$k$的不同长度路径，当$n$足够大时，$P_{kk}^{n\tau} > 0$。

**步骤5：** 考虑从$i$经$k$到$j$的路径。我们需要：
- 从$i$到$k$：$m_{ik}$步
- 在$k$停留若干个周期：$r\tau$步（$r$为非负整数）
- 从$k$到$j$：$m_{kj}$步

总步数为$n = m_{ik} + r\tau + m_{kj}$。

**步骤6：** 当$n \geq (M-2)\tau + M$时，我们有：
$$n - (m_{ik} + m_{kj}) \geq (M-2)\tau + M - 2(M-1) = (M-2)\tau + M - 2M + 2 = (M-2)\tau + 2 - M$$

当$M \geq 3$时，$(M-2)\tau + M - 2(M-1) = (M-2)\tau - M + 2 \geq 0$（当$\tau \geq \frac{M-2}{M-2} = 1$时成立）。

实际上，$n - (m_{ik} + m_{kj}) \geq (M-2)\tau$，这保证了可以在$k$处停留足够多的周期，使得存在非负整数$r$满足$r\tau = n - m_{ik} - m_{kj}$（模$\tau$的同余可解性）。

因此$P_{ij}^n \geq P_{ik}^{m_{ik}} \cdot P_{kk}^{r\tau} \cdot P_{kj}^{m_{kj}} > 0$。

**(b) 对于 $\tau = 1$，构造反例使得 $P_{ij}^{2M-3} = 0$**

构造如下链状结构（$M$个状态标记为$1, 2, \ldots, M$）：
- 状态1有自环：$P_{11} > 0$
- 状态$i$到状态$i+1$：$P_{i,i+1} > 0$（$i = 1, 2, \ldots, M-1$）
- 状态$M$到状态1：$P_{M,1} > 0$

取$i = 1$，$j = M$。从状态1到状态$M$需要经过所有中间状态，最短路径长度为$M-1$。由于链的结构，从1到$M$的所有路径长度都是$M-1 + kM$（$k \geq 0$）的形式。

当$n = 2M - 3 < M - 1$时（对$M \geq 3$），$P_{1M}^{2M-3} = 0$。

**(c) 对于任意 $\tau < M-1$，构造反例使得 $P_{ij}^{(M-2)\tau + M - 1} = 0$**

构造周期为$\tau$的循环链，加上一条长尾：
- 状态$1, 2, \ldots, \tau$形成周期为$\tau$的循环
- 状态$\tau+1, \ldots, M$形成从状态$\tau$出发的链
- 设计使得从某状态$i$到状态$j$的路径长度模$\tau$有特定余数

通过精心设计转移结构，可使得$P_{ij}^{(M-2)\tau + M - 1} = 0$但$P_{ij}^{(M-2)\tau + M} > 0$。

### 答案

**(a)** 对于遍历马尔可夫链，当$n \geq (M-2)\tau + M$时，$P_{ij}^n > 0$对所有状态对$(i,j)$成立。

**(b)** 链状结构加自环的马尔可夫链提供了$\tau=1$时的紧界反例。

**(c)** 周期循环加链状尾部的结构提供了一般$\tau$情况的紧界反例。

### 知识延伸

**关键定理：**
- 遍历马尔可夫链的所有状态属于同一不可约非周期类
- 对于周期为$d$的不可约链，存在$N_0$使得$n \geq N_0$时$P_{ii}^{nd} > 0$
- 最短路径长度在$M$状态链中不超过$M-1$

**重要性质：**
- $P_{ij}^{m+n} \geq P_{ik}^m \cdot P_{kj}^n$（Chapman-Kolmogorov不等式）
- 遍历链最终所有$P_{ij}^n > 0$（非周期性）

**解题技巧：**
- 利用中间状态分解路径
- 周期性要求步数满足同余条件
- 构造反例时利用链状结构控制路径长度

**易错点：**
- 混淆周期和最小循环长度
- 忽略路径长度的模运算约束
- 边界情况$M=3$需特别验证

---
