# 例题0.52

## 题目

设m，n 是两个大整数。一个函数F : {0，1，...，n − 1} → { 0，1，...，m − 1} 满足F((x + y)mod n) = ( F(x) + F(y)) mod m。该函数可以查表计算，即 F(x)，0 ≤ x ≤ n − 1 是已知的，但被随机修改 了，设错的位置占比1/5。设计一种算法，可靠计算 F(x)，0 ≤ x ≤ n − 1。 10 0.6. 课后作业

## 解答

**Generating the Response**

I'm now implementing the described steps. The "Analysis," "Solution Process," "Answer," and "Knowledge Extension" sections are being constructed using LaTeX and will accurately reflect the established guidelines for a senior-level mathematical response. I'm focusing on clarity and correctness in the exposition of the probabilistic arguments. I am now proceeding to implement the final output in Chinese.


### 题目分析

本题考察的是**随机算法**中的**自校正（Self-Correcting）**技术，具体涉及**群同态（Group Homomorphism）**的性质利用。
题目给出的函数 $F$ 满足 $F((x + y) \pmod n) = (F(x) + F(y)) \pmod m$，说明 $F$ 是从加法群 $\mathbb{Z}_n$ 到 $\mathbb{Z}_m$ 的同态（即线性函数）。
核心问题在于如何利用函数的**随机自归约性（Random Self-Reducibility）**，通过查询带有噪声（错误率为 $1/5$）的函数表，以高概率恢复出任意给定点 $x$ 的正确函数值。这属于概率论在理论计算机科学中的典型应用。

### 解题过程

**1. 利用同态性质构造随机化计算公式**

根据题目条件，函数 $F$ 满足同态性质：
$$F((a + b) \pmod n) = (F(a) + F(b)) \pmod m$$
这意味着对于任意的 $x \in \{0, \dots, n-1\}$ 和任意的 $r \in \{0, \dots, n-1\}$，我们有：
$$F((x + r) \pmod n) = (F(x) + F(r)) \pmod m$$
移项可得计算 $F(x)$ 的公式：
$$F(x) = (F((x + r) \pmod n) - F(r)) \pmod m$$

**2. 设计随机化算法**

设 $\tilde{F}$ 为已被修改的查表函数（即包含错误的函数表）。已知对于任意 $z$，$\tilde{F}(z) = F(z)$ 的概率为 $1 - 1/5 = 4/5$。
为了计算特定输入 $x$ 的值 $F(x)$，我们设计如下算法：

1.  在 $\{0, 1, \dots, n-1\}$ 中均匀随机地选取一个整数 $r$。
2.  计算 $y = (x + r) \pmod n$。
3.  查询函数表，得到 $\tilde{F}(y)$ 和 $\tilde{F}(r)$。
4.  计算估计值：
    $$V = (\tilde{F}(y) - \tilde{F}(r)) \pmod m$$
5.  输出 $V$ 作为 $F(x)$ 的结果。

**3. 算法可靠性分析**

我们需要计算上述算法输出正确结果的概率，即 $P(V = F(x))$。
算法输出正确的前提是查询的两个点 $y$ 和 $r$ 的函数表值都是正确的。

定义事件 $E_1$ 为 $\tilde{F}(r) = F(r)$，定义事件 $E_2$ 为 $\tilde{F}(y) = F(y)$。
根据题目：
$$P(E_1) = \frac{4}{5}, \quad P(E_1^c) = \frac{1}{5}$$
由于 $r$ 是均匀随机选取的，且 $x$ 是固定的，那么 $y = (x + r) \pmod n$ 在 $\{0, \dots, n-1\}$ 上也是均匀分布的。因此：
$$P(E_2) = \frac{4}{5}, \quad P(E_2^c) = \frac{1}{5}$$

我们需要求 $P(E_1 \cap E_2)$。利用布尔不等式（Union Bound）的补集形式：
$$P(E_1 \cap E_2) = 1 - P(E_1^c \cup E_2^c)$$
$$P(E_1 \cap E_2) \ge 1 - (P(E_1^c) + P(E_2^c))$$
代入数值：
$$P(E_1 \cap E_2) \ge 1 - \left(\frac{1}{5} + \frac{1}{5}\right) = 1 - \frac{2}{5} = \frac{3}{5}$$

**4. 提升可靠性（多数投票法）**

单次采样的正确率至少为 $3/5 = 0.6$，这已经大于 $1/2$。为了获得极高的可靠性，可以独立重复上述过程 $k$ 次，得到 $k$ 个估计值，然后取出现次数最多的值（众数）作为最终结果。根据切诺夫界（Chernoff Bound），随着 $k$ 的增加，错误概率将呈指数级下降。

### 答案

对于任意 $x$，算法如下：均匀随机选取 $r \in \{0, \dots, n-1\}$，计算
$$ \text{Result} = (\tilde{F}((x+r) \pmod n) - \tilde{F}(r)) \pmod m $$
该算法单次计算得到正确 $F(x)$ 的概率 $P \ge \frac{3}{5}$。若需更高可靠性，可重复多次并取众数。

### 知识延伸

1.  **随机自归约性 (Random Self-Reducibility)**：本题利用了线性函数可以将对特定点 $x$ 的求值转化为对两个均匀随机分布点 $x+r$ 和 $r$ 的求值。这种性质使得最坏情况下的查询（Worst-case）可以转化为平均情况下的查询（Average-case）。
2.  **自校正程序 (Self-Correcting Programs)**：这是 Blum, Luby, Rubinfeld 等人提出的程序检查理论的基础。只要错误率低于某个阈值（对于线性函数通常是 $1/4$ 或 $1/3$，取决于具体分析），就可以通过随机化方法以任意高概率修正错误。
3.  **布尔不等式 (Boole's Inequality / Union Bound)**：在概率推导中，用于估计多个事件并集发生的概率上界，即 $P(\cup A_i) \le \sum P(A_i)$。本题中用于估算“至少有一个查询出错”的概率上界。
4.  **易错点**：直接查询 $\tilde{F}(x)$ 的错误率是固定的 $1/5$，无法通过重复查询来降低（因为表是固定的，对同一个 $x$ 查询多次结果一样）。必须引入随机变量 $r$ 来“平滑”查询位置，使得查询点均匀分布在整个定义域上，从而利用统计规律。

---
