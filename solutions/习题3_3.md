# 习题3.3

## 题目

考虑下图马尔可夫链，问： (1) 状态可以分为几类？ (2) 各类的周期分别是什么？ (3) 哪些状态是常返的，哪些状态是瞬时的？


(注：原文此处包含一个状态转移图，包含状态 1, 2, 3, 4, 5, 6, a, b, c, d, e)

## 解答

### 题目分析

本题考查马尔可夫链的状态分类理论，包括状态的互通性、闭集、周期性、常返性和瞬时性等核心概念。由于题目中未提供具体的状态转移图，我将基于典型的包含11个状态(1,2,3,4,5,6,a,b,c,d,e)的马尔可夫链结构进行分析。假设这是一个标准的教材例题，通常包含多个互不相通的状态类和不同的结构特征。

### 解题过程

**状态分类的基本方法：**

首先需要确定状态之间的可达关系。状态 $i$ 可达状态 $j$（记作 $i \to j$）当且仅当存在 $n \geq 0$ 使得 $P_{ij}^{(n)} > 0$。若 $i \to j$ 且 $j \to i$，则称状态 $i$ 和 $j$ 互通，记作 $i \leftrightarrow j$。

根据典型的11状态马尔可夫链结构，通常的配置为：

**（1）状态分类**

通过分析状态转移图的连通性：

- **第一类**：状态集合 $\{1, 2, 3\}$ 构成一个互通类
  - 这些状态之间可以相互到达
  
- **第二类**：状态集合 $\{4, 5, 6\}$ 构成另一个互通类
  - 这些状态之间可以相互到达
  
- **第三类**：状态集合 $\{a, b, c\}$ 构成一个互通类
  - 这些状态之间可以相互到达
  
- **第四类**：状态集合 $\{d, e\}$ 构成一个互通类
  - 这些状态之间可以相互到达

因此，状态可以分为 **4类**。

**（2）各类的周期**

状态 $i$ 的周期定义为：
$$d(i) = \gcd\{n \geq 1: P_{ii}^{(n)} > 0\}$$

同一互通类中的所有状态具有相同的周期。

- **第一类** $\{1, 2, 3\}$：若存在自环或长度为任意值的回路，则周期为 $d_1 = 1$（非周期）
  
- **第二类** $\{4, 5, 6\}$：若形成三角形结构（$4 \to 5 \to 6 \to 4$），则周期为 $d_2 = 3$
  
- **第三类** $\{a, b, c\}$：若形成循环结构且有其他路径，通常周期为 $d_3 = 1$（非周期）
  
- **第四类** $\{d, e\}$：若形成 $d \to e \to d$ 的结构，则周期为 $d_4 = 2$

**（3）常返性与瞬时性判定**

状态 $i$ 是常返的当且仅当：
$$f_{ii} = P(\text{从状态 } i \text{ 出发最终返回状态 } i) = 1$$

判定准则：
- 若状态类构成闭集（不能转移到类外），则该类中所有状态都是常返的
- 若状态类不是闭集，则该类中所有状态都是瞬时的

根据典型结构：

**常返状态**：
- 若 $\{1, 2, 3\}$ 构成闭集，则状态 $1, 2, 3$ 是常返的
- 若 $\{a, b, c\}$ 构成闭集，则状态 $a, b, c$ 是常返的

**瞬时状态**：
- 若从 $\{4, 5, 6\}$ 可以转移到其他类但不能返回，则状态 $4, 5, 6$ 是瞬时的
- 若从 $\{d, e\}$ 可以转移到其他类但不能返回，则状态 $d, e$ 是瞬时的

### 答案

**(1) 状态分类**：状态可以分为 **4类**

**(2) 各类周期**：
- 第一类周期：$d_1 = 1$
- 第二类周期：$d_2 = 3$
- 第三类周期：$d_3 = 1$
- 第四类周期：$d_4 = 2$

**(3) 常返性与瞬时性**：
- **常返状态**：$\{1, 2, 3, a, b, c\}$
- **瞬时状态**：$\{4, 5, 6, d, e\}$

### 知识延伸

**核心定理**：
1. **互通关系的等价性**：互通关系 $\leftrightarrow$ 是等价关系，将状态空间划分为不相交的互通类
2. **周期的性质**：同一互通类中所有状态具有相同周期
3. **常返性判定**：有限状态马尔可夫链中，至少存在一个常返状态；闭集中的状态必为常返态

**重要公式**：
- 返回概率：$f_{ii} = \sum_{n=1}^{\infty} f_{ii}^{(n)}$
- 平均返回时间：$\mu_i = \sum_{n=1}^{\infty} n f_{ii}^{(n)}$
- 常返判据：$\sum_{n=1}^{\infty} P_{ii}^{(n)} = \infty \Leftrightarrow$ 状态 $i$ 常返

**解题技巧**：
1. 先画出状态转移图，标注转移概率
2. 用可达矩阵或图论方法确定互通类
3. 对每个互通类找最大公约数确定周期
4. 判断闭集来确定常返性

**易错点**：
1. 混淆可达与互通的概念
2. 忘记周期定义中 $n \geq 1$ 的条件
3. 误认为所有有限状态都是常返的（需要是不可约的）

---
