# 例题3.16

## 题目

如何将图3.5推广到任意数量（M ≥3）的状态，其中包含一个M 个节点的环和一个M −1 个节点的环。对于M = 4，假设节点1 是不在M −1 个节点的环中的节点。列出从节点1 在n 步内可以到达的 状态集合，其中n ≤12，并证明定理3.15中的界限等式满足。解释为什么该结果对于所有更大的M 也成立。 图3.5: 一个具有6 个状态的遍历马尔可夫链，其中对于所有i、j 和m > (M −1)2，有P m ij > 0，但是P (M−1)2 11 > 0。

## 解答

### 题目分析

本题考查遍历马尔可夫链的周期性和可达性。题目涉及一个特殊结构的马尔可夫链：包含一个$M$个节点的环和一个$M-1$个节点的环，它们共享$M-1$个节点。核心是验证定理3.15关于首次返回时间的界限，即对于遍历链，存在某个时刻$m_0$使得$m > m_0$时所有$P_{ij}^m > 0$，并且这个界限与$(M-1)^2$相关。需要通过$M=4$的具体例子，列出从节点1出发在$n \leq 12$步内可达的状态集合，验证界限等式。

### 解题过程

**结构描述**

对于$M$个状态的链：
- 大环：节点$1 \to 2 \to 3 \to \cdots \to M \to 1$（$M$个节点）
- 小环：节点$2 \to 3 \to \cdots \to M \to 2$（$M-1$个节点）
- 节点1只在大环中，不在小环中

**$M=4$的情况**

状态集合：$\{1, 2, 3, 4\}$

转移结构：
- 从节点1：只能到节点2（沿大环）
- 从节点2：可到节点3（两个环共同边）
- 从节点3：可到节点4（两个环共同边）
- 从节点4：可到节点1（沿大环）或节点2（沿小环）

从节点1出发，$n$步可达状态：

$$\begin{align}
n=1: & \quad \{2\} \\
n=2: & \quad \{3\} \\
n=3: & \quad \{4\} \\
n=4: & \quad \{1, 2\} \\
n=5: & \quad \{2, 3\} \\
n=6: & \quad \{3, 4\} \\
n=7: & \quad \{1, 2, 4\} \\
n=8: & \quad \{1, 2, 3\} \\
n=9: & \quad \{1, 2, 3, 4\} \\
n=10: & \quad \{1, 2, 3, 4\} \\
n=11: & \quad \{1, 2, 3, 4\} \\
n=12: & \quad \{1, 2, 3, 4\}
\end{align}$$

**验证界限**

对于$M=4$，$(M-1)^2 = 9$。

关键观察：
- $P_{11}^{(M-1)^2} = P_{11}^9 > 0$：从节点1出发，经过4步回到1（沿大环），再经过3步的小环循环，或其他组合
- 对于$m > 9$，所有$P_{ij}^m > 0$

具体验证$P_{11}^9 > 0$的路径：
- 路径1：$1 \to 2 \to 3 \to 4 \to 1 \to 2 \to 3 \to 4 \to 1$（两次大环，8步）+ 额外调整
- 路径2：$1 \to 2 \to 3 \to 4 \to 2 \to 3 \to 4 \to 2 \to 3$后无法直接回1
- 正确路径：$1 \to 2 \to 3 \to 4 \to 1$（4步）+ $1 \to 2 \to 3 \to 4 \to 2$（5步，共9步但未回1）

实际上，从节点1回到节点1的步数必须是大环长度$M=4$的倍数，因此$P_{11}^9 = 0$（因为$9$不是$4$的倍数）。

重新理解：定理3.15的界限是指对于$m > (M-1)^2$，所有$P_{ij}^m > 0$，但$P_{11}^{(M-1)^2}$可能为0。

**一般性证明**

对于任意$M \geq 3$：
- 大环周期：$M$
- 小环周期：$M-1$
- $\gcd(M, M-1) = 1$（互质）

由于两个环的周期互质，链是非周期的。在$(M-1)^2$步后，可以到达任意状态组合。对于$m > (M-1)^2$，由于非周期性和遍历性，所有$P_{ij}^m > 0$。

### 答案

从节点1在$n \leq 12$步可达的状态集合如上所示。对于$M=4$，当$n \geq 9 = (M-1)^2$时，所有状态都可达。定理3.15的界限$m_0 = (M-1)^2$成立，因为大环（周期$M$）和小环（周期$M-1$）互质，保证了链的非周期性，使得在$(M-1)^2$步后能够到达所有状态。

### 知识延伸

**相关定理**：
- 遍历定理：不可约非周期马尔可夫链存在唯一平稳分布
- 周期性判定：状态$i$的周期$d(i) = \gcd\{n: P_{ii}^n > 0\}$
- 互质周期导致非周期性：若存在两条不同周期的回路且周期互质，则链非周期

**重要性质**：
- 对于有限状态遍历链，存在$m_0$使得$m > m_0$时转移矩阵$P^m$所有元素为正
- 界限$(M-1)^2$来自于组合两个互质周期所需的最大步数

**解题技巧**：
- 识别链的环结构和周期
- 利用$\gcd$判断非周期性
- 通过具体路径验证可达性

**易错点**：
- 混淆"$P_{11}^{m_0} > 0$"与"对所有$i,j$，$P_{ij}^m > 0$（$m > m_0$）"
- 忽略周期性对返回时间的限制

---
