# 例题4.4

## 题目

以速率λ > 0“到达”的泊松过程。则我们可以考虑如下分布的概率密度函数、均值、方差、矩 生成函数等 • 指数分布（ “首次到达” ，间隔分布） ：到达间隔X 服从指数分布Pr{X > t } = e−λt，t ≥ 0。 • 泊松分布：(0，t] 到达次数 • Erlang 分布（第n 次到达的时刻）

## 解答

**Refining the Approach**

I'm now focusing on refining the "解题过程" section, specifically the Erlang distribution part. I've decided to emphasize the MGF approach for the Erlang PDF, as it elegantly connects to the exponential distribution's MGF, which is a key concept. I'll also ensure clear distinctions between deriving each component (PDF, Mean, Variance, MGF) to make the solution process transparent. Furthermore, I need to make the LaTeX code concise and effective for presentation.


### 题目分析

本题要求针对一个速率为 $\lambda > 0$ 的泊松过程（Poisson Process），详细推导并总结三个核心随机变量的统计特性：概率密度函数（PDF）或概率质量函数（PMF）、均值（Mean）、方差（Variance）以及矩生成函数（MGF）。这三个随机变量分别是：
1.  **到达间隔 $X$**：服从指数分布（Exponential Distribution）。
2.  **$(0, t]$ 时段内的到达次数 $N(t)$**：服从泊松分布（Poisson Distribution）。
3.  **第 $n$ 次到达的时刻 $S_n$**：服从爱尔朗分布（Erlang Distribution）。

本题考查泊松过程的基本定义、随机变量的数字特征计算以及特征函数/矩生成函数的应用。

---

### 解题过程

#### 1. 到达间隔 $X$（指数分布）

**定义与概率密度函数 (PDF)：**
题目给出 $X$ 的生存函数（Tail Probability）为 $P(X > t) = e^{-\lambda t}$ ($t \ge 0$)。
分布函数（CDF）为：
$$F_X(t) = P(X \le t) = 1 - P(X > t) = 1 - e^{-\lambda t}, \quad t \ge 0$$
对 $t$ 求导得到概率密度函数：
$$f_X(t) = \frac{d}{dt}F_X(t) = \lambda e^{-\lambda t}, \quad t \ge 0$$

**矩生成函数 (MGF)：**
定义 $M_X(u) = E[e^{uX}]$，其中 $u < \lambda$ 以保证积分收敛：
$$M_X(u) = \int_0^{\infty} e^{ut} \lambda e^{-\lambda t} dt = \lambda \int_0^{\infty} e^{-(\lambda - u)t} dt$$
$$M_X(u) = \lambda \left[ \frac{-1}{\lambda - u} e^{-(\lambda - u)t} \right]_0^{\infty} = \frac{\lambda}{\lambda - u}, \quad (u < \lambda)$$

**均值与方差：**
利用 MGF 的性质 $E[X^k] = M_X^{(k)}(0)$。
一阶导数：
$$M_X'(u) = \frac{\lambda}{(\lambda - u)^2} \implies E[X] = M_X'(0) = \frac{1}{\lambda}$$
二阶导数：
$$M_X''(u) = \frac{2\lambda}{(\lambda - u)^3} \implies E[X^2] = M_X''(0) = \frac{2}{\lambda^2}$$
方差：
$$\text{Var}(X) = E[X^2] - (E[X])^2 = \frac{2}{\lambda^2} - \left(\frac{1}{\lambda}\right)^2 = \frac{1}{\lambda^2}$$

---

#### 2. $(0, t]$ 内的到达次数 $N(t)$（泊松分布）

**概率质量函数 (PMF)：**
根据泊松过程定义，时间长度为 $t$ 的区间内到达次数 $N(t)$ 服从参数为 $\lambda t$ 的泊松分布：
$$P(N(t) = k) = \frac{(\lambda t)^k}{k!} e^{-\lambda t}, \quad k = 0, 1, 2, \dots$$

**矩生成函数 (MGF)：**
$$M_{N(t)}(u) = E[e^{u N(t)}] = \sum_{k=0}^{\infty} e^{uk} \frac{(\lambda t)^k}{k!} e^{-\lambda t}$$
$$M_{N(t)}(u) = e^{-\lambda t} \sum_{k=0}^{\infty} \frac{(\lambda t e^u)^k}{k!} = e^{-\lambda t} e^{\lambda t e^u} = e^{\lambda t (e^u - 1)}$$

**均值与方差：**
令 $\mu = \lambda t$。
一阶导数：
$$M_{N(t)}'(u) = \mu e^u e^{\mu(e^u - 1)} \implies E[N(t)] = \mu = \lambda t$$
二阶导数：
$$M_{N(t)}''(u) = \mu e^u e^{\mu(e^u - 1)} + (\mu e^u)^2 e^{\mu(e^u - 1)}$$
$$E[N(t)^2] = M_{N(t)}''(0) = \mu + \mu^2 = \lambda t + (\lambda t)^2$$
方差：
$$\text{Var}(N(t)) = E[N(t)^2] - (E[N(t)])^2 = \lambda t + (\lambda t)^2 - (\lambda t)^2 = \lambda t$$

---

#### 3. 第 $n$ 次到达时刻 $S_n$（Erlang 分布）

**定义与关系：**
第 $n$ 次到达时刻 $S_n$ 是前 $n$ 个独立的到达间隔之和：
$$S_n = X_1 + X_2 + \dots + X_n$$
其中 $X_i \overset{i.i.d.}{\sim} \text{Exp}(\lambda)$。

**矩生成函数 (MGF)：**
独立随机变量和的 MGF 等于各变量 MGF 的乘积：
$$M_{S_n}(u) = \prod_{i=1}^n M_{X_i}(u) = \left( \frac{\lambda}{\lambda - u} \right)^n, \quad (u < \lambda)$$

**概率密度函数 (PDF)：**
对应于 MGF $\left( \frac{\lambda}{\lambda - u} \right)^n$ 的分布是参数为 $(n, \lambda)$ 的 Gamma 分布（当形状参数为整数 $n$ 时称为 Erlang 分布）：
$$f_{S_n}(t) = \frac{\lambda^n t^{n-1}}{(n-1)!} e^{-\lambda t}, \quad t \ge 0$$

**均值与方差：**
利用期望和方差的线性性质（独立性）：
$$E[S_n] = \sum_{i=1}^n E[X_i] = n \cdot \frac{1}{\lambda} = \frac{n}{\lambda}$$
$$\text{Var}(S_n) = \sum_{i=1}^n \text{Var}(X_i) = n \cdot \frac{1}{\lambda^2} = \frac{n}{\lambda^2}$$

---

### 答案

针对速率为 $\lambda$ 的泊松过程，各分布特性如下：

1.  **指数分布 (到达间隔 $X$)**
    *   PDF: $f_X(t) = \lambda e^{-\lambda t}, \quad t \ge 0$
    *   均值: $E[X] = \frac{1}{\lambda}$
    *   方差: $\text{Var}(X) = \frac{1}{\lambda^2}$
    *   MGF: $M_X(u) = \frac{\lambda}{\lambda - u}, \quad u < \lambda$

2.  **泊松分布 (计数 $N(t)$)**
    *   PMF: $P(N(t)=k) = \frac{(\lambda t)^k}{k!} e^{-\lambda t}, \quad k=0,1,\dots$
    *   均值: $E[N(t)] = \lambda t$
    *   方差: $\text{Var}(N(t)) = \lambda t$
    *   MGF: $M_{N(t)}(u) = e^{\lambda t(e^u - 1)}$

3.  **Erlang 分布 (第 $n$ 次到达时刻 $S_n$)**
    *   PDF: $f_{S_n}(t) = \frac{\lambda^n t^{n-1}}{(n-1)!} e^{-\lambda t}, \quad t \ge 0$
    *   均值: $E[S_n] = \frac{n}{\lambda}$
    *   方差: $\text{Var}(S_n) = \frac{n}{\lambda^2}$
    *   MGF: $M_{S_n}(u) = \left( \frac{\lambda}{\lambda - u} \right)^n, \quad u < \lambda$

---

### 知识延伸

1.  **无记忆性 (Memoryless Property)**：
    指数分布是唯一具有无记忆性的连续型概率分布，即 $P(X > s+t | X > s) = P(X > t)$。这意味着无论过去等待了多久，下一次到达所需的剩余时间的分布是不变的。

2.  **计数过程与到达时刻的对偶关系**：
    事件 $\{N(t) \ge n\}$ 等价于事件 $\{S_n \le t\}$。即“在时间 $t$ 内至少有 $n$ 个到达”等同于“第 $n$ 个到达发生在时间 $t$ 之前”。利用此关系可以推导 Erlang 分布的 CDF 与泊松分布 CDF 之间的联系：
    $$F_{S_n}(t) = P(S_n \le t) = \sum_{k=n}^{\infty} \frac{(\lambda t)^k}{k!} e^{-\lambda t}$$

3.  **Gamma 分布的特例**：
    Erlang 分布是 Gamma 分布 $\Gamma(\alpha, \beta)$ 的特例，其中形状参数 $\alpha = n$ 为正整数，尺度参数 $\beta = \lambda$（或率参数）。

4.  **易错点**：
    *   混淆泊松分布的参数 $\lambda t$ 与速率 $\lambda$。
    *   在计算 MGF 时忘记注明收敛域（如 $u < \lambda$）。
    *   混淆 Erlang 分布的方差 $\frac{n}{\lambda^2}$ 与标准差 $\frac{\sqrt{n}}{\lambda}$。

---
