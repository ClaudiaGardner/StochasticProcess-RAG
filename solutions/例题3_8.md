# 例题3.8

## 题目

设m, n 是互素的正整数，则存在正整数T0, 使所有的正整数T ≥ T0 都可以由m，n 的非负组 合表示，即，∀T ≥ T0，∃u，v ∈ N，使得 um + vn = T。 证明：由 m, n 互素（不妨设 m > n ） ，则存在正整数s，t，使得 sm − tn = 1 。令 T0 = tn2，则对于所有 T ≥ T0，由欧几里得算法，得 T = qn + r，q ≥ tn，0 ≤ r < n 。 32 3.2. 状态分类 所以 T = qn + r(sm − tn) = ( q − rt) · n + rs · m。 【定理 3.9】 对于任意的马尔可夫链（无论其状态数是有限的还是可数无穷的） ，同一个类中的所有状态具 有相同的周期。 证明. 设 i 和 j 是在一个类 C 中任意的不同状态对。那么存在某个 n 使得 Pn ij > 0，同时存在某个 m 使得 Pm ji > 0。 • 由于存在一条长度为n + m 的路从 i 到j 再返回到i，所以 n + m 必须能被d(i) 整除。 • 设t 是一个使得Pt jj > 0 的整数。由于存在一条长度为n + t + m 的路从i 到j 再返回到j，最后到达i，所 以n + t + m 能被 d(i) 整除，因此 t 能被 d(i) 整除。 • 由于这对于所有使得Pt jj > 0 的t 都成立，因此d(j) 能被 d(i) 整除。 • 反过来，交换i 和j 的角色，可以得知 d(i) 能被 d(j) 整除，因此d(i) = d(j)。 【定理 3.10】 如果一个有限状态马尔可夫链的常返类 C 周期为 d，则可以将 C 中的状态分成 d 个子集， S0, S1, . . . , Sd−1，使得从sℓ ∈ Sℓ 一步转移进入 sℓ+1 ∈ Sℓ. 这里的下标 ℓ 指ℓ mod d。 换句话说，从该类中的任何子类开始，该链将会循环经过 d 个子类。 3.2.2 遍历类 【定义 3.11】 对于一个有限状态马尔科夫链，遍历类是指这类状态既是常返的又是非周期的。如果一个马 尔科夫链只包含一个类并且是遍历类，称作遍历链。

## 解答

**Refining Proof Steps**

I'm currently focused on the "解题过程" section, particularly the proof of Example 3.8. I'm double-checking each step and ensuring the logic is airtight, especially the bounds used. I've also drafted the proof of Theorem 3.9, ensuring the implications between periodicity and communicating classes are clear. Next, I plan to finalize the "答案" and "知识延伸" sections.


### 题目分析

本段内容主要包含三个部分：一个数论引理（例题3.8）的证明、马尔可夫链状态分类中关于周期性的定理（定理3.9）的证明，以及常返类分解定理（定理3.10）和遍历类的定义（定义3.11）。

1.  **核心概念**：
    *   **数论性质**：互素整数的非负线性组合（Frobenius Coin Problem 的特例）。
    *   **马尔可夫链（Markov Chain）**：状态分类、周期性（Periodicity）、常返性（Recurrence）、遍历性（Ergodicity）。
2.  **数学符号**：
    *   $m, n$：互素的正整数。
    *   $d(i)$：状态 $i$ 的周期。
    *   $P_{ij}^n$：从状态 $i$ 经过 $n$ 步转移到状态 $j$ 的概率。
    *   $\mathcal{C}$：马尔可夫链的一个类（Class）。
3.  **目标**：
    *   证明对于互素的 $m, n$，存在阈值 $T_0$，使得所有 $T \ge T_0$ 均可表示为 $um+vn$（用于后续证明非周期状态在足够多步数后必可达）。
    *   证明同一类中的状态具有相同的周期。
    *   定义遍历类。

---

### 解题过程

#### 1. 例题 3.8：互素整数的线性组合性质证明

**命题**：设 $m, n$ 是互素的正整数（不妨设 $m > n$），则存在正整数 $T_0$，使得 $\forall T \ge T_0$，存在非负整数 $u, v \in \mathbb{N}$，满足 $um + vn = T$。

**证明**：
由于 $\gcd(m, n) = 1$，根据裴蜀定理（Bézout's identity）的推论，存在正整数 $s, t$ 使得：
$$sm - tn = 1$$
*(注：此处选取 $s, t$ 为满足该方程的最小正整数解)*

令 $T_0 = tn^2$。对于任意 $T \ge T_0$，利用欧几里得除法（带余除法），将 $T$ 对 $n$ 做除法：
$$T = qn + r, \quad \text{其中 } 0 \le r < n$$

我们需要分析商 $q$ 的范围。因为 $T \ge tn^2$ 且 $r < n$，所以：
$$qn = T - r > tn^2 - n = n(tn - 1)$$
这意味着 $q > tn - 1$。由于 $q$ 是整数，故有：
$$q \ge tn$$

利用 $1 = sm - tn$，我们可以将余数 $r$ 表示为：
$$r = r \cdot 1 = r(sm - tn) = rsm - rtn$$

将其代入 $T$ 的表达式中：
$$
\begin{aligned}
T &= qn + r \\
&= qn + (rsm - rtn) \\
&= (q - rt)n + (rs)m
\end{aligned}
$$
令 $v = q - rt$，$u = rs$。我们需要验证 $u, v$ 是否为非负整数。
1.  显然 $u = rs \ge 0$（因为 $r, s \ge 0$）。
2.  对于 $v = q - rt$，已知 $q \ge tn$，且 $r \le n-1$（余数性质）。
    $$rt \le (n-1)t = tn - t$$
    所以：
    $$v = q - rt \ge tn - (tn - t) = t > 0$$
    故 $v$ 也是非负整数。

**结论**：对于所有 $T \ge tn^2$，均可表示为 $T = u \cdot m + v \cdot n$ 的形式。

---

#### 2. 定理 3.9：周期是类的属性（Class Property）

**命题**：对于任意马尔可夫链，同一个类 $\mathcal{C}$ 中的所有状态具有相同的周期。即若 $i \leftrightarrow j$，则 $d(i) = d(j)$。

**证明**：
设 $i, j \in \mathcal{C}$ 是任意两个不同的状态。
周期的定义为 $d(i) = \gcd\{n \ge 1 : P_{ii}^n > 0\}$。

由于 $i \leftrightarrow j$（互通），存在整数 $n, m$ 使得：
$$P_{ij}^n > 0 \quad \text{且} \quad P_{ji}^m > 0$$

1.  **考察 $d(i)$ 的整除性**：
    存在一条路径 $i \to \dots \to j \to \dots \to i$，步数为 $n+m$。
    根据 Chapman-Kolmogorov 方程，$P_{ii}^{n+m} \ge P_{ij}^n P_{ji}^m > 0$。
    由周期的定义，$d(i)$ 必须整除所有使 $P_{ii}^k > 0$ 的步数 $k$，故：
    $$d(i) \mid (n + m)$$

2.  **引入 $j$ 的回路**：
    设 $t$ 是任意使得 $P_{jj}^t > 0$ 的整数。
    构造路径 $i \to j \xrightarrow{t} j \to i$，总步数为 $n + t + m$。
    这意味着 $P_{ii}^{n+t+m} > 0$。
    同理，由周期的定义：
    $$d(i) \mid (n + t + m)$$

3.  **推导 $d(i) \mid t$**：
    由于 $d(i) \mid (n + m + t)$ 且 $d(i) \mid (n + m)$，根据整除的线性性质：
    $$d(i) \mid [(n + t + m) - (n + m)] \implies d(i) \mid t$$

4.  **结论**：
    上述结论对**所有**使得 $P_{jj}^t > 0$ 的 $t$ 都成立。
    因此，$d(i)$ 必须整除这些 $t$ 的最大公约数。而这些 $t$ 的最大公约数正是 $d(j)$。
    即：
    $$d(i) \mid d(j)$$

5.  **对称性**：
    交换 $i$ 和 $j$ 的角色，重复上述过程，可得：
    $$d(j) \mid d(i)$$

综上所述，由于 $d(i)$ 和 $d(j)$ 均为正整数且互相整除，故 $d(i) = d(j)$。

---

### 答案

1.  **例题 3.8 结论**：对于互素正整数 $m, n$，存在 $T_0 = tn^2$（其中 $sm-tn=1$），使得 $\forall T \ge T_0$，方程 $um+vn=T$ 有非负整数解。这在马尔可夫链中意味着：若状态 $i$ 是非周期的（$d(i)=1$），则存在 $N$，使得 $\forall n \ge N, P_{ii}^n > 0$。
2.  **定理 3.9 结论**：周期性是类性质。若状态 $i$ 和 $j$ 属于同一个互通类，则 $d(i) = d(j)$。
3.  **定义 3.11**：**遍历类（Ergodic Class）**是指既是**常返（Recurrent）**又是**非周期（Aperiodic）**的状态类。

---

### 知识延伸

1.  **Frobenius Coin Problem (Coin Problem)**：
    例题 3.8 是著名的 Frobenius 硬币问题的特例（$n=2$ 的情况）。对于互素的 $m, n$，不能由 $m, n$ 非负线性组合表示的最大整数（Frobenius 数）是 $mn - m - n$。题目中的 $T_0$ 是一个较宽松的上界。

2.  **非周期性的重要推论**：
    如果一个状态 $i$ 的周期 $d(i)=1$，这并不意味着 $P_{ii}^1 > 0$，而是指集合 $\{n : P_{ii}^n > 0\}$ 的最大公约数为 1。结合例题 3.8 的数论性质，可以证明：若 $i$ 非周期，则存在 $N$，使得对于所有 $n \ge N$，都有 $P_{ii}^n > 0$。这是证明马尔可夫链极限定理（Ergodic Theorem）的关键步骤。

3.  **常返类的循环分解（定理 3.10）**：
    若常返类 $\mathcal{C}$ 的周期为 $d$，则 $\mathcal{C}$ 可以被划分为 $d$ 个互不相交的子集 $S_0, S_1, \dots, S_{d-1}$。
    状态转移具有确定性的循环结构：从 $S_r$ 中的状态出发，一步转移必然进入 $S_{r+1 \pmod d}$。
    $$P(X_{n+1} \in S_{r+1} \mid X_n \in S_r) = 1$$

4.  **易错点提示**：
    *   **周期 vs 返回时间**：周期 $d(i)$ 是所有返回步数的最大公约数，不要混淆为平均返回时间。
    *   **遍历性条件**：仅有常返性不足以保证极限分布的存在（可能存在周期性震荡），必须同时满足非周期性。对于有限状态链，常返且非周期即为遍历；对于无限状态链，还需加上“正常返”（Positive Recurrent）条件。

---
