# 习题3.14

## 题目

设 $\{\xi_{n} ; \ n \geq1 \}$ 为一列独立同分布的非负整数值随机变量且与非负整数值随机变量 $X_{0}$ 独立。对 $n > 1 ,$ . 令 $$ X_{n}=\left\{\begin{array} {l} {X_{n}-1+\xi_{n} , \, \, \, X_{n-1} > 0} \\ {\xi_{n} , \, \, \, X_{n-1}=0} \\ \end{array} \right. $$ 证明 $\mathrm{X}=\{X_{n} , \; \; n \geq0 \}$ 为时齐马氏链。若记 $p_{k}=P ( \xi_{k}=1 )$ 求 ...

## 解答

### 题目分析

本题给出一个递推定义的随机过程 $\{X_n, n \geq 0\}$，其中 $X_n$ 的取值依赖于 $X_{n-1}$ 和独立同分布的随机变量 $\xi_n$。当 $X_{n-1} > 0$ 时，$X_n = X_{n-1} - 1 + \xi_n$（减少1后加上新到达量）；当 $X_{n-1} = 0$ 时，$X_n = \xi_n$（直接等于新到达量）。这是一个排队论中的经典模型。需要证明该过程具有马尔可夫性和时齐性。题目还要求利用 $p_k = P(\xi_k = 1)$ 求某些量（题目未完整给出后续要求，但通常是求转移概率矩阵）。

### 解题过程

**第一步：证明马尔可夫性**

要证明 $X = \{X_n, n \geq 0\}$ 是马尔可夫链，需要证明：
$$P(X_{n+1} = j | X_n = i, X_{n-1} = i_{n-1}, \ldots, X_0 = i_0) = P(X_{n+1} = j | X_n = i)$$

根据 $X_n$ 的定义，$X_{n+1}$ 的取值完全由 $X_n$ 和 $\xi_{n+1}$ 决定：

- 当 $X_n > 0$ 时，$X_{n+1} = X_n - 1 + \xi_{n+1}$
- 当 $X_n = 0$ 时，$X_{n+1} = \xi_{n+1}$

由于 $\{\xi_n\}$ 是独立同分布序列，且与 $X_0$ 独立，因此 $\xi_{n+1}$ 与 $X_0, X_1, \ldots, X_{n-1}$ 独立，仅通过 $X_n$ 影响 $X_{n+1}$。

给定 $X_n = i$ 后，$X_{n+1}$ 的条件分布为：

$$P(X_{n+1} = j | X_n = i, X_{n-1}, \ldots, X_0) = P(X_{n+1} = j | X_n = i)$$

这是因为：
- 若 $i > 0$，则 $X_{n+1} = i - 1 + \xi_{n+1}$，而 $\xi_{n+1}$ 独立于历史
- 若 $i = 0$，则 $X_{n+1} = \xi_{n+1}$，同样独立于历史

因此满足马尔可夫性。

**第二步：证明时齐性**

时齐性要求转移概率与时间 $n$ 无关，即：
$$P(X_{n+1} = j | X_n = i) = P(X_1 = j | X_0 = i)$$

由于 $\{\xi_n\}$ 是独立同分布的，对任意 $n \geq 1$，$\xi_n$ 的分布相同。因此：

- 当 $i > 0$ 时：
$$P(X_{n+1} = j | X_n = i) = P(i - 1 + \xi_{n+1} = j) = P(\xi_{n+1} = j - i + 1)$$

- 当 $i = 0$ 时：
$$P(X_{n+1} = j | X_n = 0) = P(\xi_{n+1} = j)$$

这些概率都不依赖于 $n$，仅依赖于 $i$ 和 $j$，因此过程是时齐的。

**第三步：求转移概率矩阵**

设 $q_k = P(\xi_n = k)$，$k = 0, 1, 2, \ldots$

转移概率 $P_{ij} = P(X_{n+1} = j | X_n = i)$ 为：

- 当 $i = 0$ 时：
$$P_{0j} = P(\xi_{n+1} = j) = q_j, \quad j \geq 0$$

- 当 $i \geq 1$ 时：
$$P_{ij} = P(\xi_{n+1} = j - i + 1) = \begin{cases}
q_{j-i+1}, & \text{若 } j \geq i - 1 \\
0, & \text{若 } j < i - 1
\end{cases}$$

特别地，若记 $p_k = P(\xi_k = 1)$，则：
- $P_{01} = q_1 = p_k$（所有 $\xi_k$ 同分布）
- $P_{i,i} = q_1$（从状态 $i$ 到状态 $i$ 需要 $\xi_{n+1} = 1$）
- $P_{i,i-1} = q_0$（从状态 $i$ 到状态 $i-1$ 需要 $\xi_{n+1} = 0$）

### 答案

$X = \{X_n, n \geq 0\}$ 是时齐马尔可夫链，其转移概率矩阵为：

$$P_{ij} = \begin{cases}
q_j, & i = 0, j \geq 0 \\
q_{j-i+1}, & i \geq 1, j \geq i-1 \\
0, & i \geq 1, j < i-1
\end{cases}$$

其中 $q_k = P(\xi_n = k)$。

### 知识延伸

**涉及的核心定理**：
1. **马尔可夫性定义**：未来状态仅依赖于当前状态，与历史无关
2. **时齐性**：转移概率不随时间变化
3. **独立性的应用**：独立随机变量序列保证了马尔可夫性

**重要性质**：
- 本模型是 **GI/G/1 排队系统的嵌入马尔可夫链**（在服务完成时刻观察）
- 状态空间为非负整数集 $\{0, 1, 2, \ldots\}$
- 转移概率矩阵具有特殊结构：从状态 $i > 0$ 只能转移到 $\{i-1, i, i+1, \ldots\}$

**解题技巧**：
- 证明马尔可夫性的关键是利用独立性，说明给定现在，未来与过去条件独立
- 时齐性的证明依赖于驱动过程（$\{\xi_n\}$）的独立同分布性质

**易错点**：
- 注意 $i = 0$ 和 $i > 0$ 两种情况的转移规则不同
- 转移概率的下标对应关系：$P_{ij}$ 中 $j - i + 1$ 是 $\xi$ 需要取的值

---
