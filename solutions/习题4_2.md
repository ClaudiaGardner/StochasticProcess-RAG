# 习题4.2

## 题目

假设更新过程的到达间隔分布是均值为 $\mu$ (1)求 $S_{n}$ 的分。 (2）计算 $P \{N ( t )=n \}$ 。

## 解答

**Refining Assumptions and Strategy**

My focus has shifted towards solidifying the critical assumption about the exponential distribution. I'm now drafting a clear statement that acknowledges the potential ambiguity in the prompt's wording ("均值为 μ"), justifying the choice based on the context of renewal processes and the request for explicit calculations. This clarifies that a closed-form solution is the expected format. I will also incorporate explicit mentions of key variables (like Xi, Sn, and N(t)) and the link between exponential and Gamma distributions.


### 题目分析

本题考查**更新过程（Renewal Process）**的基础性质，特别是**泊松过程（Poisson Process）**的相关理论。
1.  **题目解读**：题目表述中“假设更新过程的到达间隔分布是均值为 $\mu$”这一句存在缺漏，通常在概率论习题中，若要求解具体的 $S_n$ 分布密度和 $N(t)$ 的概率质量函数，且只给出了均值，默认假设到达间隔服从**指数分布（Exponential Distribution）**。若为一般分布，无法给出具体的解析式。因此，本解答基于到达间隔 $X_i$ 服从参数为 $\lambda = 1/\mu$ 的指数分布进行推导。
2.  **核心概念**：
    *   **到达间隔（Inter-arrival times）** $X_i$：独立同分布（i.i.d.）的随机变量。
    *   **第 $n$ 次更新时刻（Arrival times）** $S_n$：$S_n = \sum_{i=1}^n X_i$。
    *   **计数过程（Counting Process）** $N(t)$：在 $[0, t]$ 时间内的更新次数。
3.  **求解目标**：
    *   (1) $S_n$ 的概率密度函数（PDF）。
    *   (2) $N(t) = n$ 的概率，即泊松分布的推导。

### 解题过程

设更新过程的到达间隔序列为 $\{X_1, X_2, \dots\}$，它们是独立同分布的随机变量。根据题目分析，假设 $X_i$ 服从均值为 $\mu$ 的指数分布。
设 $\lambda = \frac{1}{\mu}$，则 $X_i$ 的概率密度函数为：
$$f_X(x) = \begin{cases} \lambda e^{-\lambda x}, & x \ge 0 \\ 0, & x < 0 \end{cases}$$

#### (1) 求 $S_n$ 的分布

$S_n$ 表示第 $n$ 次事件发生的时刻，定义为前 $n$ 个到达间隔之和：
$$S_n = X_1 + X_2 + \dots + X_n$$

由于 $X_i$ 相互独立且服从参数为 $\lambda$ 的指数分布，求 $S_n$ 的分布即求 $n$ 个独立同分布指数随机变量的和的分布。我们可以利用**特征函数（Characteristic Function）**或**矩母函数（Moment Generating Function, MGF）**来求解。

$X_i$ 的矩母函数为：
$$M_X(t) = E[e^{tX}] = \int_0^\infty e^{tx} \lambda e^{-\lambda x} dx = \frac{\lambda}{\lambda - t}, \quad (t < \lambda)$$

利用独立性，$S_n$ 的矩母函数为：
$$M_{S_n}(t) = E[e^{t \sum X_i}] = \prod_{i=1}^n M_{X_i}(t) = \left( \frac{\lambda}{\lambda - t} \right)^n$$

上述表达式正是参数为 $(n, \lambda)$ 的**伽玛分布（Gamma Distribution）**（在整数 $n$ 的情况下也称为爱尔朗分布 Erlang Distribution）的矩母函数。

因此，$S_n$ 的概率密度函数 $f_{S_n}(t)$ 为：
$$f_{S_n}(t) = \begin{cases} \frac{\lambda (\lambda t)^{n-1}}{(n-1)!} e^{-\lambda t}, & t \ge 0 \\ 0, & t < 0 \end{cases}$$

将 $\lambda = \frac{1}{\mu}$ 代入，得：
$$f_{S_n}(t) = \frac{1}{\mu^n (n-1)!} t^{n-1} e^{-t/\mu}, \quad t \ge 0$$

#### (2) 计算 $P \{N ( t )=n \}$

$N(t)$ 表示截止到时刻 $t$ 事件发生的次数。事件 $\{N(t) = n\}$ 等价于“第 $n$ 次事件发生在时刻 $t$ 或之前，且第 $n+1$ 次事件发生在时刻 $t$ 之后”。
用数学公式表示为：
$$N(t) = n \iff S_n \le t < S_{n+1}$$

利用全概率公式或直接积分，我们可以通过 $S_n$ 的分布来计算。更严谨的方法是利用分布函数的关系：
$$P(N(t) \ge n) = P(S_n \le t)$$
因此：
$$P(N(t) = n) = P(N(t) \ge n) - P(N(t) \ge n+1) = P(S_n \le t) - P(S_{n+1} \le t)$$

设 $F_n(t) = P(S_n \le t)$ 是 Gamma$(n, \lambda)$ 的分布函数。
利用分部积分法，我们可以建立 $F_n(t)$ 与 $F_{n+1}(t)$ 的关系。
对于 Gamma 分布：
$$F_n(t) = \int_0^t \frac{\lambda^n x^{n-1}}{(n-1)!} e^{-\lambda x} dx$$

对 $F_{n+1}(t)$ 进行分部积分：
$$F_{n+1}(t) = \int_0^t \frac{\lambda^{n+1} x^{n}}{n!} e^{-\lambda x} dx$$
令 $u = \frac{(\lambda x)^n}{n!}$，$dv = \lambda e^{-\lambda x} dx$，则 $du = \frac{\lambda^n x^{n-1}}{(n-1)!} dx$，$v = -e^{-\lambda x}$。
$$F_{n+1}(t) = \left[ - \frac{(\lambda x)^n}{n!} e^{-\lambda x} \right]_0^t + \int_0^t \frac{\lambda^n x^{n-1}}{(n-1)!} e^{-\lambda x} dx$$
$$F_{n+1}(t) = - \frac{(\lambda t)^n}{n!} e^{-\lambda t} + F_n(t)$$

移项得：
$$F_n(t) - F_{n+1}(t) = \frac{(\lambda t)^n}{n!} e^{-\lambda t}$$

代入概率公式：
$$P(N(t) = n) = \frac{(\lambda t)^n}{n!} e^{-\lambda t}$$

将 $\lambda = \frac{1}{\mu}$ 代入：
$$P(N(t) = n) = \frac{(t/\mu)^n}{n!} e^{-t/\mu}$$

这表明 $N(t)$ 服从参数为 $\lambda t = \frac{t}{\mu}$ 的泊松分布。

### 答案

(1) $S_n$ 服从参数为 $(n, 1/\mu)$ 的伽玛分布（Erlang分布），其概率密度函数为：
$$f_{S_n}(t) = \frac{1}{\mu^n (n-1)!} t^{n-1} e^{-t/\mu}, \quad t \ge 0$$

(2) $N(t)$ 服从参数为 $t/\mu$ 的泊松分布，其概率分布为：
$$P \{N ( t )=n \} = \frac{(t/\mu)^n}{n!} e^{-t/\mu}, \quad n=0, 1, 2, \dots$$

### 知识延伸

1.  **泊松过程的等价定义**：本题实际上验证了泊松过程的一个核心性质——如果更新过程的到达间隔服从指数分布，则该过程是泊松过程。
2.  **分布关系**：
    *   **指数分布**：描述单个事件发生的等待时间（无记忆性）。
    *   **伽玛分布 (Erlang)**：描述第 $n$ 个事件发生的等待时间（指数分布的和）。
    *   **泊松分布**：描述固定时间段内事件发生的次数。
3.  **重要公式**：
    *   $N(t) \ge n \iff S_n \le t$。这是连接计数过程（离散状态，连续时间）与到达时间序列（连续状态，离散索引）的桥梁。
4.  **易错点**：在处理此类问题时，必须注意参数 $\lambda$（速率）与 $\mu$（均值）的关系。对于指数分布，$\mu = 1/\lambda$。题目给出均值 $\mu$ 时，公式中的指数项应为 $e^{-t/\mu}$ 而非 $e^{-\mu t}$。

---
