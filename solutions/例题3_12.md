# 例题3.12

## 题目

假设[P] 是一个有限状态马尔可夫链的转移矩阵，状态i 是一个常返态。证明如果Pii > 0，则 状态 i 是非周期的。

## 解答

**Defining the Proof**

I am now focused on defining the period and return times formally. Subsequently, the proof will leverage the condition $P_{ii} > 0$, deducing that the greatest common divisor of the return times set is 1. The implication of this is aperiodic, based on the definition. After that, I'm thinking about extending the knowledge with some theorems about periodicity.


### 题目分析
本题考查离散时间马尔可夫链（Markov Chain）中状态分类的核心概念，具体涉及状态的**周期性（Periodicity）**。题目给出了转移矩阵 $P$ 和一个常返状态 $i$，关键条件是该状态的一步转移概率 $P_{ii} > 0$（即存在自环）。我们需要利用周期的定义，证明该状态是非周期的（Aperiodic）。

### 解题过程

**1. 定义回顾**

首先回顾马尔可夫链中状态 $i$ 的周期 $d(i)$ 的定义。周期 $d(i)$ 是所有使得 $n$ 步转移概率 $P_{ii}^{(n)} > 0$ 的正整数 $n$ 的最大公约数。

数学表达式为：
$$d(i) = \gcd\{n \ge 1 : P_{ii}^{(n)} > 0\}$$
其中：
- $P_{ii}^{(n)}$ 表示从状态 $i$ 出发，经过 $n$ 步后首次或再次回到状态 $i$ 的概率（此处指 $n$ 步转移概率）。
- $\gcd$ 表示最大公约数（Greatest Common Divisor）。
- 如果 $d(i) = 1$，则称状态 $i$ 是**非周期的（aperiodic）**。

**2. 分析已知条件**

题目给定条件为 $P_{ii} > 0$。
在马尔可夫链的记号中，$P_{ii}$ 等价于 $P_{ii}^{(1)}$，即从状态 $i$ 出发，经过 $1$ 步回到状态 $i$ 的概率。

**3. 推导过程**

令集合 $I_i$ 为状态 $i$ 所有可能的返回时间步长的集合：
$$I_i = \{n \ge 1 : P_{ii}^{(n)} > 0\}$$

根据已知条件 $P_{ii} > 0$，即 $P_{ii}^{(1)} > 0$，我们可以得出：
$$1 \in I_i$$

这意味着集合 $I_i$ 中包含整数 $1$。

**4. 计算最大公约数**

根据周期的定义，我们需要计算集合 $I_i$ 中所有元素的的最大公约数：
$$d(i) = \gcd(I_i)$$

由于 $1 \in I_i$，且任何包含 $1$ 的正整数集合的最大公约数必然是 $1$（因为 $1$ 只能被 $1$ 整除），因此：
$$d(i) = 1$$

**5. 结论**

因为状态 $i$ 的周期 $d(i) = 1$，根据非周期性的定义，状态 $i$ 是非周期的。

### 答案
$$d(i) = \gcd\{n \ge 1 : P_{ii}^{(n)} > 0\} = \gcd(\{1, \dots\}) = 1 \implies \text{状态 } i \text{ 是非周期的}$$

### 知识延伸

1.  **类性质（Class Property）**：
    周期性是一个类性质。如果状态 $i$ 和状态 $j$ 互通（即 $i \leftrightarrow j$），则它们具有相同的周期，即 $d(i) = d(j)$。因此，如果一个不可约马尔可夫链中有一个状态满足 $P_{ii} > 0$，则整个链的所有状态都是非周期的。

2.  **常返性与周期性的关系**：
    题目中提到“状态 $i$ 是常返态”，这保证了过程会无限次回到状态 $i$。虽然周期性的定义不依赖于常返性（瞬态也可以定义周期），但在研究极限分布 $\lim_{n \to \infty} P_{ij}^{(n)}$ 时，非周期性是至关重要的条件。
    - 对于**非周期、正常返**（遍历）的马尔可夫链，极限分布存在且独立于初始状态。
    - 对于**周期性**马尔可夫链（周期 $d > 1$），$P_{ii}^{(n)}$ 不会收敛到一个固定的常数，而是随 $n$ 的变化呈现周期性波动。

3.  **常见判定技巧**：
    - 只要观察到状态转移图中存在一个**自环**（Self-loop，即 $P_{ii} > 0$），该状态及其所在的互通类必定是非周期的。
    - 如果能找到两个互质的步长 $n_1, n_2$ 使得 $P_{ii}^{(n_1)} > 0$ 且 $P_{ii}^{(n_2)} > 0$，则 $\gcd(n_1, n_2) = 1$，该状态也是非周期的。

4.  **重要公式**：
    若状态 $i$ 是非周期的，则存在一个整数 $N$，使得对于所有 $n \ge N$，都有 $P_{ii}^{(n)} > 0$。这是数论中 Frobenius Coin Problem 的一个推论。

---
