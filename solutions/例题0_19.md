# 例题0.19

## 题目

甲乙两人网聊。甲向乙随机发送一个数字 X ∈ {0，1，2}，概率依次为 1 2 ，1 4 ，1 4 。乙收到数 字 Y ∈ {0，1，2}。但传输过程中有可能出错。设错误模型是 Y = X + Z mod 3，其中 Z ∈ {0，1，2} 的分布 律是 7 8 ， 1 16 ， 1 16 。讨论乙如何根据接收的 Y 推断发送的X，并给出具体的准则。

## 解答

**Outlining the Solution**

\n\n

I've constructed a basic outline: problem analysis, a step-by-step solution using Bayes' theorem, the final answer in a concise format, and a section for extended knowledge. I'm focusing on the critical probabilities and how the modulo arithmetic plays a role.  The calculations seem sound at this stage.


### 题目分析

本题描述了一个离散信道通信模型，其中输入信号 $X$ 和噪声 $Z$ 相互独立，输出信号 $Y$ 由 $X$ 和 $Z$ 模 3 加法生成。题目给出了 $X$ 的先验分布和 $Z$ 的分布律。考查的核心概念是**贝叶斯推断（Bayesian Inference）**和**最大后验概率估计（Maximum A Posteriori estimation, MAP）**。求解的目标是找到一个决策规则（或准则），使得乙在观测到 $Y$ 的具体取值后，推断出的 $\hat{X}$ 犯错的概率最小，即最大化后验概率 $P(X=x|Y=y)$。

### 解题过程

乙根据接收到的 $Y$ 推断 $X$，最佳准则是选择使得后验概率 $P(X=x|Y=y)$ 最大的那个 $x$ 值。这就是最大后验概率（MAP）准则。

根据贝叶斯公式，后验概率为：
$$P(X=x | Y=y) = \frac{P(Y=y | X=x) P(X=x)}{P(Y=y)}$$

对于给定的观测值 $y$，分母 $P(Y=y)$ 是一个常数（归一化因子），不依赖于 $x$。因此，最大化后验概率等价于最大化分子，即联合概率：
$$\hat{x}_{MAP}(y) = \arg\max_{x \in \{0,1,2\}} P(Y=y | X=x) P(X=x)$$

已知信道模型为 $Y = (X + Z) \pmod 3$，这意味着 $Z = (Y - X) \pmod 3$。由于 $X$ 和 $Z$ 独立，条件概率（似然函数）为：
$$P(Y=y | X=x) = P(Z = (y-x) \pmod 3)$$

已知先验概率 $P(X)$ 分布为：
$$P(X=0)=\frac{1}{2}, \quad P(X=1)=\frac{1}{4}, \quad P(X=2)=\frac{1}{4}$$

已知噪声 $Z$ 分布为：
$$P(Z=0)=\frac{7}{8}, \quad P(Z=1)=\frac{1}{16}, \quad P(Z=2)=\frac{1}{16}$$

下面针对乙收到的每一个可能的 $Y$ 值（0, 1, 2），分别计算不同 $X$ 对应的联合概率 $S(x, y) = P(Y=y | X=x) P(X=x)$ 并进行比较。

**情形 1：乙收到 $Y=0$**

*   假设 $X=0$：需要 $Z = (0-0) \pmod 3 = 0$。
    $$S(0, 0) = P(Z=0)P(X=0) = \frac{7}{8} \times \frac{1}{2} = \frac{7}{16}$$
*   假设 $X=1$：需要 $Z = (0-1) \pmod 3 = 2$。
    $$S(1, 0) = P(Z=2)P(X=1) = \frac{1}{16} \times \frac{1}{4} = \frac{1}{64}$$
*   假设 $X=2$：需要 $Z = (0-2) \pmod 3 = 1$。
    $$S(2, 0) = P(Z=1)P(X=2) = \frac{1}{16} \times \frac{1}{4} = \frac{1}{64}$$

比较可知：$\frac{7}{16} > \frac{1}{64}$。因此，当 $Y=0$ 时，推断 $\hat{X}=0$。

**情形 2：乙收到 $Y=1$**

*   假设 $X=0$：需要 $Z = (1-0) \pmod 3 = 1$。
    $$S(0, 1) = P(Z=1)P(X=0) = \frac{1}{16} \times \frac{1}{2} = \frac{1}{32}$$
*   假设 $X=1$：需要 $Z = (1-1) \pmod 3 = 0$。
    $$S(1, 1) = P(Z=0)P(X=1) = \frac{7}{8} \times \frac{1}{4} = \frac{7}{32}$$
*   假设 $X=2$：需要 $Z = (1-2) \pmod 3 = 2$。
    $$S(2, 1) = P(Z=2)P(X=2) = \frac{1}{16} \times \frac{1}{4} = \frac{1}{64}$$

比较可知：$\frac{7}{32} > \frac{1}{32} > \frac{1}{64}$。因此，当 $Y=1$ 时，推断 $\hat{X}=1$。

**情形 3：乙收到 $Y=2$**

*   假设 $X=0$：需要 $Z = (2-0) \pmod 3 = 2$。
    $$S(0, 2) = P(Z=2)P(X=0) = \frac{1}{16} \times \frac{1}{2} = \frac{1}{32}$$
*   假设 $X=1$：需要 $Z = (2-1) \pmod 3 = 1$。
    $$S(1, 2) = P(Z=1)P(X=1) = \frac{1}{16} \times \frac{1}{4} = \frac{1}{64}$$
*   假设 $X=2$：需要 $Z = (2-2) \pmod 3 = 0$。
    $$S(2, 2) = P(Z=0)P(X=2) = \frac{7}{8} \times \frac{1}{4} = \frac{7}{32}$$

比较可知：$\frac{7}{32} > \frac{1}{32} > \frac{1}{64}$。因此，当 $Y=2$ 时，推断 $\hat{X}=2$。

### 答案

乙推断 $X$ 的最佳准则是**最大后验概率准则（MAP）**。具体的判决规则为：
$$
\hat{X} = Y
$$
即：
- 若收到 $Y=0$，推断 $X=0$；
- 若收到 $Y=1$，推断 $X=1$；
- 若收到 $Y=2$，推断 $X=2$。

### 知识延伸

1.  **最大后验概率估计 (MAP) vs 最大似然估计 (ML)**：
    *   **MAP**: $\arg\max_x P(Y|X)P(X)$。考虑了先验概率 $P(X)$，适用于先验分布已知且非均匀的情况。本题中 $P(X)$ 不均匀，必须使用 MAP。
    *   **ML**: $\arg\max_x P(Y|X)$。假设先验概率是均匀的（即所有 $X$ 出现概率相等）。如果本题中 $X$ 是均匀分布，MAP 将退化为 ML。

2.  **贝叶斯公式的核心地位**：
    在通信和检测理论中，贝叶斯公式用于将观测数据（$Y$）反演为信源状态（$X$）的概率分布。
    $$P(H|E) = \frac{P(E|H)P(H)}{P(E)}$$
    其中 $H$ 是假设（Hypothesis，这里是 $X$ 的取值），$E$ 是证据（Evidence，这里是 $Y$ 的观测值）。

3.  **易错点提示**：
    *   **忽略先验概率**：很多学生容易直接比较 $P(Y|X)$（似然度）而忽略 $P(X)$。例如在 $Y=1$ 的情况下，虽然 $X=0$ 产生 $Y=1$ 的概率很小，但如果 $X=0$ 的先验概率极大，结果可能会改变。在本题中，尽管 $P(X=0)$ 较大，但由于噪声 $Z=0$ 的概率占绝对优势（$7/8$），最终结果依然是 $\hat{X}=Y$。
    *   **模运算混淆**：在计算 $Z = Y - X$ 时，要注意负数取模的问题，例如 $0-1 \equiv 2 \pmod 3$。

---
