# 习题3.10

## 题目

甲， $\mathrm{Z}$ ，丙三人玩游戏。试讨论规则的公平性：丙是仲裁，掷一均匀硬币多次。 （1）若第一次出现正面，则甲胜；否则，乙胜。 （2）若前三次出现的是“正正反”，则甲胜；若前三次出现的是“正正正”，则乙胜；其他情形，和。 （3）依次记录掷硬币结果，若“正正反”先出现，则甲胜；若“正正正”先出现则乙胜。 (4）依次记录掷硬币结果，若“正正反”先出现，则甲胜；若“正反反”先出现，则乙胜。

## 解答

**Refining the Approach**

The analysis of the problem is complete. I'm now transitioning to formalizing the solutions, especially for scenarios 3 and 4, employing state diagrams and conditional probability. Further, I am confirming the findings using Conway's algorithm for scenario 4 to validate the probabilities and ensure accuracy. All LaTeX commands are checked.


### 题目分析

本题主要考查**古典概型**、**独立重复试验（伯努利试验）**以及**随机过程中的模式匹配（Pattern Matching）**问题。
1.  第（1）和（2）问属于基础的古典概率计算，通过列举样本空间即可求解。
2.  第（3）和（4）问涉及无穷序列中的“首达时间”或“模式竞争”问题，本质上是**Penney's Game（彭尼游戏）**的变种。解决这类问题通常采用**条件概率法**、**马尔可夫链（Markov Chain）状态分析**或**鞅（Martingale）**的方法。
3.  目标是计算甲、乙获胜的概率，从而判断游戏规则是否公平（即判断获胜概率是否相等）。

---

### 解题过程

设硬币出现正面为 $H$（Head），出现反面为 $T$（Tail）。由于硬币是均匀的，故每次投掷 $P(H) = P(T) = \frac{1}{2}$。

#### （1）规则分析
规则：若第一次出现正面（$H$），则甲胜；否则（$T$），乙胜。

*   甲获胜的事件为第一次投掷结果为 $H$。
    $$P(\text{甲胜}) = P(H) = \frac{1}{2}$$
*   乙获胜的事件为第一次投掷结果为 $T$。
    $$P(\text{乙胜}) = P(T) = \frac{1}{2}$$

**结论**：$P(\text{甲胜}) = P(\text{乙胜})$，规则**公平**。

#### （2）规则分析
规则：只掷三次。若出现“正正反”（$HHT$）甲胜；若出现“正正正”（$HHH$）乙胜；其他情形和局。

三次投掷的样本空间 $\Omega$ 共有 $2^3 = 8$ 种等可能结果：
$$ \Omega = \{HHH, HHT, HTH, HTT, THH, THT, TTH, TTT\} $$

*   甲获胜的事件为 $\{HHT\}$，包含 1 个样本点。
    $$P(\text{甲胜}) = \frac{1}{8}$$
*   乙获胜的事件为 $\{HHH\}$，包含 1 个样本点。
    $$P(\text{乙胜}) = \frac{1}{8}$$
*   和局的概率为 $1 - \frac{1}{8} - \frac{1}{8} = \frac{6}{8} = \frac{3}{4}$。

**结论**：虽然大部分情况是和局，但在分出胜负的情况下，$P(\text{甲胜}) = P(\text{乙胜})$，规则相对**公平**。

#### （3）规则分析
规则：不限次数，若“正正反”（$HHT$）先出现甲胜；若“正正正”（$HHH$）先出现乙胜。

观察甲的目标 $A=HHT$ 和乙的目标 $B=HHH$。
这两个模式的前两位均为 $HH$。
游戏的过程可以看作是等待序列中第一次出现 $HH$。
1.  在 $HH$ 出现之前，任何 $T$ 的出现都会破坏连续的 $H$，使得我们需要重新等待 $H$ 的积累。
2.  一旦序列中出现了 $HH$，胜负将完全取决于**紧接着的下一次**投掷结果：
    *   若下一次是 $H$，则序列变为 $HHH$，乙获胜。
    *   若下一次是 $T$，则序列变为 $HHT$，甲获胜。

由于硬币是均匀的，在已经出现 $HH$ 的条件下，下一次出现 $H$ 或 $T$ 的概率均为 $\frac{1}{2}$。
$$P(\text{甲胜}) = P(T | HH) = \frac{1}{2}$$
$$P(\text{乙胜}) = P(H | HH) = \frac{1}{2}$$

**结论**：$P(\text{甲胜}) = P(\text{乙胜})$，规则**公平**。

#### （4）规则分析
规则：不限次数，若“正正反”（$HHT$）先出现甲胜；若“正反反”（$HTT$）先出现乙胜。

设 $P_A$ 为甲获胜的概率。我们可以利用状态分析法（条件概率）来求解。
设 $E$ 为游戏开始时的状态（或当前未匹配任何前缀的状态）。
设 $P(H)$ 为第一枚掷出 $H$ 后甲获胜的概率。
设 $P(T)$ 为第一枚掷出 $T$ 后甲获胜的概率。

由于两个目标模式 $HHT$ 和 $HTT$ 都以 $H$ 开头，如果一开始掷出 $T$，则相当于游戏重新开始（因为 $T$ 不能作为任何一方模式的开始），即：
$$P(T) = P(E) = P_A$$
因此，我们只需关注第一次出现 $H$ 之后的情况。设 $x$ 为当前序列结尾为 $H$ 时甲获胜的概率。

状态定义：
*   $x$：当前序列后缀为 $H$（等待匹配 $HHT$ 或 $HTT$）。
*   $y$：当前序列后缀为 $HH$。
*   $z$：当前序列后缀为 $HT$。

状态转移方程：
1.  **从状态 $H$ ($x$) 出发**：
    *   掷出 $H$ $\to$ 状态变为 $HH$ ($y$)。
    *   掷出 $T$ $\to$ 状态变为 $HT$ ($z$)。
    $$ x = \frac{1}{2}y + \frac{1}{2}z \quad \cdots\cdots \text{(eq.1)} $$

2.  **从状态 $HH$ ($y$) 出发**：
    *   掷出 $H$ $\to$ 序列变为 $HHH$。对于甲的目标 $HHT$ 和乙的目标 $HTT$，序列后缀仍保持为 $HH$（甚至更长，但对乙无效，对甲依然是等待 $T$）。注意：只要出现 $HH$，乙就无法获胜了。因为乙需要 $HTT$，必须先经历 $HT$。但在 $HH$ 状态下，如果出 $T$，则构成 $HHT$，甲立即获胜；如果出 $H$，保持 $HH...H$，直到出现第一个 $T$，甲获胜。
    *   掷出 $T$ $\to$ 序列变为 $HHT$，甲获胜（概率为 1）。
    *   详细推导：从 $HH$ 出发，若出 $T$，甲赢；若出 $H$，回到 $HH$ 状态（对于胜负判定而言）。
    $$ y = \frac{1}{2}(1) + \frac{1}{2}y \implies \frac{1}{2}y = \frac{1}{2} \implies y = 1 $$
    *(直观解释：一旦出现 $HH$，要变成乙的 $HTT$ 必须先经过 $HT$，但 $HH$ 后遇到 $T$ 会直接先构成甲的 $HHT$。所以一旦到达 $HH$，甲必胜。)*

3.  **从状态 $HT$ ($z$) 出发**：
    *   掷出 $H$ $\to$ 序列变为 $HTH$，后缀为 $H$，回到状态 $x$。
    *   掷出 $T$ $\to$ 序列变为 $HTT$，乙获胜，甲失败（概率为 0）。
    $$ z = \frac{1}{2}x + \frac{1}{2}(0) = \frac{1}{2}x \quad \cdots\cdots \text{(eq.2)} $$

求解方程组：
已知 $y=1$，代入 (eq.1)：
$$ x = \frac{1}{2}(1) + \frac{1}{2}z $$
将 (eq.2) 代入上式：
$$ x = \frac{1}{2} + \frac{1}{2}(\frac{1}{2}x) = \frac{1}{2} + \frac{1}{4}x $$
$$ \frac{3}{4}x = \frac{1}{2} \implies x = \frac{2}{3} $$

因为游戏开始时，必须先等到第一个 $H$ 出现才进入状态 $x$，而之前的 $T$ 不改变胜负概率，所以甲获胜的总概率 $P_A = x$。

$$ P(\text{甲胜}) = \frac{2}{3}, \quad P(\text{乙胜}) = 1 - \frac{2}{3} = \frac{1}{3} $$

**结论**：$P(\text{甲胜}) > P(\text{乙胜})$，规则**不公平**，甲更有利。

---

### 答案

1.  **公平**。$P(\text{甲}) = P(\text{乙}) = 1/2$。
2.  **公平**。$P(\text{甲}) = P(\text{乙}) = 1/8$（其余为和局）。
3.  **公平**。$P(\text{甲}) = P(\text{乙}) = 1/2$。
4.  **不公平**。$P(\text{甲}) = 2/3$，$P(\text{乙}) = 1/3$，甲有利。

---

### 知识延伸

1.  **Penney's Game（彭尼游戏）**：
    第（4）问是典型的彭尼游戏非传递性现象。对于任意一个长度为 $k \ge 3$ 的模式 $B$，总存在另一个模式 $A$，使得 $A$ 先于 $B$ 出现的概率大于 $1/2$。例如本题中 $HHT$ 克制 $HTT$。

2.  **Conway's Algorithm（康威算法）**：
    快速计算模式 $A$ 战胜模式 $B$ 概率的公式。
    设 $A \cdot B$ 为两个二进制模式的重叠值（Overlap Value）。若 $A$ 的后缀与 $B$ 的前缀匹配长度为 $k$，则贡献 $2^{k-1}$（或根据定义 $2^{L-k}$）。
    公式为：
    $$ \frac{P(A)}{P(B)} = \frac{B \cdot B - B \cdot A}{A \cdot A - A \cdot B} $$
    在本题（4）中，$A=HHT, B=HTT$（设 $H=1, T=0$）：
    *   $A \cdot A$ (HHT vs HHT): 匹配长度 3 ($2^2=4$)，长度 1, 2 不匹配。$\to 4$
    *   $A \cdot B$ (HHT vs HTT): 匹配长度 2 (HT vs HT, $2^1=2$)。$\to 2$
    *   $B \cdot B$ (HTT vs HTT): 匹配长度 3 ($2^2=4$)。$\to 4$
    *   $B \cdot A$ (HTT vs HHT): 无匹配。$\to 0$
    $$ \frac{P(A)}{P(B)} = \frac{4 - 0}{4 - 2} = \frac{4}{2} = 2 \implies P(A) = \frac{2}{3} $$

3.  **解题技巧**：
    *   对于有限步数（如第2问），直接列举样本空间。
    *   对于无限步数模式匹配，寻找**关键公共前缀**（如第3问的 $HH$）或建立**状态转移方程**（如第4问）。
    *   注意“前缀重置”的情况：如果掷出的币使得当前序列无法构成任何一方的前缀，则相当于游戏重启。

---
