# 习题3.6

## 题目

在瓮中总含有两个球。球的颜色有红色与蓝色。每个时期随机地取出一个球，并且放回一个新球，新球的颜色以 0.8 的概率与取的球同色，而以 0.2 的概率为相反的颜色。如果开始时两个球都是红色，求第五次取到的球是红色的概率。

## 解答

### 题目分析

这是一个马尔可夫链问题。状态空间为瓮中红球的个数：0个、1个或2个红球。每次操作后，红球数量的转移概率取决于当前状态和取球规则。初始状态为2个红球，需要求第5次取到红球的概率，这等价于求第5步时瓮中各状态的概率分布，再结合从各状态取到红球的条件概率。

### 解题过程

**第一步：定义状态空间**

设 $X_n$ 表示第 $n$ 次操作后瓮中红球的个数，状态空间为 $S = \{0, 1, 2\}$。

**第二步：确定转移概率矩阵**

从状态 $i$ 分析转移概率：

- **状态0（0个红球，2个蓝球）**：
  - 取出蓝球（概率1），以0.8概率放回蓝球→状态0；以0.2概率放回红球→状态1
  - $P_{00} = 0.8, P_{01} = 0.2, P_{02} = 0$

- **状态1（1个红球，1个蓝球）**：
  - 取出红球（概率0.5），以0.8概率放回红球→状态1；以0.2概率放回蓝球→状态0
  - 取出蓝球（概率0.5），以0.8概率放回蓝球→状态1；以0.2概率放回红球→状态2
  - $P_{10} = 0.5 \times 0.2 = 0.1, P_{11} = 0.5 \times 0.8 + 0.5 \times 0.8 = 0.8, P_{12} = 0.5 \times 0.2 = 0.1$

- **状态2（2个红球，0个蓝球）**：
  - 取出红球（概率1），以0.8概率放回红球→状态2；以0.2概率放回蓝球→状态1
  - $P_{20} = 0, P_{21} = 0.2, P_{22} = 0.8$

转移概率矩阵为：
$$P = \begin{pmatrix} 0.8 & 0.2 & 0 \\ 0.1 & 0.8 & 0.1 \\ 0 & 0.2 & 0.8 \end{pmatrix}$$

**第三步：计算4步转移概率**

初始分布 $\pi^{(0)} = (0, 0, 1)$（2个红球）

需要计算 $\pi^{(4)} = \pi^{(0)} P^4$

逐步计算：
$$\pi^{(1)} = (0, 0, 1) \begin{pmatrix} 0.8 & 0.2 & 0 \\ 0.1 & 0.8 & 0.1 \\ 0 & 0.2 & 0.8 \end{pmatrix} = (0, 0.2, 0.8)$$

$$\pi^{(2)} = (0, 0.2, 0.8) P = (0.02, 0.32, 0.66)$$

$$\pi^{(3)} = (0.032, 0.392, 0.576)$$

$$\pi^{(4)} = (0.0648, 0.4168, 0.5184)$$

**第四步：计算第5次取到红球的概率**

第5次取球时，从状态 $i$ 取到红球的概率为 $\frac{i}{2}$：
- 状态0：概率为0
- 状态1：概率为0.5
- 状态2：概率为1

因此，第5次取到红球的概率为：
$$P(\text{第5次取红球}) = 0.0648 \times 0 + 0.4168 \times 0.5 + 0.5184 \times 1$$
$$= 0 + 0.2084 + 0.5184 = 0.7268$$

### 答案

第五次取到的球是红色的概率为 $\boxed{0.7268}$ 或 $\boxed{\frac{1817}{2500}}$

### 知识延伸

**核心定理**：Chapman-Kolmogorov方程，$n$ 步转移概率满足 $P^{(n)} = P^n$

**重要性质**：
1. 此马尔可夫链具有对称性，状态0和状态2关于状态1对称
2. 平稳分布为 $\pi = (\frac{1}{4}, \frac{1}{2}, \frac{1}{4})$，可通过 $\pi P = \pi$ 验证
3. 该链是非周期、不可约且遍历的

**解题技巧**：
- 区分"第n步后的状态"与"第n次取球"的概率计算
- 使用全概率公式：$P(A) = \sum_i P(X_n=i)P(A|X_n=i)$

**易错点**：混淆第4步后的状态分布与第5次取球的概率，需要额外考虑从各状态取到红球的条件概率

---
