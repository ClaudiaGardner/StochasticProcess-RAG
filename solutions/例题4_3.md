# 例题4.3

## 题目

考虑掷一个硬币的 Bernoulli 试验，其中正面朝上（称之为成功）的概率是 p。定义随机变量 X: 如果正面朝上，X = 1 ；如果反面朝上，X = 0 。则我们可以考虑如下分布的概率质量函数、均值、方差、矩 生成函数等 • Bernoulli 分布（一次试验成功的次数） • 二项分布（n 次试验中成功的次数） • 几何分布（首次成功需要的次数；成功后再次成功所需要的次数） • Pascal 分布, 又名负二项分布（第r 次成功所需要的次数）

## 解答

**Refining Distribution Definitions**

I'm now clarifying the definitions, particularly for the Geometric distribution. I've reconfirmed that "trials until first success" applies, making the support start from 1. Furthermore, I'm streamlining the calculations for the Pascal/Negative Binomial distribution by recognizing it as a sum of independent Geometric distributions. Also, I'm making sure my LaTeX formatting is perfect before presenting the information.


### 题目分析

本题以 Bernoulli 试验为基础，考察了四种最基本的离散型概率分布：Bernoulli 分布、二项分布、几何分布和 Pascal 分布（负二项分布）。这四种分布构成了离散随机过程的基础。
题目要求针对每种分布求解四个核心统计量：
1.  **概率质量函数 (PMF)**：描述随机变量取特定值的概率。
2.  **均值 (Mean/Expectation)**：随机变量的期望值。
3.  **方差 (Variance)**：随机变量偏离均值的程度。
4.  **矩生成函数 (MGF)**：$M(t) = E[e^{tX}]$，用于生成各阶矩及确定分布特性。

本题的核心在于理解各分布之间的逻辑关系：二项分布是 $n$ 个独立 Bernoulli 试验之和；几何分布是等待第 1 次成功所需的试验次数；Pascal 分布是等待第 $r$ 次成功所需的试验次数（即 $r$ 个独立几何分布之和）。

---

### 解题过程

令 $p$ 为单次试验成功的概率，$q = 1-p$ 为失败的概率。

#### 1. Bernoulli 分布 (Bernoulli Distribution)
定义随机变量 $X$ 为一次试验的结果，成功记为 1，失败记为 0。

*   **概率质量函数 (PMF)**:
    $$P(X=k) = p^k (1-p)^{1-k}, \quad k \in \{0, 1\}$$
    即 $P(X=1)=p, P(X=0)=q$。

*   **矩生成函数 (MGF)**:
    $$M_X(t) = E[e^{tX}] = e^{t \cdot 0} \cdot q + e^{t \cdot 1} \cdot p = q + pe^t$$

*   **均值**:
    $$E[X] = M_X'(0) = (pe^t)|_{t=0} = p$$
    或者直接计算：$0\cdot q + 1\cdot p = p$。

*   **方差**:
    $$E[X^2] = 0^2\cdot q + 1^2\cdot p = p$$
    $$\text{Var}(X) = E[X^2] - (E[X])^2 = p - p^2 = p(1-p) = pq$$

#### 2. 二项分布 (Binomial Distribution)
定义随机变量 $Y$ 为 $n$ 次独立 Bernoulli 试验中成功的次数。即 $Y = \sum_{i=1}^n X_i$，其中 $X_i \sim \text{Bernoulli}(p)$ 且相互独立。

*   **概率质量函数 (PMF)**:
    $$P(Y=k) = \binom{n}{k} p^k q^{n-k}, \quad k = 0, 1, \dots, n$$

*   **矩生成函数 (MGF)**:
    利用独立性，$Y$ 的 MGF 是 $X$ 的 MGF 的 $n$ 次方：
    $$M_Y(t) = E[e^{t \sum X_i}] = \prod_{i=1}^n E[e^{tX_i}] = (q + pe^t)^n$$

*   **均值**:
    $$E[Y] = \frac{d}{dt}(q + pe^t)^n \Big|_{t=0} = n(q + pe^t)^{n-1} (pe^t) \Big|_{t=0} = n(1)^{n-1}p = np$$

*   **方差**:
    二阶导数：
    $$M_Y''(t) = n(n-1)(q+pe^t)^{n-2}(pe^t)^2 + n(q+pe^t)^{n-1}(pe^t)$$
    令 $t=0$：
    $$E[Y^2] = M_Y''(0) = n(n-1)p^2 + np$$
    $$\text{Var}(Y) = E[Y^2] - (E[Y])^2 = (n^2p^2 - np^2 + np) - n^2p^2 = np - np^2 = np(1-p) = npq$$

#### 3. 几何分布 (Geometric Distribution)
定义随机变量 $Z$ 为首次成功所需要的试验次数（包含第 1 次成功的那次试验）。$Z$ 的取值范围为 $\{1, 2, \dots\}$。

*   **概率质量函数 (PMF)**:
    前 $k-1$ 次失败，第 $k$ 次成功：
    $$P(Z=k) = (1-p)^{k-1}p = q^{k-1}p, \quad k = 1, 2, \dots$$

*   **矩生成函数 (MGF)**:
    $$M_Z(t) = \sum_{k=1}^{\infty} e^{tk} q^{k-1} p = \frac{p}{q} \sum_{k=1}^{\infty} (qe^t)^k$$
    当 $|qe^t| < 1$ 时，这是一个无穷等比数列求和：
    $$M_Z(t) = \frac{p}{q} \cdot \frac{qe^t}{1-qe^t} = \frac{pe^t}{1-qe^t}$$

*   **均值**:
    $$M_Z'(t) = \frac{p e^t (1-qe^t) - pe^t (-qe^t)}{(1-qe^t)^2} = \frac{pe^t}{(1-qe^t)^2}$$
    $$E[Z] = M_Z'(0) = \frac{p}{(1-q)^2} = \frac{p}{p^2} = \frac{1}{p}$$

*   **方差**:
    求二阶导数并代入 $t=0$（计算过程略繁，直接给出结果）：
    $$E[Z^2] = M_Z''(0) = \frac{2-p}{p^2}$$
    $$\text{Var}(Z) = E[Z^2] - (E[Z])^2 = \frac{2-p}{p^2} - \frac{1}{p^2} = \frac{1-p}{p^2} = \frac{q}{p^2}$$

#### 4. Pascal 分布 / 负二项分布 (Negative Binomial Distribution)
定义随机变量 $W$ 为第 $r$ 次成功所需要的试验次数。可以看作是 $r$ 个独立的几何分布变量之和：$W = Z_1 + Z_2 + \dots + Z_r$，其中 $Z_i \sim \text{Geometric}(p)$。

*   **概率质量函数 (PMF)**:
    在第 $k$ 次试验取得第 $r$ 次成功，意味着前 $k-1$ 次中有 $r-1$ 次成功，且第 $k$ 次必须成功：
    $$P(W=k) = \binom{k-1}{r-1} p^{r-1} q^{(k-1)-(r-1)} \cdot p = \binom{k-1}{r-1} p^r q^{k-r}, \quad k = r, r+1, \dots$$

*   **矩生成函数 (MGF)**:
    利用独立性，$W$ 的 MGF 是几何分布 MGF 的 $r$ 次方：
    $$M_W(t) = (M_Z(t))^r = \left( \frac{pe^t}{1-qe^t} \right)^r$$

*   **均值**:
    利用期望的线性性质：
    $$E[W] = E\left[\sum_{i=1}^r Z_i\right] = \sum_{i=1}^r E[Z_i] = r \cdot \frac{1}{p} = \frac{r}{p}$$

*   **方差**:
    利用独立变量和的方差性质：
    $$\text{Var}(W) = \text{Var}\left(\sum_{i=1}^r Z_i\right) = \sum_{i=1}^r \text{Var}(Z_i) = r \cdot \frac{q}{p^2} = \frac{rq}{p^2}$$

---

### 答案

汇总各分布的性质如下（其中 $q=1-p$）：

1.  **Bernoulli 分布 ($X$)**:
    *   PMF: $P(X=k) = p^k q^{1-k}, k \in \{0,1\}$
    *   均值: $p$
    *   方差: $pq$
    *   MGF: $q + pe^t$

2.  **二项分布 ($Y \sim \text{Bin}(n,p)$)**:
    *   PMF: $P(Y=k) = \binom{n}{k} p^k q^{n-k}, k \in \{0, \dots, n\}$
    *   均值: $np$
    *   方差: $npq$
    *   MGF: $(q + pe^t)^n$

3.  **几何分布 ($Z \sim \text{Geo}(p)$)** (定义为首次成功所需次数):
    *   PMF: $P(Z=k) = q^{k-1}p, k \in \{1, 2, \dots\}$
    *   均值: $\frac{1}{p}$
    *   方差: $\frac{q}{p^2}$
    *   MGF: $\frac{pe^t}{1-qe^t}$

4.  **Pascal / 负二项分布 ($W \sim \text{NB}(r,p)$)** (定义为第 $r$ 次成功所需次数):
    *   PMF: $P(W=k) = \binom{k-1}{r-1} p^r q^{k-r}, k \in \{r, r+1, \dots\}$
    *   均值: $\frac{r}{p}$
    *   方差: $\frac{rq}{p^2}$
    *   MGF: $\left( \frac{pe^t}{1-qe^t} \right)^r$

---

### 知识延伸

1.  **分布间的关系**：
    *   **Bernoulli $\to$ 二项分布**：$n$ 次独立 Bernoulli 试验的成功次数之和。
    *   **Bernoulli $\to$ 几何分布**：独立 Bernoulli 试验序列中，直到出现 1 次成功所需的试验次数。
    *   **几何分布 $\to$ Pascal 分布**：$r$ 个独立同分布的几何随机变量之和。

2.  **几何分布的无记忆性 (Memoryless Property)**：
    几何分布是离散分布中唯一具有无记忆性的分布。即 $P(X > m+n | X > m) = P(X > n)$。这对应了题目中提到的“成功后再次成功所需要的次数”，其分布与从头开始等待首次成功的分布完全一致。

3.  **易错点提示**：
    *   **几何分布的定义**：注意区分 $X$ 是“试验次数”（取值 $1, 2, \dots$）还是“失败次数”（取值 $0, 1, \dots$）。本题解采用的是“试验次数”，若定义为失败次数，均值为 $\frac{1-p}{p}$，方差不变。
    *   **负二项分布的参数**：同理，需确认是总试验次数还是总失败次数。本题解采用的是总试验次数。
    *   **MGF 收敛域**：几何分布和 Pascal 分布的 MGF 仅在 $qe^t < 1$ 即 $t < -\ln q$ 时收敛。

---
