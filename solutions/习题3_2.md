# 习题3.2

## 题目

假设 $\mathrm{X}=( X_{n} , \; \; n \geq0 )$ 是马尔可夫链，状态空间为 $\{1 , ~ 2 , ~ 3 \}$ ，4}，转移概率矩阵为 $$ \mathrm{P}=\left( \begin{matrix} {\frac{1} {2}} & {\frac{1} {2}} & {0} & {0} \\ {1} & {0} & {0} & {0} \\ {0} & {\frac{1} {3}} & {\frac{2} {3}} & {0} \\ {\frac{1} {2}} & {0} & {\frac{1} {2}} & {0} \\ \end{matrix} \right) $$ 问：哪些状态是常返的，哪些是瞬时的？并求每个状态的周期。

## 解答

**Reviewing Solution Steps**

I'm now consolidating the steps into a structured solution. I've focused on clearly defining communication relations, identifying closed classes for recurrence/transience determination, and correctly addressing the period calculation, including the special case of state 4. The LaTeX formatting is checked and ready for output.


### 题目分析

本题考查**离散时间马尔可夫链（Discrete-time Markov Chain, DTMC）**的状态分类与性质。
给定状态空间 $S=\{1, 2, 3, 4\}$ 和一步转移概率矩阵 $P$，需要解决两个核心问题：
1.  **状态分类**：判断哪些状态是常返（recurrent）的，哪些是瞬时（transient）的。这需要分析状态之间的相通性（communication）以及是否存在封闭集（closed set）。
2.  **求解周期**：计算每个状态的周期 $d(i)$，即该状态所有可能的返回时间步长的最大公约数。

### 解题过程

#### 1. 分析状态间的相通性与状态空间分解

首先，根据转移概率矩阵 $P$ 画出状态转移关系，或直接观察矩阵中的非零元素：
$$ \mathrm{P}=\left( \begin{matrix} {\frac{1} {2}} & {\frac{1} {2}} & {0} & {0} \\ {1} & {0} & {0} & {0} \\ {0} & {\frac{1} {3}} & {\frac{2} {3}} & {0} \\ {\frac{1} {2}} & {0} & {\frac{1} {2}} & {0} \\ \end{matrix} \right) $$

**观察各状态的转移情况：**
*   **状态 1**：$P_{11} > 0, P_{12} > 0$。状态 1 可以到达自身和状态 2。
*   **状态 2**：$P_{21} > 0$。状态 2 只能到达状态 1。
    *   由此可知：$1 \to 2$ 且 $2 \to 1$，故 $1 \leftrightarrow 2$（互通）。
    *   观察矩阵第 3 列和第 4 列，在第 1、2 行的元素均为 0。这意味着一旦进入集合 $\{1, 2\}$，就无法到达状态 3 或 4。因此，集合 $\{1, 2\}$ 是一个**封闭集（closed set）**。

*   **状态 3**：$P_{32} > 0, P_{33} > 0$。状态 3 可以到达状态 2 和自身。
    *   由于 $3 \to 2$，而 $2$ 无法到达 $3$（因为 $P_{23}=0$ 且 $P_{13}=0$，即从 $\{1,2\}$ 无法回到 3），所以 $3 \to 2$ 但 $2 \nrightarrow 3$。
    *   因此，状态 3 是非封闭的。

*   **状态 4**：$P_{41} > 0, P_{43} > 0$。状态 4 可以到达状态 1 和状态 3。
    *   观察矩阵第 4 列，所有元素均为 0（即 $P_{i4} = 0, \forall i$）。这意味着没有任何状态可以到达状态 4（包括它自己一步也回不来，且出去后也无法通过其他路径回来）。
    *   因此，状态 4 也是非封闭的。

**状态空间的分解：**
根据互通关系，状态空间 $S$ 可以分解为以下几个互通类（Communicating Classes）：
1.  $C_1 = \{1, 2\}$
2.  $C_2 = \{3\}$
3.  $C_3 = \{4\}$

#### 2. 判断常返性与瞬时性

根据马尔可夫链的性质：
*   在有限状态马尔可夫链中，**封闭的互通类是常返的（且为正常返）**。
*   **非封闭的互通类是瞬时的**。

具体分析如下：
*   **集合 $\{1, 2\}$**：这是一个封闭的互通类。一旦进入该集合，系统将永远停留在该集合内。由于状态空间有限，故状态 1 和 2 是**常返状态**。
*   **状态 3**：从状态 3 出发，有概率 $P_{32}=1/3$ 进入状态 2。一旦进入状态 2（属于封闭集 $\{1, 2\}$），就再也无法返回状态 3。存在不返回的路径，故状态 3 是**瞬时状态**。
*   **状态 4**：从状态 4 出发，必然进入状态 1 或 3。由于矩阵第 4 列全为 0，系统一旦离开状态 4 就永远无法返回。故状态 4 是**瞬时状态**。

#### 3. 求解每个状态的周期

状态 $i$ 的周期定义为 $d(i) = \mathrm{GCD}\{n \geq 1 : P_{ii}^{(n)} > 0\}$（最大公约数）。

*   **状态 1**：
    观察 $P_{11} = \frac{1}{2} > 0$。
    集合 $\{n : P_{11}^{(n)} > 0\}$ 包含 1。
    因此，$d(1) = \mathrm{GCD}\{1, \dots\} = 1$。

*   **状态 2**：
    周期是互通类的属性，互通的状态具有相同的周期。
    因为 $1 \leftrightarrow 2$，所以 $d(2) = d(1) = 1$。
    （验证：$2 \to 1 \to 2$ 步长为 2，$2 \to 1 \to 1 \to 2$ 步长为 3，GCD(2,3)=1）。

*   **状态 3**：
    观察 $P_{33} = \frac{2}{3} > 0$。
    集合 $\{n : P_{33}^{(n)} > 0\}$ 包含 1。
    因此，$d(3) = 1$。

*   **状态 4**：
    观察矩阵第 4 列全为 0，即对于任意 $n \geq 1$，都有 $P_{44}^{(n)} = 0$。
    集合 $\{n \geq 1 : P_{44}^{(n)} > 0\}$ 是空集 $\emptyset$。
    在数学定义上，如果不可能返回，通常认为周期未定义。但在某些教材中，若需强行分类，非周期的概念不适用于永远无法返回的状态。此处严谨回答为**未定义**（或不存在）。

### 答案

1.  **常返状态**：$\{1, 2\}$
2.  **瞬时状态**：$\{3, 4\}$
3.  **各状态的周期**：
    $$ d(1) = 1 $$
    $$ d(2) = 1 $$
    $$ d(3) = 1 $$
    $$ d(4) \text{ 未定义（集合为空）} $$

### 知识延伸

1.  **常返与瞬时的判定定理**：
    *   对于有限状态马尔可夫链，状态空间 $S$ 可以唯一分解为 $S = T \cup R_1 \cup R_2 \cup \dots$，其中 $T$ 是瞬时态集合，$R_k$ 是封闭的常返互通类。
    *   若 $i \to j$ 且 $j \nrightarrow i$，则 $i$ 必为瞬时状态。

2.  **周期的性质**：
    *   **类性质**：若 $i \leftrightarrow j$，则 $d(i) = d(j)$。
    *   若状态 $i$ 有自环（即 $P_{ii} > 0$），则该状态及其所在的互通类必定是**非周期的**（即周期 $d=1$）。

3.  **易错点提示**：
    *   不要混淆“瞬时”与“周期”。瞬时状态也可以有周期（只要它能返回自身，例如 $3 \to 3$）。只有当完全无法返回自身时（如本题的状态 4），周期才无定义。
    *   判断封闭集时，要检查该集合是否能到达集合外部的任何状态。只要有一条路径通向外部，该集合就不是封闭的。

---
