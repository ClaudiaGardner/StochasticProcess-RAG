# 例题2.21

## 题目

甲乙丙丁玩游戏。掷一对均匀的骰子，其点数和记为 X，设所掷次数服从平均每小时 6 次的 泊松分布。一次游戏中 X mod 4 = 1 , 2, 3, 0 时，分别对应甲、乙、丙、丁胜。 (1) 计算两小时内，甲胜的次数； (2) 计算甲、丙在两个小时内共胜的次数； (3) 若两小时内做了 12 次的游戏，甲胜次数； (4) 若第一小时内甲胜了三次，问两小时内共玩了多少次的游戏。

## 解答

**Refining the Solution**

The probabilistic analysis is complete. The next task is formulating a concise and effective response that addresses all the questions. The answers for questions 1 and 2 are ready, and I am finalizing the language to present the distribution and the expected value. The Binomial distribution for question 3 is correctly derived. Currently, working on a clean and detailed answer to question 4.


### 题目分析

本题考查的核心概念是**泊松过程（Poisson Process）**及其性质，特别是**泊松过程的分解（Thinning/Decomposition）**与**合成（Superposition）**，以及条件概率分布。

1.  **随机变量识别**：
    *   $X$ 为掷一对均匀骰子的点数和，取值范围为 $2$ 到 $12$。
    *   $N(t)$ 为时间 $t$ 内进行的游戏总次数，服从参数 $\lambda = 6$ 的泊松过程。
2.  **事件分类**：
    *   根据 $X \pmod 4$ 的结果，将总的泊松过程分解为四个独立的泊松过程，分别对应甲、乙、丙、丁胜。
3.  **求解目标**：
    *   (1) 甲胜次数的分布及期望（泊松过程分解）。
    *   (2) 甲或丙胜次数的分布及期望（泊松过程分解与合成）。
    *   (3) 给定总次数下的条件分布（泊松过程的条件性质，转化为二项分布）。
    *   (4) 给定部分观测值下的总次数期望（利用独立增量性和分解后的独立性）。

---

### 解题过程

#### 1. 基础概率计算

首先计算掷一对骰子点数和 $X$ 的概率分布，总样本空间大小为 $6 \times 6 = 36$。
令 $p_A, p_B, p_C, p_D$ 分别表示甲、乙、丙、丁获胜的概率。

*   **甲胜 ($X \equiv 1 \pmod 4$)**：即 $X \in \{5, 9\}$。
    *   $X=5$: $(1,4), (2,3), (3,2), (4,1)$，共 4 种。
    *   $X=9$: $(3,6), (4,5), (5,4), (6,3)$，共 4 种。
    $$p_A = P(\text{甲胜}) = \frac{4+4}{36} = \frac{8}{36} = \frac{2}{9}$$

*   **丙胜 ($X \equiv 3 \pmod 4$)**：即 $X \in \{3, 7, 11\}$。
    *   $X=3$: $(1,2), (2,1)$，共 2 种。
    *   $X=7$: $(1,6), \dots, (6,1)$，共 6 种。
    *   $X=11$: $(5,6), (6,5)$，共 2 种。
    $$p_C = P(\text{丙胜}) = \frac{2+6+2}{36} = \frac{10}{36} = \frac{5}{18}$$

*   **乙胜 ($X \equiv 2 \pmod 4$)**：$X \in \{2, 6, 10\}$。
    $$p_B = \frac{1+5+3}{36} = \frac{9}{36} = \frac{1}{4}$$

*   **丁胜 ($X \equiv 0 \pmod 4$)**：$X \in \{4, 8, 12\}$。
    $$p_D = \frac{3+5+1}{36} = \frac{9}{36} = \frac{1}{4}$$

检验：$p_A + p_B + p_C + p_D = \frac{8}{36} + \frac{9}{36} + \frac{10}{36} + \frac{9}{36} = 1$。

根据泊松过程的**分解定理**，甲、乙、丙、丁获胜的次数分别服从相互独立的泊松过程，速率分别为 $\lambda_A, \lambda_B, \lambda_C, \lambda_D$，其中 $\lambda = 6$。

#### (1) 计算两小时内，甲胜的次数

设 $N_A(t)$ 为时间 $t$ 内甲胜的次数。$N_A(t)$ 服从速率为 $\lambda_A$ 的泊松过程。
$$\lambda_A = \lambda \cdot p_A = 6 \times \frac{2}{9} = \frac{4}{3}$$
时间长度 $t=2$ 小时。
$N_A(2)$ 服从参数为 $\lambda_A \cdot t = \frac{4}{3} \times 2 = \frac{8}{3}$ 的泊松分布。

概率分布律为：
$$P(N_A(2) = k) = \frac{(\frac{8}{3})^k}{k!} e^{-\frac{8}{3}}, \quad k=0,1,2,\dots$$
平均次数（期望）为 $\frac{8}{3}$ 次。

#### (2) 计算甲、丙在两个小时内共胜的次数

设 $N_{AC}(t)$ 为时间 $t$ 内甲或丙胜的次数。这也是一个泊松过程，其速率为 $\lambda_{AC}$。
$$\lambda_{AC} = \lambda \cdot (p_A + p_C) = 6 \times \left(\frac{2}{9} + \frac{5}{18}\right) = 6 \times \left(\frac{4}{18} + \frac{5}{18}\right) = 6 \times \frac{1}{2} = 3$$
时间长度 $t=2$ 小时。
$N_{AC}(2)$ 服从参数为 $\lambda_{AC} \cdot t = 3 \times 2 = 6$ 的泊松分布。

概率分布律为：
$$P(N_{AC}(2) = k) = \frac{6^k}{k!} e^{-6}, \quad k=0,1,2,\dots$$
平均次数（期望）为 $6$ 次。

#### (3) 若两小时内做了 12 次的游戏，甲胜次数

设 $N(t)$ 为总游戏次数，$N_A(t)$ 为甲胜次数。题目求在 $N(2)=12$ 的条件下，$N_A(2)$ 的分布。
根据泊松过程的性质，给定时间段内事件总数 $n$，其中属于某类事件（概率为 $p$）的次数服从二项分布 $B(n, p)$。

这里 $n=12$，成功的概率 $p = p_A = \frac{2}{9}$。
设甲胜次数为 $Y$，则 $Y \sim B(12, \frac{2}{9})$。

概率分布律为：
$$P(Y=k) = \binom{12}{k} \left(\frac{2}{9}\right)^k \left(\frac{7}{9}\right)^{12-k}, \quad k=0, 1, \dots, 12$$

#### (4) 若第一小时内甲胜了三次，问两小时内共玩了多少次的游戏

设 $N(t)$ 为总游戏次数，$N_A(t)$ 为甲胜次数，$N_{\bar{A}}(t)$ 为非甲胜（乙、丙或丁胜）的次数。
已知 $N(t) = N_A(t) + N_{\bar{A}}(t)$。
根据泊松过程分解定理，$N_A(t)$ 与 $N_{\bar{A}}(t)$ 是两个**相互独立**的泊松过程。
非甲胜的速率为：
$$\lambda_{\bar{A}} = \lambda \cdot (1 - p_A) = 6 \times \left(1 - \frac{2}{9}\right) = 6 \times \frac{7}{9} = \frac{14}{3}$$

题目要求计算期望 $E[N(2) \mid N_A(1)=3]$。
利用独立增量性和过程的独立性进行拆分：
$$N(2) = N(1) + [N(2) - N(1)] = N_A(1) + N_{\bar{A}}(1) + [N(2) - N(1)]$$

取条件期望：
$$
\begin{aligned}
E[N(2) \mid N_A(1)=3] &= E[N_A(1) + N_{\bar{A}}(1) + (N(2) - N(1)) \mid N_A(1)=3] \\
&= E[N_A(1) \mid N_A(1)=3] + E[N_{\bar{A}}(1) \mid N_A(1)=3] + E[N(2) - N(1) \mid N_A(1)=3]
\end{aligned}
$$

逐项计算：
1.  $E[N_A(1) \mid N_A(1)=3] = 3$ （已知条件）。
2.  由于 $N_{\bar{A}}(t)$ 与 $N_A(t)$ 独立，故 $E[N_{\bar{A}}(1) \mid N_A(1)=3] = E[N_{\bar{A}}(1)]$。
    $$E[N_{\bar{A}}(1)] = \lambda_{\bar{A}} \cdot 1 = \frac{14}{3}$$
3.  由于泊松过程具有独立增量性，$N(2)-N(1)$ 与 $t=1$ 之前的状态无关。
    $$E[N(2) - N(1)] = \lambda \cdot (2-1) = 6$$

总期望为：
$$E = 3 + \frac{14}{3} + 6 = 9 + \frac{14}{3} = \frac{27+14}{3} = \frac{41}{3}$$

---

### 答案

(1) 甲胜次数服从参数为 $\frac{8}{3}$ 的泊松分布，平均次数为 $\frac{8}{3}$。
(2) 甲、丙共胜次数服从参数为 $6$ 的泊松分布，平均次数为 $6$。
(3) 甲胜次数服从二项分布 $B(12, \frac{2}{9})$，即 $P(\text{甲胜}k\text{次}) = \binom{12}{k} (\frac{2}{9})^k (\frac{7}{9})^{12-k}$。
(4) 两小时内共玩游戏的期望次数为 $\frac{41}{3}$ 次（约 13.67 次）。

---

### 知识延伸

1.  **泊松过程的分解（Thinning）**：
    若 $N(t)$ 是参数为 $\lambda$ 的泊松过程，且每个事件以概率 $p$ 独立地被归为类型 I，以 $1-p$ 归为类型 II，则类型 I 事件数 $N_1(t)$ 和类型 II 事件数 $N_2(t)$ 分别构成参数为 $\lambda p$ 和 $\lambda(1-p)$ 的泊松过程，且**两者相互独立**。
    *   *本题应用*：第(4)问中利用了 $N_A(t)$ 和 $N_{\bar{A}}(t)$ 的独立性。

2.  **泊松过程的条件分布**：
    已知在时间 $t$ 内发生了 $n$ 个事件（$N(t)=n$），则这 $n$ 个事件发生的时刻在 $[0, t]$ 上服从均匀分布。如果是多类事件，某类事件发生的次数服从二项分布 $B(n, p)$。
    *   *本题应用*：第(3)问直接应用此性质。

3.  **易错点提示**：
    *   在第(4)问中，容易错误地认为 $N(1)$ 固定为 $3/p_A$ 或者只计算 $N(2)$ 的无条件期望。必须利用分解后的独立性：已知甲赢了 3 次，并不影响非甲赢的次数的期望（非甲赢的次数仍按原速率期望累加）。
    *   计算骰子点数和概率时，需注意组合数的计算，避免漏算或多算（如 $(1,2)$ 和 $(2,1)$ 是两种情况）。

---
