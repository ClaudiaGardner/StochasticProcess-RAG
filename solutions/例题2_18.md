# 例题2.18

## 题目

已知速率为λ 和µ 的独立泊松过程N1(t) 和N2(t)，求Pr{S1k < S2j} 的概率，其中S1k 是第 一个过程的第k 个到达的时刻，S2j 是第二个过程的第j 个到达的时刻。 这个问题可以通过引入一个组合过程来重新表述：在组合过程的前k + j − 1 次到达中，求至少有k 次到达 被分配给第一个过程的概率。 P{S1k < S2j} = k+j−1X i=k k + j − 1 i  pi(1 − p)k+j−1−i， 其中 p = λ/(λ + µ) 表示将到达分配给第一个过程的概率。

## 解答

**Reviewing Solution Logic**

I'm now revisiting the core logic to solidify the connection between the binomial distribution and the arrival times. I'm focusing on rigorously proving the equivalence between "the $k$-th arrival of process 1 occurs before the $j$-th arrival of process 2" and "in the first $k+j-1$ events of the combined process, there are at least $k$ events from process 1." This involves careful consideration of the event counts and indices.


### 题目分析

本题考查**泊松过程（Poisson Process）**的核心性质，特别是**独立泊松过程的合并（Superposition）**与**分裂（Splitting/Thinning）**性质。
题目给出了两个独立的泊松过程 $N_1(t)$ 和 $N_2(t)$，速率分别为 $\lambda$ 和 $\mu$。
符号 $S_{1k}$ 表示过程 1 的第 $k$ 个事件发生的时刻，$S_{2j}$ 表示过程 2 的第 $j$ 个事件发生的时刻。
求解目标是计算概率 $P(S_{1k} < S_{2j})$，即过程 1 的第 $k$ 个事件发生在过程 2 的第 $j$ 个事件之前的概率。
解题的关键在于将连续时间的到达问题转化为离散时间的**伯努利试验（Bernoulli Trials）**序列问题。

### 解题过程

#### 1. 引入合并过程
考虑两个独立泊松过程的合并过程 $N(t) = N_1(t) + N_2(t)$。根据泊松过程的性质，$N(t)$ 是一个速率为 $\lambda + \mu$ 的泊松过程。

对于合并过程中的每一个到达事件，它来源于过程 1 或过程 2。由于原过程是独立的泊松过程，每一个到达事件属于过程 1 的概率 $p$ 和属于过程 2 的概率 $q$ 分别为：
$$p = \frac{\lambda}{\lambda + \mu}, \quad q = 1 - p = \frac{\mu}{\lambda + \mu}$$
且各个到达事件的来源是相互独立的。这相当于进行一系列独立的伯努利试验。

#### 2. 转化事件关系
我们需要计算 $P(S_{1k} < S_{2j})$。
这意味着在时间轴上，过程 1 累计发生 $k$ 次时，过程 2 累计发生的次数严格小于 $j$ 次。

我们可以只观察合并过程中的**事件序列**，而不必关心具体的到达时刻。
考虑合并过程的前 $n$ 次到达。为了确定 $S_{1k}$ 是否先于 $S_{2j}$ 发生，我们需要考察足够多的事件数量。
根据鸽巢原理（或逻辑推断），只要考察前 $n = k + j - 1$ 次到达即可确定顺序：
- 如果在前 $k + j - 1$ 次到达中，过程 1 的到达次数 $X \ge k$，那么过程 1 的第 $k$ 个事件必然发生在第 $k+j-1$ 个总事件之前或刚好就是第 $k+j-1$ 个事件。此时，过程 2 的到达次数最多为 $(k+j-1) - k = j-1$，即第 $j$ 个事件尚未发生。因此 $S_{1k} < S_{2j}$。
- 反之，如果在前 $k + j - 1$ 次到达中，过程 1 的到达次数 $X < k$，这意味着过程 2 的到达次数至少为 $(k+j-1) - (k-1) = j$。说明过程 2 的第 $j$ 个事件已经发生，而过程 1 的第 $k$ 个事件尚未发生。因此 $S_{2j} < S_{1k}$。

综上所述，事件 $\{S_{1k} < S_{2j}\}$ 等价于：**在合并过程的前 $k+j-1$ 次试验中，属于过程 1 的成功次数至少为 $k$ 次。**

#### 3. 计算概率
令随机变量 $X$ 表示在前 $k+j-1$ 次合并到达中，属于过程 1 的到达次数。
由第一步分析可知，$X$ 服从二项分布：
$$X \sim \text{Binomial}(n, p)$$
其中总试验次数 $n = k + j - 1$，成功概率 $p = \frac{\lambda}{\lambda + \mu}$。

我们需要求的是 $P(X \ge k)$。根据二项分布的概率质量函数，有：
$$P(X \ge k) = \sum_{i=k}^{n} P(X=i) = \sum_{i=k}^{k+j-1} \binom{k+j-1}{i} p^i (1-p)^{k+j-1-i}$$

将 $p$ 和 $1-p$ 代入公式，即得到最终结果。

### 答案

$$P(S_{1k} < S_{2j}) = \sum_{i=k}^{k+j-1} \binom{k+j-1}{i} \left( \frac{\lambda}{\lambda + \mu} \right)^i \left( \frac{\mu}{\lambda + \mu} \right)^{k+j-1-i}$$

### 知识延伸

1.  **帕斯卡分布（负二项分布）联系**：
    该问题本质上也可以看作负二项分布的一个变体。$S_{1k} < S_{2j}$ 对应于“在第 $j$ 次失败出现之前，至少出现了 $k$ 次成功”。这正是点数问题（Problem of Points）的经典模型。

2.  **Beta 分布积分形式**：
    上述二项式求和公式与正则化不完全 Beta 函数（Regularized Incomplete Beta Function）有关。该概率也可以表示为积分形式：
    $$P(S_{1k} < S_{2j}) = \frac{(k+j-1)!}{(k-1)!(j-1)!} \int_0^p x^{k-1}(1-x)^{j-1} dx$$
    这在 $k, j$ 较大时利用积分近似计算非常有用。

3.  **Gamma 分布的关系**：
    由于 $S_{1k} \sim \text{Gamma}(k, \lambda)$ 且 $S_{2j} \sim \text{Gamma}(j, \mu)$，本题实际上是在求两个独立 Gamma 随机变量的大小关系。直接对联合密度函数积分 $\int_0^\infty P(S_{1k} < t) f_{S_{2j}}(t) dt$ 也能得到相同结果，但计算过程远比利用泊松过程的合并性质复杂。

4.  **特例**：
    当 $k=1, j=1$ 时，即比较两个过程首次到达谁先发生。公式退化为 $\sum_{i=1}^{1} \binom{1}{i} p^i (1-p)^{1-i} = p = \frac{\lambda}{\lambda+\mu}$，这与指数分布的性质（两个指数变量最小值的归属概率）完全一致。

---
