# 习题0.3

## 题目

连续地抛掷一枚均匀的硬币。 （1）求抛掷的前四次是下列情况的概率： H, H, H, H. T，H, H, H. (2）求模式T，H，H，H出现在模式H，H，H，H之前的概率。

## 解答

**Refining the Solution**

The core logic is finalized; the probability calculations for both parts are clear, and the elegant structure-based reasoning for Part 2 is solidified. Now, I'm verifying all assumptions to prevent errors in the final response, with a focus on formatting and ensuring it meets all the specified constraints. I'm double-checking the LaTeX syntax for correctness.


### 题目分析

本题主要考查概率论中的**独立重复试验（伯努利试验）**以及**随机过程中的模式匹配（Pattern Matching）**问题。

1.  **第一问**：考查基础的独立事件概率计算。由于硬币是均匀的，每次抛掷结果相互独立且概率相等。
2.  **第二问**：考查两个特定模式（Pattern）出现的先后顺序概率。这是一个经典的“赌徒破产问题”变体或“模式竞争”问题。虽然可以使用马尔可夫链（Markov Chain）或鞅（Martingale）方法求解，但对于本题特定的两个模式，通过分析模式结构之间的包含关系，存在更简便的逻辑推导方法。

需要求解的目标是：
1.  前四次抛掷恰好是特定序列的概率。
2.  模式 $T, H, H, H$ 先于模式 $H, H, H, H$ 出现的概率。

---

### 解题过程

记硬币正面为 $H$（Heads），反面为 $T$（Tails）。
由于硬币是均匀的，单次抛掷中 $P(H) = P(T) = \frac{1}{2}$。

#### (1) 求抛掷的前四次是下列情况的概率

**情况 A：前四次为 $H, H, H, H$**

由于每次抛掷相互独立，该事件的概率为每次抛掷概率的乘积：
$$
P(H, H, H, H) = P(H) \cdot P(H) \cdot P(H) \cdot P(H) = \left(\frac{1}{2}\right)^4 = \frac{1}{16}
$$

**情况 B：前四次为 $T, H, H, H$**

同理，无论具体的正反面组合如何，只要长度为 4 且顺序确定，其概率均为：
$$
P(T, H, H, H) = P(T) \cdot P(H) \cdot P(H) \cdot P(H) = \left(\frac{1}{2}\right)^4 = \frac{1}{16}
$$

#### (2) 求模式 $T, H, H, H$ 出现在模式 $H, H, H, H$ 之前的概率

设模式 $A = \{H, H, H, H\}$，模式 $B = \{T, H, H, H\}$。
我们需要计算事件 $E$：模式 $B$ 在模式 $A$ 之前出现的概率，即 $P(B \text{ before } A)$。

**结构分析法：**

观察两个模式的结构：
- 模式 $A$：$H, H, H, H$
- 模式 $B$：$T, H, H, H$

我们分析模式 $A$ 能够发生的条件。
模式 $A$ ($H, H, H, H$) 只有在以下两种情况下可能出现：
1.  **从第一次抛掷开始**，连续出现 4 个 $H$。
2.  在序列的中间某处出现 $H, H, H, H$。

如果模式 $A$ 不是从第一次抛掷就开始出现（即前 4 次不全为 $H$），那么在 $A$ 出现之前，必然会有至少一次 $T$ 出现（否则就是全 $H$，即情况 1）。
假设在序列中某个位置出现了 $T$，随后要形成模式 $A$ ($H, H, H, H$)，序列必须呈现如下形式：
$$
\dots, T, H, H, H, H, \dots
$$
请注意上述序列中的子序列。在 $H, H, H, H$ 完成之前，子序列 $T, H, H, H$（即模式 $B$）**必然已经完成**。
具体来说，当序列进行到 $\dots, T, H, H, H$ 时，模式 $B$ 已经出现；而要等到下一个 $H$ 出现以完成模式 $A$ 时，$B$ 早已获胜。

**结论推导：**
- 只要序列中出现过 $T$，模式 $B$ 一定会在模式 $A$ 之前出现（或者 $B$ 出现的同时阻断了 $A$ 的首次计数，实际上 $B$ 的完成点比 $A$ 早一个时间步）。
- 唯一让模式 $A$ 先于模式 $B$ 出现的情况，就是序列一开始就是 $H, H, H, H$，中间没有任何 $T$ 的干扰。

因此，模式 $A$ 先于模式 $B$ 出现的概率仅等于序列前四次恰好为 $H, H, H, H$ 的概率：
$$
P(A \text{ before } B) = P(\text{Start with } HHHH) = \left(\frac{1}{2}\right)^4 = \frac{1}{16}
$$

由于在无限次抛掷中，模式 $A$ 或模式 $B$ 必然有一个会发生（概率为 1），所以模式 $B$ 先于模式 $A$ 出现的概率为：
$$
P(B \text{ before } A) = 1 - P(A \text{ before } B)
$$
$$
P(B \text{ before } A) = 1 - \frac{1}{16} = \frac{15}{16}
$$

---

### 答案

(1) 前四次是 $H, H, H, H$ 的概率为 $\frac{1}{16}$；前四次是 $T, H, H, H$ 的概率为 $\frac{1}{16}$。

(2) 模式 $T, H, H, H$ 出现在模式 $H, H, H, H$ 之前的概率为 $\frac{15}{16}$。

---

### 知识延伸

1.  **康威算法 (Conway's Algorithm)**：
    对于一般的模式 $A$ 和 $B$，计算 $B$ 先于 $A$ 出现的概率有一个通用公式（赔率公式）：
    $$
    \frac{P(B \text{ wins})}{P(A \text{ wins})} = \frac{A:A - A:B}{B:B - B:A}
    $$
    其中 $X:Y$ 表示模式 $X$ 的后缀与模式 $Y$ 的前缀的重叠值（二进制加权和）。
    在本题中：
    - $A:A = (HHHH):(HHHH) = 2^3+2^2+2^1+2^0 = 1111_2 \to$ (按长度计算) $16+8+4+2 = 30$
    - $B:B = (THHH):(THHH) = 16$
    - $A:B = (HHHH):(THHH) = 0$ (无重叠)
    - $B:A = (THHH):(HHHH) = 8+4+2 = 14$
    代入公式：$\frac{30-0}{16-14} = \frac{30}{2} = 15$。即赔率为 $15:1$，故 $P(B \text{ wins}) = \frac{15}{16}$。

2.  **直觉陷阱**：
    虽然 $HHHH$ 和 $THHH$ 作为特定序列出现的概率相同（都是 $1/16$），但在“竞争”中，$THHH$ 占据极大优势。这是因为 $THHH$ 的前缀 $T$ 保护了它，一旦出现 $T$，要生成 $HHHH$ 必须经过 $THHH$，从而导致 $B$ 获胜。

3.  **相关定理**：
    - **波莱尔-坎泰利引理 (Borel-Cantelli Lemma)**：保证了在无限序列中，任何有限长度的模式以概率 1 出现无穷多次。
    - **停时 (Stopping Time)**：此类问题通常涉及随机过程的停时分析。

---
