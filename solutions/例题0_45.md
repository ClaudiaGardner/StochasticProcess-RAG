# 例题0.45

## 题目

掷均匀硬币10 次，求下面事件的概率： （1）正面朝上的次数 = 反面朝上的次数； （2）正面朝上的次数多于反面朝上的次数； （3）至少有连续 4 次正面朝上。

## 解答

**Analyzing Recursive Solutions**

I am now focusing on the nuances of explaining the recurrence relation used to solve the consecutive heads problem. It is crucial to justify the recurrence clearly, so I've decided to explicitly detail the logic behind it, ensuring the final explanation is rigorous and easy to follow. Specifically, detailing *why* the sequence can only end with T, HT, HHT, or HHHT, so the professor can be assured of the solution's validity.


### 题目分析

本题主要考查**古典概型**、**二项分布**以及**组合数学中的递推关系**。
1.  题目背景为掷均匀硬币 10 次，这是一个典型的 $n$ 重伯努利试验（Bernoulli trials），样本空间的总容量为 $2^{10}$。
2.  第一问考查二项分布中特定点概率的计算。
3.  第二问利用二项分布的对称性进行简化计算。
4.  第三问涉及“连续出现”即“游程”（Run）的问题，直接枚举较为繁琐，核心考点在于利用**补集思想**结合**线性递推数列**求解。

### 解题过程

设掷硬币的总次数为 $n=10$。由于硬币是均匀的，每次掷硬币正面（记为 H）和反面（记为 T）的概率均为 $0.5$。样本空间 $\Omega$ 的总元素个数为：
$$|\Omega| = 2^{10} = 1024$$

#### （1）求正面朝上的次数等于反面朝上的次数的概率

设随机变量 $X$ 表示正面朝上的次数。则 $X$ 服从二项分布 $X \sim B(10, 0.5)$。
正面次数等于反面次数，即 $X = 5$。
根据二项分布概率公式：
$$P(X=k) = \binom{n}{k} p^k (1-p)^{n-k}$$
代入 $n=10, k=5, p=0.5$：
$$P(X=5) = \binom{10}{5} \left(\frac{1}{2}\right)^5 \left(\frac{1}{2}\right)^5 = \binom{10}{5} \left(\frac{1}{2}\right)^{10}$$
计算组合数 $\binom{10}{5}$：
$$\binom{10}{5} = \frac{10 \times 9 \times 8 \times 7 \times 6}{5 \times 4 \times 3 \times 2 \times 1} = 2 \times 3 \times 2 \times 7 \times 3 = 252$$
所以：
$$P(X=5) = \frac{252}{1024} = \frac{63}{256}$$

#### （2）求正面朝上的次数多于反面朝上的次数的概率

我们需要求 $P(X > 5)$。
利用二项分布的对称性，当 $p=0.5$ 时，正面次数多于反面次数的概率与反面次数多于正面次数的概率是相等的，即：
$$P(X > 5) = P(X < 5)$$
又因为所有可能情况的概率之和为 1：
$$P(X > 5) + P(X < 5) + P(X = 5) = 1$$
代入对称性关系：
$$2P(X > 5) + P(X = 5) = 1$$
解得：
$$P(X > 5) = \frac{1 - P(X=5)}{2}$$
将第一问的结果 $P(X=5) = \frac{63}{256}$ 代入：
$$P(X > 5) = \frac{1 - \frac{63}{256}}{2} = \frac{\frac{193}{256}}{2} = \frac{193}{512}$$

#### （3）求至少有连续 4 次正面朝上的概率

设事件 $A$ 为“至少有连续 4 次正面朝上”。直接计算 $A$ 较为复杂，我们采用**补集法**。
设 $\bar{A}$ 为“没有连续 4 次正面朝上”的事件。
我们需要计算长度为 10 的 0-1 序列中，不包含子串 "1111"（代表 HHHH）的序列个数，记为 $a_{10}$。

定义 $a_n$ 为长度为 $n$ 且不包含连续 4 个正面的序列个数。
我们可以根据序列的**结尾情况**建立递推关系。为了不出现 4 个连续正面，合法的序列必须以 T, HT, HHT, 或 HHHT 结尾（其中 T 代表反面，H 代表正面）。
- 如果序列以 T 结尾，则前 $n-1$ 位可以是任意合法序列，个数为 $a_{n-1}$。
- 如果序列以 HT 结尾，则前 $n-2$ 位可以是任意合法序列，个数为 $a_{n-2}$。
- 如果序列以 HHT 结尾，则前 $n-3$ 位可以是任意合法序列，个数为 $a_{n-3}$。
- 如果序列以 HHHT 结尾，则前 $n-4$ 位可以是任意合法序列，个数为 $a_{n-4}$。

因此，递推公式为：
$$a_n = a_{n-1} + a_{n-2} + a_{n-3} + a_{n-4}, \quad \text{对于 } n \geq 4$$
初始条件（直接枚举）：
- $n=0$: $a_0 = 1$ (空集，视为合法)
- $n=1$: $a_1 = 2$ (H, T)
- $n=2$: $a_2 = 4$ (HH, HT, TH, TT)
- $n=3$: $a_3 = 8$ (所有情况均合法)
- $n=4$: $a_4 = 2^4 - 1 = 15$ (只有 HHHH 不合法)

开始递推计算 $a_5$ 到 $a_{10}$：
$$a_5 = a_4 + a_3 + a_2 + a_1 = 15 + 8 + 4 + 2 = 29$$
$$a_6 = a_5 + a_4 + a_3 + a_2 = 29 + 15 + 8 + 4 = 56$$
$$a_7 = a_6 + a_5 + a_4 + a_3 = 56 + 29 + 15 + 8 = 108$$
$$a_8 = a_7 + a_6 + a_5 + a_4 = 108 + 56 + 29 + 15 = 208$$
$$a_9 = a_8 + a_7 + a_6 + a_5 = 208 + 108 + 56 + 29 = 401$$
$$a_{10} = a_9 + a_8 + a_7 + a_6 = 401 + 208 + 108 + 56 = 773$$

所以，不包含连续 4 次正面的序列个数为 773。
则 $\bar{A}$ 的概率为：
$$P(\bar{A}) = \frac{773}{1024}$$
最终求得事件 $A$ 的概率：
$$P(A) = 1 - P(\bar{A}) = 1 - \frac{773}{1024} = \frac{251}{1024}$$

### 答案

（1）正面朝上的次数等于反面朝上的次数的概率为：
$$\frac{63}{256}$$

（2）正面朝上的次数多于反面朝上的次数的概率为：
$$\frac{193}{512}$$

（3）至少有连续 4 次正面朝上的概率为：
$$\frac{251}{1024}$$

### 知识延伸

1.  **二项分布的对称性**：当成功概率 $p=0.5$ 时，二项分布关于均值 $n/2$ 对称。利用 $P(X>k) = P(X<n-k)$ 可以极大地简化计算。
2.  **游程问题（Runs Problem）与递推法**：处理“连续出现 $k$ 次”这类问题时，直接排列组合容易出错（需使用容斥原理）。构建线性递推关系（类似于斐波那契数列的推广）是解决此类计数问题的通用且严谨的方法。
    *   通用公式：若求长度为 $n$ 的序列中不出现连续 $k$ 个 1 的个数 $a_n$，递推式为 $a_n = \sum_{i=1}^{k} a_{n-i}$。
3.  **补集思想**：当题目出现“至少”、“至多”等词汇时，优先考虑计算其对立事件的概率，通常会更简单。

---
