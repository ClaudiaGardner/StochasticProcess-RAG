# 例题3.29

## 题目

考虑一个由 κ > 1 个遍历集合组成的马尔可夫链。很容易看出，有 κ 个不同的稳态向量。每 个遍历集合将具有一个特征值等于 1，其右特征向量在该集合的状态上为 1，其他地方为 0。因此，每个常返类 的稳态向量在同一常返类的每个状态上都严格为正，而在所有其他状态上都为零。 然后，[Pn] 将收敛到一个分块对角矩阵，其中每个遍历集合内的行是相同的。 38 3.5. 具有报酬的马尔科夫链 矩阵的Jordan 标准型情况 在某些情况下，矩阵[P] 的一个或多个特征值重复，但给定重复特征值的线性无关右特征向量的数量小于该 特征值的重数。因此，[P] 不能表示为 [U][Λ][U−1] 的形式，其中 Λ 是特征值按其重数重复的对角矩阵。 线性代数告诉我们存在一个可逆矩阵 [U] 和一个 Jordan 标准型 [J]，使得 [P] = [ U][J][U−1]。 其中，[J] 是具有关于特征值 λi 的Jordan 块的分块对角矩阵。 [J] = 2 664 [J1] ... [Jl] 3 775, [Js] = 2 666664 λs 1 λs ... ... 1 λs 3 777775 . 【定理3.30】 一个有限状态的单链的转移矩阵具有唯一的特征值λ = 1 ，并伴随一个满足π[P] = π 的左特 征向量π，以及一个右特征向量 e = (1 ，. . . ，1)T 。 其他特征值 λi 满足 |λi| ⩽ 1 的不等式。 除非单链是周期性的，例如周期为d，否则不等式是严格的。在这种情况下，有d 个幅度为1 的特征值均匀 分布在单位圆周上。 如果单链是遍历的，那么 [Pn] 收敛到稳态 eπ，每个分量的误差至少以 nkλn s 的速度趋近于零，其中 λs 是 绝对值小于 1 的最大幅度的特征值，k 是特征值λs 对应的最大 Jordan 块的尺寸。

## 解答

**Reviewing Decomposition Strategies**

I'm currently fleshing out the "解题过程" section, detailing the solution process. My main focus is on meticulously explaining the transition from multiple ergodic sets to the implications of the Jordan Canonical Form, which is crucial for understanding the convergence rate in Theorem 3.30. I'm carefully constructing each step, ensuring logical flow and mathematical rigor, and I'll include LaTeX notations to format correctly.


### 题目分析

本题并非一道传统的计算题，而是一段关于**马尔可夫链谱理论（Spectral Theory of Markov Chains）**的理论综述。内容涵盖了三个核心部分：
1.  **多遍历集（Reducible Chains）的性质**：当马尔可夫链包含 $\kappa > 1$ 个遍历集（常返类）时，转移矩阵 $[P]$ 的谱结构及其极限行为。
2.  **Jordan 标准型（Jordan Canonical Form）的应用**：当转移矩阵不可对角化（存在非平凡 Jordan 块）时，矩阵幂 $[P^n]$ 的计算方法。
3.  **单链（Unichain）的收敛定理**：即【定理3.30】，探讨了有限状态单链的特征值分布、稳态分布的存在性以及收敛速度与次主特征值（Subdominant Eigenvalue）及 Jordan 块尺寸的关系。

本题的核心在于利用线性代数中的特征值分解和 Jordan 标准型来分析随机过程的渐近行为（Asymptotic Behavior）。

### 解题过程

#### 1. 多遍历集马尔可夫链的谱结构 ($\kappa > 1$)

考虑一个包含 $\kappa$ 个遍历集合（Ergodic Sets，记为 $E_1, \dots, E_\kappa$）的马尔可夫链。

*   **特征值 $\lambda=1$ 的重数**：
    对于每一个遍历集合 $E_i$，我们可以构造一个稳态分布向量 $\pi^{(i)}$，其在 $E_i$ 内的状态上严格为正，在 $E_i$ 之外为 $0$。由于这些集合互不相通，$\pi^{(1)}, \dots, \pi^{(\kappa)}$ 是线性无关的。
    根据马尔可夫链理论，$\pi^{(i)} [P] = \pi^{(i)}$。这意味着 $\lambda = 1$ 的**几何重数**（Geometric Multiplicity）至少为 $\kappa$。

*   **右特征向量**：
    对应于每个遍历集 $E_i$，存在一个右特征向量 $v^{(i)}$，使得：
    $$ [P] v^{(i)} = v^{(i)} $$
    其中 $v^{(i)}$ 在 $E_i$ 的状态上分量为 $1$，在其他状态上为 $0$。

*   **极限矩阵的形式**：
    通过适当排列状态索引，转移矩阵 $[P]$ 可以写成标准形式（Canonical Form）：
    $$ [P] = \begin{pmatrix} P_1 & 0 & \dots & 0 \\ 0 & P_2 & \dots & 0 \\ \vdots & \vdots & \ddots & \vdots \\ R_1 & R_2 & \dots & Q \end{pmatrix} $$
    其中 $P_i$ 对应第 $i$ 个遍历集，$Q$ 对应瞬态集（Transient States）。
    当 $n \to \infty$ 时，$[P^n]$ 收敛到一个分块对角矩阵（忽略瞬态部分的复杂性），每个遍历块内部收敛到其各自的稳态矩阵 $\mathbf{1} \pi^{(i)}$。

#### 2. 矩阵的 Jordan 标准型与收敛分析

当矩阵 $[P]$ 的某个特征值 $\lambda_i$ 的几何重数小于代数重数时，$[P]$ 不可对角化。此时需引入 Jordan 标准型：
$$ [P] = [U][J][U^{-1}] $$
其中 $[J]$ 是分块对角矩阵，由 Jordan 块 $[J_s]$ 组成：
$$ [J_s] = \begin{pmatrix} \lambda_s & 1 & 0 & \dots \\ 0 & \lambda_s & 1 & \dots \\ \vdots & \vdots & \ddots & \vdots \\ 0 & 0 & \dots & \lambda_s \end{pmatrix} $$

计算 $[P^n]$ 需要计算 $[J^n]$。对于一个尺寸为 $k \times k$ 的 Jordan 块 $[J_s]$，其 $n$ 次幂的元素涉及二项式系数。具体地，$[J_s^n]$ 的上三角元素形式为：
$$ (J_s^n)_{ij} = \binom{n}{j-i} \lambda_s^{n-(j-i)} $$
当 $n$ 很大时，二项式系数 $\binom{n}{m}$ 的增长速度约为 $n^m$。因此，该块的元素随 $n$ 的变化趋势由以下项主导：
$$ n^{k-1} \lambda_s^n $$
这解释了题目中提到的收敛速度包含多项式因子 $n^k$（注：严格数学推导通常为 $n^{k-1}$，但在大 $O$ 符号下或特定上下文中常简述为与块尺寸 $k$ 相关）。

#### 3. 单链（Unichain）的收敛定理（定理3.30解析）

单链是指只有一个遍历集（可能包含一些瞬态）的马尔可夫链。

*   **特征值 $\lambda=1$ 的性质**：
    由于只有一个遍历集，$\lambda=1$ 是唯一的模为 1 的特征值（假设非周期）。
    *   **左特征向量**：$\pi$（稳态分布），满足 $\pi [P] = \pi, \sum \pi_i = 1$。
    *   **右特征向量**：$e = (1, \dots, 1)^T$，满足 $[P] e = e$。

*   **其他特征值**：
    对于随机矩阵，所有特征值满足 $|\lambda_i| \le 1$。
    *   **非周期性（Aperiodic）**：除 $\lambda_1=1$ 外，所有其他特征值严格满足 $|\lambda_i| < 1$。
    *   **周期性（Periodic）**：若周期为 $d$，则有 $d$ 个特征值均匀分布在单位圆上，即 $\lambda_k = e^{i \frac{2\pi k}{d}}$。

*   **收敛速度**：
    若单链是遍历的（即非周期且不可约，或单遍历类非周期），则：
    $$ \lim_{n \to \infty} [P^n] = e \pi = \begin{pmatrix} \pi_1 & \dots & \pi_m \\ \vdots & & \vdots \\ \pi_1 & \dots & \pi_m \end{pmatrix} $$
    收敛的误差项由绝对值第二大的特征值（次主特征值）决定。设 $\lambda_s$ 为满足 $|\lambda_s| < 1$ 的最大模特征值。
    $$ [P^n] - e\pi \approx O(n^{k-1} \lambda_s^n) $$
    这里 $k$ 是对应于 $\lambda_s$ 的最大 Jordan 块的尺寸。
    *   若 $\lambda_s$ 可对角化（$k=1$），收敛速度为几何级数 $\lambda_s^n$。
    *   若 $\lambda_s$ 对应非平凡 Jordan 块（$k>1$），收敛速度会因多项式因子 $n^{k-1}$ 而略微变慢，但由于 $|\lambda_s|^n$ 的指数衰减占主导，整体仍趋于 0。

### 答案

对于定理 3.30 描述的遍历单链，其 $n$ 步转移矩阵 $[P^n]$ 的极限行为及收敛速率可表述为：

$$ \lim_{n \to \infty} [P^n] = \mathbf{1}\pi $$

其中 $\mathbf{1}$ 是全 1 列向量，$\pi$ 是唯一的稳态概率行向量。

对于有限 $n$，其与稳态的偏差（误差）主要由模最大的非 1 特征值 $\lambda_s$ 控制。若 $\lambda_s$ 对应的最大 Jordan 块尺寸为 $k$，则误差项 $E_n$ 的渐近行为满足：

$$ \| [P^n] - \mathbf{1}\pi \| \sim C \cdot n^{k-1} |\lambda_s|^n $$

题目文本中表述为“以 $n^k \lambda_s^n$ 的速度”，这在数量级分析上指出了多项式增长因子与指数衰减因子的耦合。

### 知识延伸

1.  **Perron-Frobenius 定理**：这是本题背后的核心数学支柱。对于不可约非负矩阵（如遍历链的转移矩阵），该定理保证了最大特征值实数正性、简单性（simple root）以及对应正特征向量的存在性。
2.  **谱隙（Spectral Gap）**：定义为 $\gamma = 1 - |\lambda_s|$。谱隙越大，马尔可夫链收敛到稳态的速度越快（混合时间 Mixing Time 越短）。
3.  **代数重数 vs 几何重数**：
    *   **代数重数**：特征多项式中根的重数。
    *   **几何重数**：对应特征值的线性无关特征向量的个数。
    *   当几何重数 < 代数重数时，必须使用 Jordan 标准型，这在马尔可夫链中较少见但理论上存在。
4.  **易错点**：
    *   混淆**周期性**与**收敛性**。周期链不收敛到静态矩阵，而是在 $d$ 个矩阵间循环。
    *   忽略 Jordan 块带来的 $n^k$ 因子。虽然在 $n \to \infty$ 时指数项 $|\lambda|^n$ 占主导，但在 $n$ 较小时，多项式因子可能显著影响收敛曲线。

---
