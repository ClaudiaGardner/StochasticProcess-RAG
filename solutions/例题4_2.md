# 例题4.2

## 题目

对于任意给定的常返状态，马尔科夫链在连续访问该状态时都有更新。假设一个常返的有限状 态马尔科夫链从0 时刻i 状态开始，有一个转移矩阵[P]。在时刻为n 时第一次返回i 状态，从时刻n 开始的马 尔科夫链是从时刻 0 开始的马尔科夫链的概率副本。 每次在给定n 时刻返回i 状态，都会启动一个新的马尔可夫链的概率副本，该链从0 时刻的i 状态开始。因 此，进入i 状态的时间序列可以看作是更新过程的到达时刻。很明显访问一个常返态的间隔时间是独立的。 通过研究更新可以得到一个不明显结果，即 i 状态之间的期望再访时间是 1/πi。我们可以直接从马尔可夫 链推导出来，但使用更新过程更简洁。 假设如下图(a) 给出的马尔科夫链，我们可以利用陷阱状态的技巧计算从1 状态到1 状态的期望首次通过时 间。期望首次通过时间 v1 = 1 + X k̸=1 P1,kvk， 45 4.1. 引言 图4.3: 利用陷阱状态的技巧计算从 1 状态到 1 状态的期望首次通过时间 其中对于任意j ̸= 1 ，vj 满足 vj = 1 + P k̸=1 Pj,kvk。等式两边同时乘 πj 并求和，可以得到 X j πjvj =1 + X j X k̸=1 πjPj,kvk =1 + X k̸=1 X j πjPj,kvk =1 + X k̸=1 πkvk￿ 因此，得到 π1v1 = 1 即v1 = 1/ π1。 思考题：考虑有限状态Markov 链X1，X2，· · ·，Xn，· · ·。设其是遍历的，稳态概率（也是极限概率）分 布记作π。在 n 长的序列中，状态“1”大致发生多少次呢？

## 解答

**Evaluating Problem Parameters**

I've analyzed the problem, focusing on key elements like the ergodic Markov chain and the stationary distribution's role. I'm now drafting the solution, using indicator variables and the Ergodic Theorem to estimate the number of state "1" occurrences in a sequence of length $n$. I am checking the logic, ensuring the final result uses LaTeX.


### 题目分析
本题基于马尔可夫链的遍历性（Ergodicity）与稳态分布（Stationary Distribution）的概念。题目给出的背景文本通过更新过程（Renewal Process）和“陷阱状态”技巧推导出了平均常返时间（Mean Recurrence Time）$v_1$ 与稳态概率 $\pi_1$ 之间的关系 $v_1 = 1/\pi_1$。思考题的核心在于利用马尔可夫链的大数定律（Ergodic Theorem），求解在长度为 $n$ 的时间序列中，特定状态“1”出现的期望次数或渐近次数。我们需要识别出稳态概率 $\pi$ 的物理意义，即长跑中访问某状态的时间比例。

### 解题过程

**1. 定义计数变量与指示变量**

设 $X_1, X_2, \dots, X_n$ 为该有限状态遍历马尔可夫链的状态序列。我们需要计算状态“1”在 $n$ 步中出现的次数。
定义指示随机变量（Indicator Random Variable）$I_k$ 如下：
$$
I_k = \begin{cases} 
1, & \text{若 } X_k = 1 \\
0, & \text{若 } X_k \neq 1 
\end{cases}
$$
那么，在 $n$ 长的序列中，状态“1”发生的总次数 $N_n(1)$ 可以表示为：
$$
N_n(1) = \sum_{k=1}^{n} I_k
$$

**2. 利用马尔可夫链的遍历定理（Ergodic Theorem）**

题目已知该马尔可夫链是遍历的（Ergodic），且存在稳态分布 $\pi$。根据马尔可夫链的遍历定理（也称为马尔可夫链的强大数定律），对于任意状态 $j$（此处 $j=1$），状态 $j$ 被访问的长期时间比例收敛于其稳态概率 $\pi_j$。

数学表达为：
$$
\lim_{n \to \infty} \frac{N_n(1)}{n} = \pi_1 \quad \text{(几乎处处收敛 / almost surely)}
$$
这意味着，当 $n$ 足够大时，状态“1”出现的频率趋近于 $\pi_1$。

**3. 计算期望次数**

我们也可以从期望的角度来分析。我们需要计算 $E[N_n(1)]$：
$$
E[N_n(1)] = E\left[ \sum_{k=1}^{n} I_k \right] = \sum_{k=1}^{n} E[I_k] = \sum_{k=1}^{n} P(X_k = 1)
$$
由于马尔可夫链是遍历的，当 $k$ 趋于无穷大时，$P(X_k = 1) \to \pi_1$。
如果 $n$ 很大，或者初始分布即为稳态分布（即 $P(X_1=1) = \pi_1$），则对于所有的 $k$，都有 $P(X_k=1) \approx \pi_1$。

因此，总次数的期望近似为：
$$
E[N_n(1)] \approx \sum_{k=1}^{n} \pi_1 = n\pi_1
$$

**4. 结合题目背景的直观解释**

题目背景中推导出的公式为 $v_1 = 1/\pi_1$，其中 $v_1$ 是状态 1 的平均常返时间（Mean Recurrence Time）。
这意味着平均每隔 $1/\pi_1$ 步，马尔可夫链就会返回一次状态 1。
因此，在 $n$ 步的时间长度内，访问状态 1 的次数大约为总时间除以平均间隔时间：
$$
\text{次数} \approx \frac{n}{v_1} = \frac{n}{1/\pi_1} = n\pi_1
$$

### 答案

在 $n$ 长的序列中，状态“1”发生的次数大致为：
$$ n\pi_1 $$

### 知识延伸

1.  **马尔可夫链遍历定理 (Ergodic Theorem)**：
    对于不可约（Irreducible）、正常返（Positive Recurrent）的马尔可夫链，无论初始状态如何，长期来看，系统处于状态 $i$ 的时间比例等于该状态的稳态概率 $\pi_i$。即：
    $$ \lim_{n \to \infty} \frac{1}{n} \sum_{k=1}^n I_{\{X_k=i\}} = \pi_i \quad a.s. $$

2.  **平均常返时间 (Mean Recurrence Time)**：
    状态 $i$ 的平均常返时间 $\mu_{ii}$（文中记作 $v_i$）与稳态概率 $\pi_i$ 互为倒数关系：
    $$ \pi_i = \frac{1}{\mu_{ii}} $$
    这一性质连接了“时间平均”（平均多久回一次）和“概率平均”（长期存在的概率）。

3.  **常见解题技巧**：
    *   **指示变量法**：在处理计数问题或求期望时，引入 $I_k$ 是将复杂随机过程转化为简单求和的强力工具。
    *   **稳态方程**：求解 $\pi$ 通常需要解方程组 $\pi = \pi P$ 且 $\sum \pi_i = 1$。

4.  **易错点**：
    *   混淆**瞬态（Transient）**与**常返态（Recurrent）**。只有在正常返状态下，$\pi_i > 0$ 且上述倒数关系成立。若是零常返或瞬态，$\pi_i = 0$。
    *   忽略 $n$ 必须足够大这一前提。对于较小的 $n$，实际发生次数受初始状态 $X_0$ 的影响较大，不能直接简单用 $n\pi_1$ 近似，除非初始分布已经是稳态分布。

---
