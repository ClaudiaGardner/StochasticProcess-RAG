# 例题0.48

## 题目

由均匀随机变量 (0，1) 产生随机变量 X ∼ FX (x) 的一般方法。

## 解答

**Defining the Solution**

I've moved past problem analysis and am now drafting the solution steps. The Inverse Transform Theorem is the core. I'm carefully deriving the transformation and incorporating the generalized inverse to cover all cases. LaTeX formatting is being double-checked.


### 题目分析

本题考查的是随机变量生成的**逆变换法**（Inverse Transform Method），这是蒙特卡洛模拟和随机过程模拟中最基础且最重要的方法之一。题目要求利用一个服从 $(0, 1)$ 区间均匀分布的随机变量 $U$，构造出具有特定累积分布函数（CDF）$F_X(x)$ 的随机变量 $X$。核心在于利用分布函数的反函数（或广义反函数）进行变换。

### 解题过程

**1. 设定基础条件**

设 $U$ 是一个服从标准均匀分布的随机变量，即 $U \sim U(0, 1)$。其累积分布函数 $F_U(u)$ 为：
$$
F_U(u) = P(U \le u) = \begin{cases} 0, & u < 0 \\ u, & 0 \le u \le 1 \\ 1, & u > 1 \end{cases}
$$
我们需要寻找一个变换 $X = g(U)$，使得 $X$ 的累积分布函数为给定的 $F_X(x)$。

**2. 构造变换函数**

根据逆变换法的原理，我们取 $X$ 为 $F_X$ 的反函数作用于 $U$。
若 $F_X(x)$ 是严格单调递增且连续的函数，则其反函数 $F_X^{-1}(y)$ 存在且唯一。定义随机变量 $X$ 为：
$$
X = F_X^{-1}(U)
$$

**3. 证明变换后的分布**

我们需要验证上述定义的 $X$ 的累积分布函数确实是 $F_X(x)$。
对于任意实数 $x$，计算 $X \le x$ 的概率：
$$
P(X \le x) = P(F_X^{-1}(U) \le x)
$$
由于 $F_X$ 是单调递增函数，我们在不等式两边同时作用 $F_X$，不等号方向不变：
$$
P(F_X^{-1}(U) \le x) = P(U \le F_X(x))
$$
根据 $U \sim U(0, 1)$ 的性质，对于任意 $y \in [0, 1]$，有 $P(U \le y) = y$。
因为 $F_X(x)$ 是分布函数，其值域为 $[0, 1]$，所以令 $y = F_X(x)$，代入上式得：
$$
P(U \le F_X(x)) = F_X(x)
$$
综上所述：
$$
P(X \le x) = F_X(x)
$$
这证明了随机变量 $X = F_X^{-1}(U)$ 服从分布 $F_X(x)$。

**4. 推广情况（广义反函数）**

如果 $F_X(x)$ 不是严格单调递增（即存在平坦区域）或者不连续（即离散或混合分布），我们需要使用**广义反函数**。定义广义反函数 $F_X^{-1}(u)$ 为：
$$
F_X^{-1}(u) = \inf \{ x : F_X(x) \ge u \}, \quad 0 < u < 1
$$
利用性质 $F_X^{-1}(u) \le x \iff u \le F_X(x)$，上述推导过程依然成立：
$$
P(X \le x) = P(F_X^{-1}(U) \le x) = P(U \le F_X(x)) = F_X(x)
$$

### 答案

由均匀随机变量 $U \sim U(0, 1)$ 产生具有累积分布函数 $F_X(x)$ 的随机变量 $X$ 的一般方法是令：
$$
X = F_X^{-1}(U)
$$
其中 $F_X^{-1}$ 是 $F_X$ 的反函数（或广义反函数，定义为 $F_X^{-1}(u) = \inf \{ x : F_X(x) \ge u \}$）。

### 知识延伸

1.  **定理名称**：此方法称为**逆变换采样法**（Inverse Transform Sampling）或**概率积分变换**（Probability Integral Transform）。
2.  **适用范围**：
    *   适用于所有累积分布函数 $F_X(x)$ 已知且其反函数易于计算的情况。
    *   对于离散型随机变量，该方法等价于查找表法（将 $(0,1)$ 区间划分为对应概率大小的子区间）。
3.  **局限性与技巧**：
    *   如果 $F_X(x)$ 的反函数没有解析表达式（例如正态分布 $\Phi(x)$），则直接使用此方法计算成本较高，通常需要数值逼近或改用**Box-Muller变换**、**拒绝采样法**（Rejection Sampling）等其他方法。
4.  **易错点**：
    *   在定义广义反函数时，使用的是下确界（infimum），且不等号方向是 $F_X(x) \ge u$。
    *   对于离散变量，反函数对应的是阶梯函数的跳跃点。

---
