# 习题3.5

## 题目

某地区的天气状况可分为多云和阴天两种，分别记为1和2，并用马尔可夫链 $\mathrm{X}=( X_{n} , \; \; n \geq0 )$ 描述， 其转移概率矩阵为 $$ \mathrm{P}=\left( \begin{matrix} {\frac{1} {2}} & {\frac{1} {2}} \\ {\frac{1} {3}} & {\frac{2} {3}} \\ \end{matrix} \right) $$ 如果已知今天是多云，求3天、5天、10天及更长时间以后天气状况的分布规律。

## 解答

**Revising Solution Approach**

I've checked the eigenvector calculations and matrix inversions again, ensuring precision. The formula for the probability at each step seems accurate, confirmed against the limiting distribution. Preparing to write the formal solution with LaTeX, explicitly showing the probability vectors for n=3, 5, and 10, alongside the long-term probabilities, emphasizing the mathematical framework for the expert.


### 题目分析

本题考查的核心概念是**齐次马尔可夫链（Homogeneous Markov Chain）**的**$n$步转移概率**及**平稳分布（极限分布）**。
题目给出了状态空间 $S=\{1, 2\}$（1代表多云，2代表阴天）以及一步转移概率矩阵 $\mathrm{P}$。
已知初始状态为多云（即 $X_0=1$），求解目标是计算 $n$ 天后的状态分布概率向量 $\pi_n$，具体对应 $n=3, 5, 10$ 以及 $n \to \infty$ 的情况。
解题的关键在于计算矩阵的 $n$ 次幂 $\mathrm{P}^n$，通常利用**矩阵的谱分解（特征值分解）**方法来处理。

### 解题过程

#### 1. 设定模型与参数

设状态 1 为多云，状态 2 为阴天。
一步转移概率矩阵为：
$$ \mathrm{P}=\left( \begin{matrix} {\frac{1} {2}} & {\frac{1} {2}} \\ {\frac{1} {3}} & {\frac{2} {3}} \\ \end{matrix} \right) $$
已知今天是多云，即初始分布向量为 $\pi_0 = (1, 0)$。
$n$ 天后的天气分布 $\pi_n$ 由下式给出：
$$ \pi_n = \pi_0 \mathrm{P}^n $$
由于 $\pi_0 = (1, 0)$，$\pi_n$ 实际上就是矩阵 $\mathrm{P}^n$ 的第一行向量。

#### 2. 矩阵 $\mathrm{P}$ 的特征值分解

为了计算 $\mathrm{P}^n$，我们需要求出 $\mathrm{P}$ 的特征值和特征向量。
特征方程为 $|\lambda \mathrm{I} - \mathrm{P}| = 0$：
$$ \det\left( \begin{matrix} \lambda - \frac{1}{2} & -\frac{1}{2} \\ -\frac{1}{3} & \lambda - \frac{2}{3} \end{matrix} \right) = (\lambda - \frac{1}{2})(\lambda - \frac{2}{3}) - \frac{1}{6} = \lambda^2 - \frac{7}{6}\lambda + \frac{1}{3} - \frac{1}{6} = \lambda^2 - \frac{7}{6}\lambda + \frac{1}{6} = 0 $$
解得特征值为：
$$ \lambda_1 = 1, \quad \lambda_2 = \frac{1}{6} $$

求对应的特征向量：
1.  对于 $\lambda_1 = 1$，解方程 $(\mathrm{P} - \mathrm{I})x = 0$：
    $$ \left( \begin{matrix} -\frac{1}{2} & \frac{1}{2} \\ \frac{1}{3} & -\frac{1}{3} \end{matrix} \right) \left( \begin{matrix} x_1 \\ x_2 \end{matrix} \right) = 0 \implies x_1 = x_2 $$
    取特征向量 $u_1 = (1, 1)^T$。

2.  对于 $\lambda_2 = \frac{1}{6}$，解方程 $(\mathrm{P} - \frac{1}{6}\mathrm{I})x = 0$：
    $$ \left( \begin{matrix} \frac{1}{3} & \frac{1}{2} \\ \frac{1}{3} & \frac{1}{2} \end{matrix} \right) \left( \begin{matrix} x_1 \\ x_2 \end{matrix} \right) = 0 \implies \frac{1}{3}x_1 + \frac{1}{2}x_2 = 0 \implies 2x_1 + 3x_2 = 0 $$
    取特征向量 $u_2 = (3, -2)^T$。

构造相似变换矩阵 $\mathrm{U}$ 及其逆矩阵 $\mathrm{U}^{-1}$：
$$ \mathrm{U} = (u_1, u_2) = \left( \begin{matrix} 1 & 3 \\ 1 & -2 \end{matrix} \right) $$
$$ \det(\mathrm{U}) = -2 - 3 = -5 $$
$$ \mathrm{U}^{-1} = \frac{1}{-5} \left( \begin{matrix} -2 & -3 \\ -1 & 1 \end{matrix} \right) = \left( \begin{matrix} \frac{2}{5} & \frac{3}{5} \\ \frac{1}{5} & -\frac{1}{5} \end{matrix} \right) $$

#### 3. 计算 $\mathrm{P}^n$ 的通项公式

利用公式 $\mathrm{P}^n = \mathrm{U} \Lambda^n \mathrm{U}^{-1}$：
$$ \mathrm{P}^n = \left( \begin{matrix} 1 & 3 \\ 1 & -2 \end{matrix} \right) \left( \begin{matrix} 1^n & 0 \\ 0 & (\frac{1}{6})^n \end{matrix} \right) \left( \begin{matrix} \frac{2}{5} & \frac{3}{5} \\ \frac{1}{5} & -\frac{1}{5} \end{matrix} \right) $$
$$ = \left( \begin{matrix} 1 & 3(\frac{1}{6})^n \\ 1 & -2(\frac{1}{6})^n \end{matrix} \right) \left( \begin{matrix} \frac{2}{5} & \frac{3}{5} \\ \frac{1}{5} & -\frac{1}{5} \end{matrix} \right) $$
我们只需要计算 $\mathrm{P}^n$ 的第一行元素（对应初始状态为多云）：
$$ p_{11}^{(n)} = 1 \cdot \frac{2}{5} + 3\left(\frac{1}{6}\right)^n \cdot \frac{1}{5} = \frac{2}{5} + \frac{3}{5}\left(\frac{1}{6}\right)^n $$
$$ p_{12}^{(n)} = 1 \cdot \frac{3}{5} + 3\left(\frac{1}{6}\right)^n \cdot \left(-\frac{1}{5}\right) = \frac{3}{5} - \frac{3}{5}\left(\frac{1}{6}\right)^n $$

因此，$n$ 天后天气分布的通项公式为：
$$ \pi_n = \left( \frac{2}{5} + \frac{3}{5 \cdot 6^n}, \quad \frac{3}{5} - \frac{3}{5 \cdot 6^n} \right) $$

#### 4. 具体计算各时间点的分布

**（1）3天后 ($n=3$)：**
$$ P(X_3=1) = \frac{2}{5} + \frac{3}{5 \cdot 6^3} = 0.4 + \frac{3}{5 \cdot 216} = 0.4 + \frac{1}{360} \approx 0.4028 $$
$$ P(X_3=2) = 1 - P(X_3=1) \approx 0.5972 $$
分布为：$(\frac{145}{360}, \frac{215}{360}) = (\frac{29}{72}, \frac{43}{72})$

**（2）5天后 ($n=5$)：**
$$ P(X_5=1) = \frac{2}{5} + \frac{3}{5 \cdot 6^5} = 0.4 + \frac{1}{5 \cdot 2592} = 0.4 + \frac{1}{12960} \approx 0.400077 $$
$$ P(X_5=2) \approx 0.599923 $$

**（3）10天后 ($n=10$)：**
$$ P(X_{10}=1) = \frac{2}{5} + \frac{3}{5 \cdot 6^{10}} = 0.4 + \frac{1}{5 \cdot 60466176} \approx 0.400000003 $$
$$ P(X_{10}=2) \approx 0.599999997 $$

**（4）更长时间以后 ($n \to \infty$)：**
由于 $|\lambda_2| = 1/6 < 1$，当 $n \to \infty$ 时，$(\frac{1}{6})^n \to 0$。
$$ \lim_{n \to \infty} \pi_n = \left( \frac{2}{5}, \frac{3}{5} \right) = (0.4, 0.6) $$

### 答案

已知今天是多云，未来 $n$ 天的天气分布规律为：
$$ P(X_n=\text{多云}) = \frac{2}{5} + \frac{3}{5}\left(\frac{1}{6}\right)^n, \quad P(X_n=\text{阴天}) = \frac{3}{5} - \frac{3}{5}\left(\frac{1}{6}\right)^n $$

具体数值如下：
1.  **3天后**：多云概率 $\frac{29}{72} \approx 0.4028$，阴天概率 $\frac{43}{72} \approx 0.5972$。
2.  **5天后**：多云概率 $0.4 + \frac{1}{12960} \approx 0.4001$，阴天概率 $\approx 0.5999$。
3.  **10天后**：多云概率极接近 $0.4$，阴天概率极接近 $0.6$（偏差量级为 $10^{-9}$）。
4.  **更长时间以后**：天气状况趋于稳定分布，多云的概率为 $0.4$，阴天的概率为 $0.6$。

### 知识延伸

1.  **平稳分布（Stationary Distribution）**：
    本题中求得的极限分布 $\pi = (0.4, 0.6)$ 即为该马尔可夫链的平稳分布。它满足方程 $\pi \mathrm{P} = \pi$ 且 $\sum \pi_i = 1$。对于遍历的马尔可夫链，无论初始状态如何，系统最终都会收敛到这个分布。

2.  **收敛速度**：
    收敛速度取决于第二大特征值（按模长）的大小。本题中 $\lambda_2 = 1/6$，由于该值很小（接近0），说明系统收敛到平稳分布的速度非常快。这也是为什么仅3天后，概率就已经非常接近极限值 $0.4$ 的原因。

3.  **解题技巧**：
    *   对于 $2 \times 2$ 的随机矩阵 $\mathrm{P}=\left( \begin{matrix} {1-a} & {a} \\ {b} & {1-b} \\ \end{matrix} \right)$，其平稳分布公式为 $\pi = (\frac{b}{a+b}, \frac{a}{a+b})$。本题中 $a=1/2, b=1/3$，代入可直接验证 $\pi = (\frac{1/3}{1/2+1/3}, \frac{1/2}{1/2+1/3}) = (\frac{2}{5}, \frac{3}{5})$。
    *   计算 $\mathrm{P}^n$ 时，务必检查行和是否为1，这是检验计算正确性的简单方法。

---
