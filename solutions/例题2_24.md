# 例题2.24

## 题目

设U1，U2，U3，U4，U5 是5 个在[0，1] 上独立均匀分布的随机变量，X1，X2，X3，X4，X5 是{Ui，1 ≤ i ≤ 5} 的顺序统计量，即 Xi 为{Ui，1 ≤ i ≤ 5} 从小到大排序的第 i 个值， X1 = min{U1，U2，U3，U4，U5}，. . . ，X5 = max{U1，U2，U3，U4，U5}。 计算 (1) E[X5]； (2) E[X4|X5 = 0 .8]； (3) E[X4|X5 = x5], x5 ∈ [0, 1]； (4) E[X4]。

## 解答

**Formulating the Solution**

The core concepts are solidified: order statistics, Beta distribution, conditional expectation, and the law of total expectation are all essential. The solution strategy is clearly laid out, with a focus on both direct calculation and demonstrating the underlying principles. The output structure is finalized and the plan for LaTeX is ready. I'm prepared to provide a professional, direct solution.


### 题目分析

本题考查**均匀分布顺序统计量（Order Statistics）**的性质及其条件期望的计算。
题目给定 $U_1, \dots, U_5$ 为 $[0, 1]$ 上的独立同分布（i.i.d.）均匀随机变量，$X_1, \dots, X_5$ 为其顺序统计量，其中 $X_k$ 表示第 $k$ 小的值。
核心考点包括：
1.  均匀分布顺序统计量的期望公式。
2.  顺序统计量的联合概率密度函数（PDF）与条件概率密度函数。
3.  条件期望的计算方法。
4.  全期望公式（Law of Total Expectation）的应用。

需要求解的目标依次为：$X_5$ 的期望、给定 $X_5=0.8$ 时 $X_4$ 的条件期望、给定 $X_5=x_5$ 时 $X_4$ 的一般条件期望表达式，以及 $X_4$ 的无条件期望。

---

### 解题过程

已知 $n=5$，总体为 $U[0, 1]$ 分布。

#### (1) 计算 $E[X_5]$

对于 $[0, 1]$ 上均匀分布的 $n$ 个样本，其第 $k$ 个顺序统计量 $X_k$ 服从 Beta 分布，即 $X_k \sim \text{Beta}(k, n-k+1)$。
其期望公式为：
$$E[X_k] = \frac{k}{n+1}$$

在本题中，要求 $X_5$ 的期望，即 $k=5, n=5$：
$$E[X_5] = \frac{5}{5+1} = \frac{5}{6}$$

**推导验证（通过概率密度函数）：**
$X_5$ 是 $n=5$ 个样本的最大值。其分布函数为 $F_{X_5}(x) = [F_U(x)]^5 = x^5$（对于 $x \in [0, 1]$）。
概率密度函数为：
$$f_{X_5}(x) = \frac{d}{dx}x^5 = 5x^4, \quad 0 \le x \le 1$$
期望为：
$$E[X_5] = \int_0^1 x \cdot f_{X_5}(x) \, dx = \int_0^1 x \cdot 5x^4 \, dx = \int_0^1 5x^5 \, dx = \left[ \frac{5}{6}x^6 \right]_0^1 = \frac{5}{6}$$

---

#### (2) 计算 $E[X_4 | X_5 = 0.8]$

为了回答这个问题，我们需要先理解 $X_4$ 在给定 $X_5$ 条件下的行为。这实际上是第 (3) 问的一个特例。

根据顺序统计量的马尔可夫性质或直观理解：
给定 $X_5 = x_5$（最大值为 $x_5$），剩下的 $n-1=4$ 个随机变量 $X_1, X_2, X_3, X_4$ 相当于是在区间 $[0, x_5]$ 上独立均匀分布的 4 个随机变量的顺序统计量。

因此，在条件 $X_5 = 0.8$ 下，$X_4$ 相当于 4 个在 $[0, 0.8]$ 上均匀分布的随机变量的最大值。
设 $Y \sim U[0, a]$，则 $n$ 个 $Y$ 的最大值的期望为 $\frac{n}{n+1}a$。
这里样本数 $m=4$，区间长度 $a=0.8$。
$$E[X_4 | X_5 = 0.8] = \frac{4}{4+1} \times 0.8 = \frac{4}{5} \times 0.8 = 0.64$$

---

#### (3) 计算 $E[X_4 | X_5 = x_5], \quad x_5 \in [0, 1]$

我们将通过严格的条件概率密度函数推导上述直观结论。

1.  **联合概率密度函数**：
    $X_4$ 和 $X_5$ 的联合概率密度函数 $f_{X_4, X_5}(x_4, x_5)$ 由下式给出（其中 $0 \le x_4 \le x_5 \le 1$）：
    $$f_{X_4, X_5}(x_4, x_5) = \frac{n!}{(4-1)!(5-4)!(5-5)!} [F(x_4)]^{4-1} [F(x_5)-F(x_4)]^{5-4-1} [1-F(x_5)]^{5-5} f(x_4) f(x_5)$$
    代入 $n=5, F(x)=x, f(x)=1$：
    $$f_{X_4, X_5}(x_4, x_5) = \frac{120}{6 \cdot 1 \cdot 1} x_4^3 \cdot 1 \cdot 1 \cdot 1 \cdot 1 = 20 x_4^3, \quad 0 \le x_4 \le x_5 \le 1$$

2.  **边缘概率密度函数**：
    $X_5$ 的边缘密度函数为（如第一问所述）：
    $$f_{X_5}(x_5) = 5 x_5^4, \quad 0 \le x_5 \le 1$$

3.  **条件概率密度函数**：
    $$f_{X_4 | X_5}(x_4 | x_5) = \frac{f_{X_4, X_5}(x_4, x_5)}{f_{X_5}(x_5)} = \frac{20 x_4^3}{5 x_5^4} = \frac{4 x_4^3}{x_5^4}, \quad 0 \le x_4 \le x_5$$
    这表明 $X_4/x_5$ 在给定 $X_5=x_5$ 时服从参数为 $(4, 1)$ 的 Beta 分布（即幂律分布）。

4.  **计算条件期望**：
    $$E[X_4 | X_5 = x_5] = \int_0^{x_5} x_4 \cdot f_{X_4 | X_5}(x_4 | x_5) \, dx_4$$
    $$= \int_0^{x_5} x_4 \cdot \frac{4 x_4^3}{x_5^4} \, dx_4 = \frac{4}{x_5^4} \int_0^{x_5} x_4^4 \, dx_4$$
    $$= \frac{4}{x_5^4} \left[ \frac{x_4^5}{5} \right]_0^{x_5} = \frac{4}{x_5^4} \cdot \frac{x_5^5}{5} = \frac{4}{5} x_5$$

---

#### (4) 计算 $E[X_4]$

**方法一：直接利用顺序统计量期望公式**
对于 $U[0, 1]$ 上的 $n=5$ 个样本，第 $k=4$ 个顺序统计量的期望为：
$$E[X_4] = \frac{k}{n+1} = \frac{4}{5+1} = \frac{4}{6} = \frac{2}{3}$$

**方法二：利用全期望公式（Law of Iterated Expectations）验证**
利用第 (3) 问的结果 $E[X_4 | X_5] = \frac{4}{5} X_5$：
$$E[X_4] = E\left[ E[X_4 | X_5] \right] = E\left[ \frac{4}{5} X_5 \right] = \frac{4}{5} E[X_5]$$
代入第 (1) 问的结果 $E[X_5] = \frac{5}{6}$：
$$E[X_4] = \frac{4}{5} \cdot \frac{5}{6} = \frac{4}{6} = \frac{2}{3}$$

---

### 答案

(1) $E[X_5] = \frac{5}{6}$

(2) $E[X_4 | X_5 = 0.8] = 0.64$

(3) $E[X_4 | X_5 = x_5] = \frac{4}{5}x_5$

(4) $E[X_4] = \frac{2}{3}$

---

### 知识延伸

1.  **均匀分布顺序统计量的通项公式**：
    若 $U_1, \dots, U_n \sim U[0, 1]$ 独立同分布，则第 $k$ 个顺序统计量 $X_k \sim \text{Beta}(k, n-k+1)$。
    -   期望：$E[X_k] = \frac{k}{n+1}$
    -   方差：$\text{Var}(X_k) = \frac{k(n-k+1)}{(n+1)^2(n+2)}$

2.  **顺序统计量的马尔可夫性（重缩放性质）**：
    给定 $X_{j} = x$ ($j > k$)，较小的顺序统计量 $X_1, \dots, X_{j-1}$ 的条件分布等同于从区间 $[0, x]$ 中抽取的 $j-1$ 个样本的顺序统计量。
    即：$(X_k | X_j = x) \overset{d}{=} x \cdot Y_k$，其中 $Y_k$ 是 $j-1$ 个 $U[0, 1]$ 样本的第 $k$ 个顺序统计量。
    本题中即利用了 $E[X_4 | X_5=x] = x \cdot E[Y_{max}^{(4)}] = x \cdot \frac{4}{5}$。

3.  **易错点**：
    在计算条件期望时，容易混淆积分上限。在给定 $X_5 = x_5$ 的条件下，$X_4$ 的取值范围是 $[0, x_5]$ 而不是 $[0, 1]$。

---
