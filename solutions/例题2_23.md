# 例题2.23

## 题目

甲乙两人在做投硬币游戏。甲以速率为λ1 = 2 的泊松过程投一枚不均匀硬币，其正面向上概 率为 3/4。乙以速率为 λ2 = 3 的泊松过程投一枚不均匀硬币，其正面向上概率为 2/3。两人投硬币的过程相互 独立。求 (1) 甲比乙先投出 1 次正面向上的概率； (2) 甲第 1 次投出正面向上时，乙已经投出正面向上次数的分布； (3) 若甲乙两人共投出5 次正面向上时，游戏结束。求游戏持续时间的期望，以及游戏结束时，两人共投硬 币次数的期望。

## 解答

**Evaluating Problem Components**

Now, I'm examining how to articulate the solutions in a concise, yet informative manner using the principles established. Focusing on LaTeX implementation, I plan to finalize the format to be easy for the end-user to quickly grasp key formulas and results.


### 题目分析

本题主要考察**泊松过程的分解（Thinning）与合成（Superposition）**性质，以及**指数分布的竞争概率**。

1.  **识别参数**：
    *   甲投硬币过程是速率 $\lambda_1=2$ 的泊松过程，正面概率 $p_1=3/4$。
    *   乙投硬币过程是速率 $\lambda_2=3$ 的泊松过程，正面概率 $p_2=2/3$。
2.  **核心概念**：
    *   **分解**：投硬币是泊松过程，出现“正面”也是一个泊松过程，其速率为原速率乘以正面概率。
    *   **合成**：两个独立的泊松过程之和仍为泊松过程，速率为两者之和。
    *   **竞争**：两个独立泊松过程，速率分别为 $\mu_1, \mu_2$，则第一个事件来自过程 1 的概率为 $\frac{\mu_1}{\mu_1+\mu_2}$。
3.  **求解目标**：
    *   (1) 甲的“正面”过程比乙的“正面”过程先发生一次事件的概率。
    *   (2) 在甲第一次“正面”发生时刻，乙已经发生的“正面”次数分布（几何分布变体）。
    *   (3) 两个“正面”过程叠加后，第 5 次事件发生的期望时间，以及在此时间内两个原始投掷过程的总事件数期望。

---

### 解题过程

首先，根据泊松过程的分解性质，我们将“投硬币”过程分解为“投出正面”和“投出反面”两个独立的泊松过程。

设 $N_1(t)$ 为甲投出正面的计数过程，其速率为 $\mu_1$：
$$ \mu_1 = \lambda_1 \cdot p_1 = 2 \times \frac{3}{4} = \frac{3}{2} $$

设 $N_2(t)$ 为乙投出正面的计数过程，其速率为 $\mu_2$：
$$ \mu_2 = \lambda_2 \cdot p_2 = 3 \times \frac{2}{3} = 2 $$

设 $N(t) = N_1(t) + N_2(t)$ 为两人投出正面的总计数过程。根据泊松过程的合成性质，$N(t)$ 是速率为 $\mu$ 的泊松过程：
$$ \mu = \mu_1 + \mu_2 = \frac{3}{2} + 2 = \frac{7}{2} $$

设 $M(t)$ 为两人投硬币的总次数（无论正反）的过程。这也是一个泊松过程，其速率为 $\Lambda$：
$$ \Lambda = \lambda_1 + \lambda_2 = 2 + 3 = 5 $$

#### (1) 甲比乙先投出 1 次正面向上的概率

这等价于在两个独立的泊松过程 $N_1(t)$ 和 $N_2(t)$ 的竞争中，过程 $N_1(t)$ 的第一个事件先于过程 $N_2(t)$ 的第一个事件发生的概率。

根据指数分布的性质，该概率为：
$$ P(\text{甲先正面}) = \frac{\mu_1}{\mu_1 + \mu_2} $$

代入数值：
$$ P = \frac{1.5}{1.5 + 2} = \frac{1.5}{3.5} = \frac{3}{7} $$

#### (2) 甲第 1 次投出正面向上时，乙已经投出正面向上次数的分布

这是一个典型的伯努利试验序列问题。考虑合并后的正面过程 $N(t)$，每一次“正面”事件来自甲的概率为 $p = \frac{\mu_1}{\mu_1+\mu_2} = \frac{3}{7}$，来自乙的概率为 $q = \frac{\mu_2}{\mu_1+\mu_2} = \frac{4}{7}$。

题目要求的是：在出现第 1 次属于甲的事件之前，属于乙的事件发生的次数 $K$。
这服从参数为 $p = \frac{3}{7}$ 的几何分布（定义在 $\{0, 1, 2, \dots\}$ 上，即失败次数的分布）。

设 $K$ 为乙投出正面的次数，则 $P(K=k)$ 表示前 $k$ 次正面都来自乙，第 $k+1$ 次正面来自甲：
$$ P(K=k) = q^k \cdot p = \left( \frac{\mu_2}{\mu_1+\mu_2} \right)^k \frac{\mu_1}{\mu_1+\mu_2}, \quad k = 0, 1, 2, \dots $$

代入数值：
$$ P(K=k) = \left( \frac{4}{7} \right)^k \cdot \frac{3}{7}, \quad k = 0, 1, 2, \dots $$

#### (3) 若甲乙两人共投出 5 次正面向上时，游戏结束

**第一部分：游戏持续时间的期望**

游戏结束时间 $T$ 对应于合并后的正面过程 $N(t)$ 发生第 5 次事件的时间。
由于 $N(t)$ 是速率为 $\mu = 3.5$ 的泊松过程，第 5 次事件到达时间 $T$ 服从爱尔朗分布（Erlang Distribution）或 Gamma 分布 $\Gamma(5, \mu)$。其期望为：
$$ E[T] = \frac{5}{\mu} $$

代入数值：
$$ E[T] = \frac{5}{7/2} = \frac{10}{7} $$

**第二部分：游戏结束时，两人共投硬币次数的期望**

设 $X$ 为游戏结束时两人共投硬币的总次数。
总投币过程 $M(t)$ 是速率为 $\Lambda = 5$ 的泊松过程。
我们需要求 $E[M(T)]$，其中 $T$ 是随机变量（停止时间）。

根据条件期望公式（或瓦尔德等式 Wald's Equation 的变体，针对泊松过程）：
$$ E[X] = E[E[X|T]] = E[\Lambda T] = \Lambda E[T] $$

代入数值：
$$ E[X] = 5 \times \frac{10}{7} = \frac{50}{7} $$

---

### 答案

(1) 甲比乙先投出 1 次正面向上的概率为 $\frac{3}{7}$。

(2) 乙已经投出正面向上次数 $K$ 的分布律为：
$$ P(K=k) = \frac{3}{7} \left( \frac{4}{7} \right)^k, \quad k=0, 1, 2, \dots $$

(3) 游戏持续时间的期望为 $\frac{10}{7}$；两人共投硬币次数的期望为 $\frac{50}{7}$。

---

### 知识延伸

1.  **泊松过程的分解与合成**：
    *   **分解**：速率为 $\lambda$ 的泊松过程，若每个事件以概率 $p$ 被归类为类型 I，则类型 I 事件构成速率为 $\lambda p$ 的泊松过程。
    *   **合成**：速率分别为 $\lambda_1, \lambda_2$ 的独立泊松过程，其并集构成速率为 $\lambda_1+\lambda_2$ 的泊松过程。

2.  **竞争概率公式**：
    *   对于两个独立泊松过程，下一次事件来自过程 1 的概率仅取决于速率比：$P = \frac{\lambda_1}{\lambda_1+\lambda_2}$。这与时间无关，体现了指数分布的**无记忆性**。

3.  **随机和的期望（类 Wald 等式）**：
    *   若 $N(t)$ 是速率为 $\lambda$ 的泊松过程，$T$ 是一个具有有限期望的停时（Stopping Time）或与过程增量独立的随机时间，则 $E[N(T)] = \lambda E[T]$。本题中 $T$ 由另一个相关的泊松过程决定，但对于总投掷过程而言，只要利用条件期望即可推导。

4.  **易错点**：
    *   混淆“投硬币速率” ($\lambda$) 和“投出正面速率” ($\mu$)。解题时必须先计算出有效事件（正面）的速率。
    *   在计算期望时，忘记时间 $T$ 本身是随机变量，直接用 $T$ 的分布公式而非期望公式。

---
