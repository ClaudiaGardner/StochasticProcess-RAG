# 习题4.3

## 题目

设一个更新过程，间隔 $\mathrm{x}$ 服从分布 $\operatorname* {P r} \{X \,=\, 1 \} \,=\, 1 / 2 , \, \, \operatorname* {P r} \{X \,=\, 2 \} \,=\, 1 / 2$ 。画出 $5 ~$ 条计数样本 $N ( t ) , ~ t \leq5$ 。试着讨论 $S_{3}$ 的分布律， $N ( 3 )$ 的分布律。

## 解答

**Calculating $N(3)$ Distribution**

I've been calculating the probability mass function for $N(3)$. I carefully considered the relationship between $N(3)$ and the arrival times, using $P(N(3)=k) = P(S_k \leq 3) - P(S_{k+1} \leq 3)$ to determine the values and verified the resulting probabilities sum to 1. The focus is now on polishing the language and formatting the final answer.


### 题目分析

本题考查**更新过程（Renewal Process）**的基本概念，具体涉及以下核心点：
1.  **更新过程的定义**：由独立同分布（i.i.d.）的非负随机变量序列 $\{X_n, n \ge 1\}$ 构成的随机过程，其中 $X_n$ 表示第 $n-1$ 次与第 $n$ 次事件之间的时间间隔。
2.  **到达时间 $S_n$**：第 $n$ 次事件发生的时刻，即 $S_n = \sum_{i=1}^n X_i$。
3.  **计数过程 $N(t)$**：在时间 $t$ 内发生的事件总数，定义为 $N(t) = \sup\{n : S_n \le t\}$。
4.  **离散型分布的卷积**：求解 $S_n$ 的分布律需要对 $X$ 的分布进行卷积计算。
5.  **$N(t)$ 与 $S_n$ 的关系**：利用等价关系 $\{N(t) \ge n\} \iff \{S_n \le t\}$ 求解 $N(t)$ 的分布。

题目要求画出样本路径并讨论特定变量的分布律，这是理解随机过程样本轨道性质和统计特性的基础练习。

---

### 解题过程

#### 1. 样本路径 $N(t)$ 的模拟与绘制

已知更新间距 $X$ 的分布为：
$$P(X=1) = \frac{1}{2}, \quad P(X=2) = \frac{1}{2}$$

为了画出 $5$ 条计数样本 $N(t)$ ($t \le 5$)，我们需要模拟 $5$ 组随机序列 $\{X_1, X_2, \dots\}$，计算对应的到达时间 $S_n$，直到 $S_n > 5$。$N(t)$ 是一个阶梯函数，在 $S_n$ 处发生跳跃，跳跃高度为 $1$。

**模拟 5 条样本路径如下：**

*   **样本 1**：
    *   序列：$X_1=1, X_2=1, X_3=1, X_4=1, X_5=1$
    *   到达时间：$S_1=1, S_2=2, S_3=3, S_4=4, S_5=5$
    *   $N(t)$ 路径：在 $t=1, 2, 3, 4, 5$ 时刻各跳跃一次。
    *   $N(5)=5$。

*   **样本 2**：
    *   序列：$X_1=2, X_2=2, X_3=2$
    *   到达时间：$S_1=2, S_2=4, S_3=6$
    *   $N(t)$ 路径：在 $t=2, 4$ 时刻各跳跃一次。
    *   $N(5)=2$。

*   **样本 3**：
    *   序列：$X_1=1, X_2=2, X_3=1, X_4=2$
    *   到达时间：$S_1=1, S_2=3, S_3=4, S_4=6$
    *   $N(t)$ 路径：在 $t=1, 3, 4$ 时刻各跳跃一次。
    *   $N(5)=3$。

*   **样本 4**：
    *   序列：$X_1=2, X_2=1, X_3=2, X_4=1$
    *   到达时间：$S_1=2, S_2=3, S_3=5, S_4=6$
    *   $N(t)$ 路径：在 $t=2, 3, 5$ 时刻各跳跃一次。
    *   $N(5)=3$。

*   **样本 5**：
    *   序列：$X_1=1, X_2=1, X_3=2, X_4=1$
    *   到达时间：$S_1=1, S_2=2, S_3=4, S_4=5$
    *   $N(t)$ 路径：在 $t=1, 2, 4, 5$ 时刻各跳跃一次。
    *   $N(5)=4$。

*(注：在实际作图时，横轴为时间 $t$，纵轴为 $N(t)$。图像为右连续阶梯函数，从 0 开始，在每个 $S_n$ 处向上跳变 1 个单位。)*

#### 2. 讨论 $S_3$ 的分布律

$S_3$ 表示第 3 次事件发生的时刻：
$$S_3 = X_1 + X_2 + X_3$$
其中 $X_i \in \{1, 2\}$ 且独立同分布。
我们可以引入辅助变量 $Y_i = X_i - 1$。由于 $P(X_i=1)=P(X_i=2)=1/2$，则 $Y_i$ 服从参数为 $1/2$ 的伯努利分布（即 $Y_i \in \{0, 1\}$，概率各为 $1/2$）。

$$S_3 = (Y_1+1) + (Y_2+1) + (Y_3+1) = \sum_{i=1}^3 Y_i + 3$$

令 $Z = \sum_{i=1}^3 Y_i$。由于 $Y_i$ 独立同分布，故 $Z$ 服从二项分布 $B(3, 1/2)$。
$Z$ 的可能取值为 $0, 1, 2, 3$，对应的概率为：
$$P(Z=k) = \binom{3}{k} \left(\frac{1}{2}\right)^k \left(\frac{1}{2}\right)^{3-k} = \binom{3}{k} \frac{1}{8}$$

因此，$S_3 = Z + 3$ 的取值范围为 $\{3, 4, 5, 6\}$。分布律计算如下：

*   $P(S_3 = 3) = P(Z=0) = \frac{1}{8} \binom{3}{0} = \frac{1}{8}$
*   $P(S_3 = 4) = P(Z=1) = \frac{1}{8} \binom{3}{1} = \frac{3}{8}$
*   $P(S_3 = 5) = P(Z=2) = \frac{1}{8} \binom{3}{2} = \frac{3}{8}$
*   $P(S_3 = 6) = P(Z=3) = \frac{1}{8} \binom{3}{3} = \frac{1}{8}$

#### 3. 讨论 $N(3)$ 的分布律

$N(3)$ 表示在时间 $t=3$ 内发生的事件数。利用基本关系式：
$$P(N(t) = k) = P(S_k \le t < S_{k+1}) = P(S_k \le t) - P(S_{k+1} \le t)$$
在此题中，$t=3$。

**确定 $N(3)$ 的可能取值：**
*   最小事件数：若每次间隔取最大值 $2$，则 $S_1=2, S_2=4$。此时 $N(3)=1$。
*   最大事件数：若每次间隔取最小值 $1$，则 $S_1=1, S_2=2, S_3=3, S_4=4$。此时 $N(3)=3$。
*   因此 $N(3)$ 的可能取值为 $\{1, 2, 3\}$。

**计算各项概率：**

1.  **$k=1$ 的情况**：
    $$P(N(3)=1) = P(S_1 \le 3) - P(S_2 \le 3)$$
    *   $S_1 = X_1$。因 $X_1 \in \{1, 2\}$，故 $P(S_1 \le 3) = 1$。
    *   $S_2 = X_1 + X_2$。$S_2$ 的取值范围为 $\{2, 3, 4\}$。
        *   $S_2=2 \implies (1,1)$，概率 $1/4$
        *   $S_2=3 \implies (1,2), (2,1)$，概率 $2/4$
        *   $S_2=4 \implies (2,2)$，概率 $1/4$
        *   故 $P(S_2 \le 3) = P(S_2=2) + P(S_2=3) = \frac{1}{4} + \frac{2}{4} = \frac{3}{4}$。
    *   **结果**：$P(N(3)=1) = 1 - \frac{3}{4} = \frac{1}{4}$。

2.  **$k=2$ 的情况**：
    $$P(N(3)=2) = P(S_2 \le 3) - P(S_3 \le 3)$$
    *   已知 $P(S_2 \le 3) = \frac{3}{4}$。
    *   $S_3$ 的分布律已在上一部分求得：$P(S_3=3)=1/8$，其余值均大于3。
    *   故 $P(S_3 \le 3) = P(S_3=3) = \frac{1}{8}$。
    *   **结果**：$P(N(3)=2) = \frac{3}{4} - \frac{1}{8} = \frac{6}{8} - \frac{1}{8} = \frac{5}{8}$。

3.  **$k=3$ 的情况**：
    $$P(N(3)=3) = P(S_3 \le 3) - P(S_4 \le 3)$$
    *   已知 $P(S_3 \le 3) = \frac{1}{8}$。
    *   $S_4 = S_3 + X_4$. 由于 $S_3 \ge 3$ 且 $X_4 \ge 1$，则 $S_4 \ge 4$。
    *   故 $P(S_4 \le 3) = 0$。
    *   **结果**：$P(N(3)=3) = \frac{1}{8} - 0 = \frac{1}{8}$。

**验证**：
总概率 $\sum P(N(3)=k) = \frac{1}{4} + \frac{5}{8} + \frac{1}{8} = \frac{2+5+1}{8} = 1$。计算无误。

---

### 答案

1.  **样本路径**：见解题过程中的 5 组模拟数据及描述。
2.  **$S_3$ 的分布律**：
    $$
    P(S_3 = k) = \begin{cases}
    1/8, & k=3 \\
    3/8, & k=4 \\
    3/8, & k=5 \\
    1/8, & k=6 \\
    0, & \text{其他}
    \end{cases}
    $$
3.  **$N(3)$ 的分布律**：
    $$
    P(N(3) = k) = \begin{cases}
    1/4, & k=1 \\
    5/8, & k=2 \\
    1/8, & k=3 \\
    0, & \text{其他}
    \end{cases}
    $$

---

### 知识延伸

1.  **核心定理**：
    *   **$N(t)$ 与 $S_n$ 的关系**：$\{N(t) \ge n\} \iff \{S_n \le t\}$。这是处理更新过程计数分布最关键的桥梁。
    *   **分布函数关系**：$P(N(t)=n) = F_{S_n}(t) - F_{S_{n+1}}(t)$，其中 $F_{S_n}$ 是 $S_n$ 的累积分布函数。

2.  **重要公式**：
    *   更新方程（Renewal Equation）：$m(t) = F(t) + \int_0^t m(t-x) dF(x)$，其中 $m(t) = E[N(t)]$ 是更新函数。
    *   对于离散情况，若 $X_i$ 服从几何分布，则该过程变为伯努利过程；若 $X_i$ 服从指数分布，则变为泊松过程。本题是更一般的离散更新过程。

3.  **解题技巧与易错点**：
    *   **边界条件**：在计算 $P(N(t)=k)$ 时，务必注意不等式的严格性（$S_k \le t < S_{k+1}$）。
    *   **卷积计算**：计算 $S_n$ 的分布时，如果是离散均匀分布或简单的二值分布，利用二项分布变换通常比直接卷积更高效。
    *   **取值范围**：在列举 $N(t)$ 的可能取值时，要根据 $X$ 的最小值和最大值来确定 $N(t)$ 的上下界，避免遗漏或多算。

---
