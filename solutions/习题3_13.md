# 习题3.13

## 题目

N 个总体中的任一个个体在每个时可能极也可能消极。如果一个个体在某时段积极，那么与所有其他个体独立。他在下一个时也积极的概率是 $\alpha$ 。类似地，如果一个个体在某时段消极，那么与所有其他个体独立， 他在下一个时段也消积的概率是 $\beta$ 。令 $\mathrm{X}_{n}$ 表在时段 $n$ 积极的个体数 (a)证明 $\{X_{n} , \; \; n \geq0 \}$ 是马尔可夫链 (b)求 $\operatorname{E} [ X_{n} | X_{0}=i ]$ (c)推导转移概率得表达式 (d）求恰有 $j$ 个个体积极的长程时间比例。提示:首先考 $N=1$ 的情形

## 解答

**Revising Solution Approach**

I'm now focusing on refining the solution process.  Specifically, I'm verifying the independence argument for the stationary distribution, and double-checking that the binomial convolution in part (c) is properly formulated and written up. Also, ensuring that all LaTeX commands are correctly embedded for a readable output.


### 题目分析

本题考察的是**离散时间马尔可夫链（DTMC）**的建模与性质分析。
1.  **系统模型**：由 $N$ 个相互独立的个体组成，每个个体的状态在“积极”与“消极”之间按给定概率转移。
2.  **核心变量**：$X_n$ 表示时刻 $n$ 处于“积极”状态的个体总数。
3.  **数学工具**：
    *   马尔可夫性的定义。
    *   二项分布（Binomial Distribution）及其卷积。
    *   条件期望与线性递推关系。
    *   马尔可夫链的平稳分布（Stationary Distribution）。
4.  **求解目标**：证明马尔可夫性、计算条件期望、推导转移概率矩阵、求解平稳分布。

---

### 解题过程

#### (a) 证明 $\{X_{n} , \; n \geq 0 \}$ 是马尔可夫链

根据定义，若随机过程 $\{X_n\}$ 满足马尔可夫性，即对于任意 $n$ 和状态 $i, j, x_{n-1}, \dots, x_0$，有：
$$P(X_{n+1} = j \mid X_n = i, X_{n-1} = x_{n-1}, \dots, X_0 = x_0) = P(X_{n+1} = j \mid X_n = i)$$

**证明：**
假设在时刻 $n$，处于积极状态的个体数为 $X_n = i$。这意味着有 $i$ 个个体处于积极状态，有 $N-i$ 个个体处于消极状态。
根据题目描述：
1.  这 $i$ 个积极个体在时刻 $n+1$ 保持积极的概率为 $\alpha$，且相互独立。设 $Y_{n+1}$ 为这 $i$ 个体中在 $n+1$ 时刻仍积极的人数，则 $Y_{n+1}$ 服从二项分布 $B(i, \alpha)$。
2.  剩下的 $N-i$ 个消极个体在时刻 $n+1$ 变为积极的概率为 $1-\beta$（因为保持消极的概率是 $\beta$），且相互独立。设 $Z_{n+1}$ 为这 $N-i$ 个体中在 $n+1$ 时刻变为积极的人数，则 $Z_{n+1}$ 服从二项分布 $B(N-i, 1-\beta)$。
3.  时刻 $n+1$ 的总积极人数 $X_{n+1}$ 为：
    $$X_{n+1} = Y_{n+1} + Z_{n+1}$$

由于 $Y_{n+1}$ 和 $Z_{n+1}$ 的分布参数仅取决于 $i$（即 $X_n$ 的值）以及常数 $N, \alpha, \beta$，而与 $n$ 之前的状态无关。因此，$X_{n+1}$ 的条件分布仅依赖于 $X_n$。
故 $\{X_n, n \geq 0\}$ 是一个马尔可夫链。

#### (b) 求 $\operatorname{E} [ X_{n} | X_{0}=i ]$

利用期望的线性性质，我们可以先考虑单个个体的状态转移。
设 $I_k^{(n)}$ 为第 $k$ 个个体在时刻 $n$ 的状态指示变量：
$$I_k^{(n)} = \begin{cases} 1, & \text{若个体 } k \text{ 在时刻 } n \text{ 积极} \\ 0, & \text{若个体 } k \text{ 在时刻 } n \text{ 消极} \end{cases}$$
则 $X_n = \sum_{k=1}^N I_k^{(n)}$。
由期望的线性性质：
$$\operatorname{E}[X_n \mid X_0 = i] = \sum_{k=1}^N P(\text{个体 } k \text{ 在 } n \text{ 时刻积极} \mid X_0 = i)$$

考虑单个个体的状态概率。设 $p_n$ 为某特定个体在时刻 $n$ 积极的概率。
$$p_{n+1} = P(\text{积极} \to \text{积极}) p_n + P(\text{消极} \to \text{积极}) (1-p_n)$$
$$p_{n+1} = \alpha p_n + (1-\beta)(1-p_n) = (\alpha + \beta - 1)p_n + (1-\beta)$$
这是一个一阶线性差分方程。令 $\lambda = \alpha + \beta - 1$。
$$p_{n+1} = \lambda p_n + (1-\beta)$$
求不动点（稳态概率）$p^*$：
$$p^* = \lambda p^* + (1-\beta) \implies p^* = \frac{1-\beta}{1-\lambda} = \frac{1-\beta}{1 - (\alpha + \beta - 1)} = \frac{1-\beta}{2 - \alpha - \beta}$$
方程的通解为：
$$p_n = p^* + (p_0 - p^*) \lambda^n$$

现在回到 $N$ 个个体：
1.  对于初始处于积极状态的 $i$ 个个体，其 $p_0 = 1$。它们在时刻 $n$ 积极的概率为：
    $$p_n^{(1)} = \frac{1-\beta}{2-\alpha-\beta} + \left(1 - \frac{1-\beta}{2-\alpha-\beta}\right)(\alpha+\beta-1)^n$$
2.  对于初始处于消极状态的 $N-i$ 个个体，其 $p_0 = 0$。它们在时刻 $n$ 积极的概率为：
    $$p_n^{(0)} = \frac{1-\beta}{2-\alpha-\beta} + \left(0 - \frac{1-\beta}{2-\alpha-\beta}\right)(\alpha+\beta-1)^n$$

因此，
$$\begin{aligned} \operatorname{E}[X_n \mid X_0 = i] &= i \cdot p_n^{(1)} + (N-i) \cdot p_n^{(0)} \\ &= i \left[ p^* + (1-p^*)\lambda^n \right] + (N-i) \left[ p^* - p^*\lambda^n \right] \\ &= (i + N - i) p^* + i(1-p^*)\lambda^n - (N-i)p^*\lambda^n \\ &= N p^* + (i - i p^* - N p^* + i p^*) \lambda^n \\ &= N p^* + (i - N p^*) \lambda^n \end{aligned}$$

代入 $p^* = \frac{1-\beta}{2-\alpha-\beta}$ 和 $\lambda = \alpha+\beta-1$，得：
$$\operatorname{E}[X_n \mid X_0 = i] = \frac{N(1-\beta)}{2-\alpha-\beta} + \left( i - \frac{N(1-\beta)}{2-\alpha-\beta} \right) (\alpha+\beta-1)^n$$

#### (c) 推导转移概率表达式

转移概率 $P_{ij} = P(X_{n+1} = j \mid X_n = i)$。
如 (a) 中所述，$X_{n+1}$ 是两个独立随机变量的和：
$$X_{n+1} = Y + Z$$
其中 $Y \sim B(i, \alpha)$ 表示原积极者保持积极的人数，$Z \sim B(N-i, 1-\beta)$ 表示原消极者转为积极的人数。
我们需要 $Y + Z = j$。根据全概率公式（卷积公式）：
$$P_{ij} = \sum_{k} P(Y=k) P(Z=j-k)$$
求和范围为 $k$ 的所有可能取值。
$Y$ 的取值范围是 $0 \le k \le i$。
$Z$ 的取值范围是 $0 \le j-k \le N-i \implies k \le j$ 且 $k \ge j - (N-i)$。
综合得：$\max(0, j-(N-i)) \le k \le \min(i, j)$。

表达式为：
$$P_{ij} = \sum_{k=\max(0, j-(N-i))}^{\min(i, j)} \left[ \binom{i}{k} \alpha^k (1-\alpha)^{i-k} \right] \cdot \left[ \binom{N-i}{j-k} (1-\beta)^{j-k} \beta^{(N-i)-(j-k)} \right]$$

#### (d) 求恰有 $j$ 个个体积极的长程时间比例

长程时间比例即马尔可夫链的平稳分布（Stationary Distribution），记为 $\pi_j = \lim_{n \to \infty} P(X_n = j)$。
假设 $0 < \alpha, \beta < 1$，该链是遍历的。
由于 $N$ 个个体是相互独立的，且每个个体在 $n \to \infty$ 时处于积极状态的概率都趋向于同一个稳态概率 $p^*$（见 (b) 部分的推导）：
$$p^* = \frac{1-\beta}{2-\alpha-\beta}$$
因此，当 $n \to \infty$ 时，系统状态等价于进行 $N$ 次独立的伯努利试验，每次成功的概率为 $p^*$。
所以，$X_{\infty}$ 服从参数为 $(N, p^*)$ 的二项分布。

恰有 $j$ 个个体积极的概率为：
$$\pi_j = \binom{N}{j} (p^*)^j (1-p^*)^{N-j}$$
代入 $p^*$ 的表达式：
$$\pi_j = \binom{N}{j} \left( \frac{1-\beta}{2-\alpha-\beta} \right)^j \left( \frac{1-\alpha}{2-\alpha-\beta} \right)^{N-j}, \quad j=0, 1, \dots, N$$
注意：$1-p^* = 1 - \frac{1-\beta}{2-\alpha-\beta} = \frac{2-\alpha-\beta - (1-\beta)}{2-\alpha-\beta} = \frac{1-\alpha}{2-\alpha-\beta}$。

---

### 答案

(a) 证明见解题过程。$X_{n+1}$ 的分布仅依赖于 $X_n$ 的值，满足马尔可夫性。

(b) 条件期望为：
$$ \operatorname{E} [ X_{n} | X_{0}=i ] = \frac{N(1-\beta)}{2-\alpha-\beta} + \left( i - \frac{N(1-\beta)}{2-\alpha-\beta} \right) (\alpha+\beta-1)^n $$

(c) 转移概率 $P_{ij}$ 为：
$$ P_{ij} = \sum_{k=\max(0, j-(N-i))}^{\min(i, j)} \binom{i}{k} \alpha^k (1-\alpha)^{i-k} \binom{N-i}{j-k} (1-\beta)^{j-k} \beta^{N-i-j+k} $$

(d) 恰有 $j$ 个个体积极的长程时间比例为：
$$ \pi_j = \binom{N}{j} \left( \frac{1-\beta}{2-\alpha-\beta} \right)^j \left( \frac{1-\alpha}{2-\alpha-\beta} \right)^{N-j}, \quad j=0, 1, \dots, N $$

---

### 知识延伸

1.  **独立性与聚合**：本题展示了一个重要性质，即 $N$ 个独立的马尔可夫链的聚合（和）仍然构成一个马尔可夫链。如果个体之间不独立（例如传染病模型），则 $X_n$ 通常不再是马尔可夫链，需要更高维的状态空间。
2.  **二项分布的卷积**：两个独立二项分布变量的和一般不是二项分布，除非它们的成功概率参数 $p$ 相同。在本题的转移过程中，由于 $\alpha \neq 1-\beta$，一步转移后的分布是两个不同参数二项分布的卷积（广义超几何分布的一种形式），但在平稳状态下（$n \to \infty$），所有个体同分布，总和回归到二项分布。
3.  **埃伦费斯特模型（Ehrenfest Model）**：此模型是物理学中气体扩散模型的推广。当 $\alpha = 1 - \frac{1}{N}$ 且 $\beta = 1 - \frac{1}{N}$ 时，它近似于经典的埃伦费斯特瓮模型（Ehrenfest Urn Model）。
4.  **解题技巧**：处理粒子系统问题时，利用**指示变量法**（Indicator Variables）和期望的线性性质通常比直接处理组合数更高效，尤其是在计算期望和方差时。

---
