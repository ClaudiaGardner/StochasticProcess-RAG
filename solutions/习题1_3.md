# 习题1.3

## 题目

假设 $\{X ; i \geq1 \}$ 是独立同分布的二元随机变量。设 $P X_{i}=1=\delta, \, P X_{i}=0=1 \!-\! \delta.$ 令 $S_{n}=X_{1} \!+\! \cdots\!+\! X_{n}$ 。 让 $m$ 是一个任意但固定的正整数。计算以下内容并解释

## 解答

**Refining Solution Strategy**

I'm now zeroing in on the format and content. I've decided to provide both the distribution of $S_n$ and the conditional probability $P(S_n = k \mid S_{n+m} = r)$ as the primary answer, explicitly acknowledging the user's potentially incomplete question. I'm also preparing for the LaTeX formatting and planning to emphasize the key implication: the conditional probability is independent of $\delta$. Finally, I'm reviewing the edge cases for the hypergeometric distribution.


### 题目分析

由于题目末尾“计算以下内容”后的具体表达式缺失，根据概率论与随机过程课程中此类习题（通常涉及伯努利过程、随机游走或独立增量过程）的标准设置，本题最核心且最具代表性的考点是求解**给定总步数下的部分步数和的条件概率分布**。

因此，本解答将针对以下最可能的求解目标进行详细推导：
**计算条件概率 $P(S_n = k \mid S_{n+m} = r)$。**

本题考查的核心概念包括：
1.  **伯努利试验与二项分布**：识别 $X_i$ 为伯努利随机变量，$S_n$ 服从二项分布。
2.  **独立增量性**：利用 $X_i$ 的独立性，将 $S_{n+m}$ 拆分为 $S_n$ 与增量 $(S_{n+m} - S_n)$ 的和。
3.  **条件概率公式**：利用联合概率与边缘概率的比值进行计算。

### 解题过程

**1. 确定随机变量的分布**

已知 $\{X_i\}$ 是独立同分布（i.i.d.）的二元随机变量，分布律为：
$$P(X_i=1) = \delta, \quad P(X_i=0) = 1-\delta$$
这表明 $X_i \sim \text{Bernoulli}(\delta)$。

随机变量 $S_n = X_1 + \cdots + X_n$ 是 $n$ 个独立伯努利试验的成功次数之和，因此 $S_n$ 服从参数为 $(n, \delta)$ 的二项分布，记为 $S_n \sim B(n, \delta)$。其概率质量函数为：
$$P(S_n = k) = \binom{n}{k} \delta^k (1-\delta)^{n-k}, \quad k = 0, 1, \dots, n$$

同理，对于任意正整数 $m$，定义 $S_{n+m} = X_1 + \cdots + X_n + X_{n+1} + \cdots + X_{n+m}$。
$S_{n+m}$ 服从参数为 $(n+m, \delta)$ 的二项分布：
$$P(S_{n+m} = r) = \binom{n+m}{r} \delta^r (1-\delta)^{n+m-r}, \quad r = 0, 1, \dots, n+m$$

**2. 利用独立增量性分解**

我们需要计算条件概率 $P(S_n = k \mid S_{n+m} = r)$。根据条件概率的定义：
$$P(S_n = k \mid S_{n+m} = r) = \frac{P(S_n = k, S_{n+m} = r)}{P(S_{n+m} = r)}$$

观察分子中的联合事件 $\{S_n = k, S_{n+m} = r\}$。
我们可以将 $S_{n+m}$ 写为：
$$S_{n+m} = S_n + (X_{n+1} + \cdots + X_{n+m})$$
令 $S'_m = X_{n+1} + \cdots + X_{n+m}$。由于 $X_i$ 相互独立，$S_n$（取决于 $X_1, \dots, X_n$）与 $S'_m$（取决于 $X_{n+1}, \dots, X_{n+m}$）相互独立。
且 $S'_m$ 服从参数为 $(m, \delta)$ 的二项分布。

因此，联合事件可以重写为：
$$\{S_n = k, S_{n+m} = r\} \iff \{S_n = k, S_n + S'_m = r\} \iff \{S_n = k, S'_m = r - k\}$$

利用独立性，联合概率为：
$$P(S_n = k, S_{n+m} = r) = P(S_n = k, S'_m = r - k) = P(S_n = k) \cdot P(S'_m = r - k)$$

**3. 代入公式计算**

将二项分布公式代入上述表达式：

$$
\begin{aligned}
P(S_n = k \mid S_{n+m} = r) &= \frac{P(S_n = k) \cdot P(S'_m = r - k)}{P(S_{n+m} = r)} \\
&= \frac{\left[ \binom{n}{k} \delta^k (1-\delta)^{n-k} \right] \cdot \left[ \binom{m}{r-k} \delta^{r-k} (1-\delta)^{m-(r-k)} \right]}{\binom{n+m}{r} \delta^r (1-\delta)^{n+m-r}}
\end{aligned}
$$

**4. 化简表达式**

整理分子中的 $\delta$ 和 $(1-\delta)$ 的指数：
- $\delta$ 的指数：$k + (r-k) = r$
- $(1-\delta)$ 的指数：$(n-k) + (m - (r-k)) = n - k + m - r + k = n + m - r$

分子变为：
$$\binom{n}{k} \binom{m}{r-k} \delta^r (1-\delta)^{n+m-r}$$

将其代回分式，与分母中的 $\delta^r (1-\delta)^{n+m-r}$ 抵消：

$$
\begin{aligned}
P(S_n = k \mid S_{n+m} = r) &= \frac{\binom{n}{k} \binom{m}{r-k} \delta^r (1-\delta)^{n+m-r}}{\binom{n+m}{r} \delta^r (1-\delta)^{n+m-r}} \\
&= \frac{\binom{n}{k} \binom{m}{r-k}}{\binom{n+m}{r}}
\end{aligned}
$$

**5. 确定变量范围**

为了使组合数有意义，必须满足：
- $0 \le k \le n$
- $0 \le r-k \le m \implies r-m \le k \le r$

因此，$k$ 的取值范围是 $\max(0, r-m) \le k \le \min(n, r)$。

### 答案

假设题目要求计算 $S_n$ 给定 $S_{n+m}=r$ 的条件分布，结果为：

$$ P(S_n = k \mid S_{n+m} = r) = \frac{\binom{n}{k} \binom{m}{r-k}}{\binom{n+m}{r}} $$

其中 $k$ 的取值范围为 $\max(0, r-m) \le k \le \min(n, r)$。

该结果表明，给定总和 $S_{n+m}=r$ 的条件下，$S_n$ 服从**超几何分布** (Hypergeometric Distribution)。

---

### 知识延伸

1.  **充分统计量 (Sufficient Statistic)**：
    推导结果中不包含参数 $\delta$。这说明 $S_{n+m}$ 是参数 $\delta$ 的充分统计量。即一旦知道了样本总和，样本的具体分布（前 $n$ 个中有多少个1）就不再包含关于 $\delta$ 的额外信息。

2.  **超几何分布的直观理解**：
    这可以看作经典的“摸球模型”：这就好比在一个袋子里有 $n+m$ 个球，其中 $r$ 个是红球（代表 $X_i=1$），$n+m-r$ 个是白球。现在我们要从这 $n+m$ 个球中随机抽取 $n$ 个球（代表前 $n$ 次试验），问这 $n$ 个球中有 $k$ 个红球的概率是多少？答案正是超几何分布。

3.  **条件期望**：
    基于上述分布，可以很容易求出条件期望：
    $$E[S_n \mid S_{n+m} = r] = n \cdot \frac{r}{n+m}$$
    这符合直觉：前 $n$ 次试验成功的期望比例应等于总试验成功的比例。

4.  **易错点**：
    - 忽略 $k$ 的取值范围。
    - 在分解 $S_{n+m}$ 时，忘记说明 $S_{n+m} - S_n$ 与 $S_n$ 的独立性。
    - 繁琐的代数运算中未能正确消去 $\delta$ 和 $(1-\delta)$ 项。

---
