# 例题0.4

## 题目

把 n 个球扔进M 个箱子，分析如下试验的样本空间的大小。 （1）球可区分，箱子可区分，不限箱内球数； （2）球不可区分，箱子可区分，不限箱内球数； （3）球可区分，箱子可区分，箱内球数不超过 1； （4）球不可区分，箱子可区分，箱内球数不超过 1； （5）球不可区分，箱子不可区分，箱内球数不限。 0.1.2 概率的基本运算律 在概率中，我们有以下运算法则： 1. 加法：对于事件A，B， • P(A SB) = P(A) + P(B) − P(AB)；P(A SB) ≤ P(A) + P(B)。 • 若A 与 B 不相容，则 P(A SB) = P(A) + P(B)（分类） 。 • 容斥定理：若事件集 A1，· · ·，An 为有限集，则有 P{∪n i=1Ai} = nX i=1 P{Ai} − X 1≤i<j≤n P{Ai ∩ Aj} + X 1≤i<j<k≤n P{Ai ∩ Aj ∩ Ak} − · · · + (−1)n−1P{A1 ∩ · · · ∩ An}。 2. 乘法： • 条件概率定义：设A 与B 为样本空间Ω 中的两个事件，其中P{A} > 0。那么在事件A 发生的条件下，事 件B 发生的条件概率为： P(B|A) = P(AB) P(A) ； • P(AB) = P(B|A)P(A)；若 A 与B 相互独立，则 P(AB) = P(A)P(B)； • 链式法则：P(A1A2 . . . An) = P(A1)P(A2|A1) · · ·P(An|A1A2...An−1)； 2 0.1. 概率论的基本概念 • 多事件独立的定义：设有 A1，A2，. . . ，An(n ≥ 2) 个事件，如果其中任意 k (2 ≤ k ≤ n) 个事件的积事 件的概率都等于各事件概率之积，即 P(Ai1 Ai2 · · ·Aik ) = kY j=1 P(Aij )， 对于所有1 ≤ i1 < i2 < · · · < ik ≤ n 均成立，则称它们相互独立。 3. 减法： • P( ¯A) = 1 − P(A)； • P(A − B) = P(A) − P(AB)。 4. 全概率公式：若 Bi 是样本空间 Ω 的划分，则有P(A) = P i P(Bi)P(A|Bi)（分类、分步） 。 5. 贝叶斯公式：P(Bi|A) = P(Bi)P(A|Bi) P(A) = P(Bi)P(A|Bi)P j P(Bj)P(A|Bj) 。 贝叶斯分析在工程中有广泛的应用背景。我们可以把 Bi 视作引起 A 发生的原因，P(Bi) 称之为先验概率， 而 P(Bi|A) 是后验概率，反映事件 A 对于 Bi 概率的影响。条件概率 P(A|Bi) 通常称为似然概率，是“由因及 果” ，而贝叶斯公式计算的后验概率是“由果及因” ，是概率推断的重要工具。在实际应用中，我们通常可以借 助图模型来分析复杂的概率问题，概率树可以用来描述“分类”与“分步” ： “分类”用“分支” ， “分步”用“分 节” 。从根节点（全集，或者说“必然事件” ）开始做划分，随着树的生长，划分得越来越细。每个子节点是父节 点的子事件，所有子节点划分（不重不漏）它们的父节点。根节点的概率是1。每条分支有个权重，对应给定父 节点条件下相应子节点发生的概率。因此，从一个节点出发的各个分支的权重之和为1。某个节点的概率是从根 节点到达该节点的路径的概率，而该概率是边概率的连乘积。一个子树的概率是该子树所有叶子对应的概率的 和，这个子树的概率是等于该子树的根节点的概率的。在概率树中，一个节点的概率既可以由其父亲节点通过 一次乘法算得（由上至下） ，也可以由其儿子节点通过加法算得（由下至上） 。有些问题在题目中描述比较直接， 有些需要自己提炼，整理出“概率树” ，不同的“概率树”对应不同的概率模型。

## 解答

**Refining Case Five Logic**

\n\n

I've been meticulously re-evaluating Case 5, the most challenging scenario. Initially, I recognized it as an integer partition problem, but now I'm clarifying the explanation to emphasize the lack of a simple closed-form solution. I'll explicitly mention partitioning the integer *n* into at most *M* parts and using the appropriate notation, ensuring precision for my audience. This is vital given the context.


### 题目分析

本题考查概率论基础中的**样本空间计数问题**，本质上属于**组合数学（Combinatorics）**中的“球盒模型”（Balls and Bins）。题目要求计算在不同约束条件下，将 $n$ 个球放入 $M$ 个箱子中的所有可能结果的数量（即样本空间 $|\Omega|$ 的大小）。

核心概念涉及：
1.  **乘法原理**：分步计数。
2.  **排列（Permutation）**：有序选择。
3.  **组合（Combination）**：无序选择。
4.  **隔板法（Stars and Bars）**：处理不可区分物体的分配问题。
5.  **整数分拆（Integer Partition）**：处理全不可区分问题。

需要求解的目标是针对五种不同情况，给出样本空间大小的数学表达式。

---

### 解题过程

我们将 $n$ 个球放入 $M$ 个箱子，根据球和箱子的可区分性及容量限制，分别讨论。

#### （1）球可区分，箱子可区分，不限箱内球数

这是一个典型的分步计数问题（Maxwell-Boltzmann 统计模型背景）。
对于每一个球，都有 $M$ 个箱子可以选择。
- 第 1 个球有 $M$ 种选择；
- 第 2 个球有 $M$ 种选择；
- ...
- 第 $n$ 个球有 $M$ 种选择。

根据乘法原理，样本空间的大小为：
$$|\Omega_1| = \underbrace{M \times M \times \cdots \times M}_{n \text{ times}} = M^n$$

#### （2）球不可区分，箱子可区分，不限箱内球数

这是一个将 $n$ 个相同元素分成 $M$ 组的问题（Bose-Einstein 统计模型背景）。我们可以使用**隔板法（Stars and Bars）**。
我们需要将 $n$ 个球（视为 $*$）和 $M-1$ 个隔板（视为 $|$）进行排列。隔板将球分成了 $M$ 个区域，对应 $M$ 个箱子。
总共有 $n + (M-1)$ 个位置，我们需要从中选择 $n$ 个位置放球（或者选择 $M-1$ 个位置放隔板）。

样本空间的大小为组合数：
$$|\Omega_2| = \binom{n+M-1}{n} = \binom{n+M-1}{M-1}$$

#### （3）球可区分，箱子可区分，箱内球数不超过 1

由于箱内球数不超过 1，这就要求 $n \le M$（否则样本空间大小为 0）。
这是一个从 $M$ 个不同箱子中选出 $n$ 个箱子，并将 $n$ 个不同球放入其中的问题。这等价于从 $M$ 个元素中取出 $n$ 个元素进行**排列**。

- 第 1 个球有 $M$ 种选择；
- 第 2 个球有 $M-1$ 种选择；
- ...
- 第 $n$ 个球有 $M-n+1$ 种选择。

样本空间的大小为排列数：
$$|\Omega_3| = P(M, n) = A_M^n = \frac{M!}{(M-n)!}$$
*(注：若 $n > M$，则 $|\Omega_3| = 0$)*

#### （4）球不可区分，箱子可区分，箱内球数不超过 1

同样要求 $n \le M$（Fermi-Dirac 统计模型背景）。
由于球不可区分，我们只需要决定哪 $n$ 个箱子被占用，而不关心哪个球在哪个箱子里。
这等价于从 $M$ 个不同箱子中选出 $n$ 个箱子进行**组合**。

样本空间的大小为组合数：
$$|\Omega_4| = \binom{M}{n} = C_M^n = \frac{M!}{n!(M-n)!}$$
*(注：若 $n > M$，则 $|\Omega_4| = 0$)*

#### （5）球不可区分，箱子不可区分，箱内球数不限

当球和箱子都不可区分时，问题转化为**整数分拆（Integer Partition）**问题。
我们要将整数 $n$ 分拆成 $k$ 个整数的和（$n = x_1 + x_2 + \cdots + x_k$），其中 $1 \le k \le M$（因为最多只能用 $M$ 个箱子，且空箱子不可区分，不影响结果）。
或者更准确地说，这是将整数 $n$ 分拆成**至多** $M$ 个部分的分拆数。

设 $p_k(n)$ 为将 $n$ 分拆成恰好 $k$ 个部分的方案数，则样本空间大小为：
$$|\Omega_5| = \sum_{k=1}^{\min(n, M)} p_k(n)$$
通常记作 $p_M(n)$（将 $n$ 分拆成不超过 $M$ 个部分的方案数）。

此类问题**没有简单的封闭形式（Closed-form expression）**，通常通过递归公式或生成函数求解。
递归关系为：$P(n, M) = P(n, M-1) + P(n-M, M)$，其中 $P(n, M)$ 表示将 $n$ 划分为至多 $M$ 份的方法数。

---

### 答案

1.  **球可区分，箱可区分，无限制**：
    $$M^n$$
2.  **球不可区分，箱可区分，无限制**：
    $$\binom{n+M-1}{n}$$
3.  **球可区分，箱可区分，容量 $\le 1$**：
    $$\frac{M!}{(M-n)!}$$
4.  **球不可区分，箱可区分，容量 $\le 1$**：
    $$\binom{M}{n}$$
5.  **球不可区分，箱不可区分，无限制**：
    $$p_M(n) \quad (\text{整数 } n \text{ 分拆成至多 } M \text{ 个部分的数目})$$

---

### 知识延伸

1.  **物理统计模型对应**：
    *   **Maxwell-Boltzmann 统计**：对应情形（1），适用于经典粒子（如气体分子）。
    *   **Bose-Einstein 统计**：对应情形（2），适用于玻色子（如光子），粒子不可区分且占据同一量子态无限制。
    *   **Fermi-Dirac 统计**：对应情形（4），适用于费米子（如电子），粒子不可区分且遵循泡利不相容原理（每态至多一个粒子）。

2.  **第二类斯特林数（Stirling Numbers of the Second Kind）**：
    *   如果题目改为“球可区分，箱子**不可**区分，无限制”，则涉及第二类斯特林数 $S(n, k)$。公式为 $\sum_{k=1}^M S(n, k)$。

3.  **常见易错点**：
    *   混淆排列与组合：关键在于“球是否可区分”以及“放入的顺序是否重要”。
    *   隔板法的应用条件：必须是“球不可区分，箱子可区分”。
    *   对于情形（5），初学者常试图寻找简单的阶乘公式，需明确整数分拆通常没有简单的初等函数表达式。

---
