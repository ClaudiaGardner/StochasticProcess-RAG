# 例题3.17

## 题目

考虑一个具有一个常返类的马尔可夫链，该常返类包含r 个状态，记为{1，2，. . . ，r}，并 且还有M − r 个其他瞬态状态。证明对于所有 j ≤ r 和n ≥ (r − 1)2 + 1 + M − r，有 Pn ij > 0。

## 解答

**Proof Construction Begins**

The analysis of the problem statement is complete, leading to a structured proof. It requires a formal approach, using Wielandt's theorem and careful consideration of transient states. I'm focusing on ensuring all conditions are met, especially the aperiodicity of the recurrent class and the correct bounds for the paths. Finally, I will write the final solution in the format requested, and begin checking for any implicit assumptions.


### 题目分析

本题考查有限状态马尔可夫链的**遍历性**、**不可约性**以及**本原矩阵（Primitive Matrix）的指数界**。
题目中定义了一个包含 $M$ 个状态的马尔可夫链，分为两部分：
1.  一个大小为 $r$ 的常返类（Recurrent Class），记为 $R = \{1, 2, \dots, r\}$。由于题目指出是“一个”常返类，且要求 $P_{ij}^n > 0$ 对所有大的 $n$ 成立，隐含了该常返类是**不可约且非周期（Aperiodic）**的假设（即其转移矩阵限制在 $R$ 上是本原的）。
2.  其余 $M-r$ 个为瞬态状态（Transient States），记为 $T = \{r+1, \dots, M\}$。

**求解目标**：证明对于任意起始状态 $i$（隐含在题目语境中，通常指任意状态）和目标状态 $j \in R$，当步数 $n$ 满足 $n \ge (r-1)^2 + 1 + M - r$ 时，转移概率 $P_{ij}^n > 0$。

---

### 解题过程

我们将证明分为两个部分：首先考虑常返类内部的转移，利用本原矩阵的性质；其次考虑从瞬态状态进入常返类的过程。

#### 1. 常返类内部的转移分析

设 $P$ 为该马尔可夫链的转移矩阵。考虑限制在常返类 $R$ 上的子矩阵，记为 $A$。$A$ 是一个 $r \times r$ 的矩阵。
由于 $R$ 是一个不可约的常返类，且为了保证对于所有充分大的 $n$，概率严格大于 0（而不是因为周期性导致某些步数为 0），我们必须假设 $A$ 是**本原矩阵**（即 $A$ 不可约且非周期）。

根据 **Wielandt 定理 (1950)**，对于一个 $r$ 阶的非负本原矩阵 $A$，其本原指数（index of primitivity）$\gamma(A)$ 满足：
$$ \gamma(A) \le (r-1)^2 + 1 $$
这意味着，对于任意 $k \ge (r-1)^2 + 1$，矩阵 $A^k$ 的所有元素都严格大于 0。
即，对于任意 $u, v \in R$，只要步数 $k$ 满足条件，就有：
$$ P_{uv}^k > 0, \quad \forall k \ge (r-1)^2 + 1 $$

#### 2. 从瞬态状态到常返类的转移分析

若起始状态 $i$ 属于瞬态集合 $T$（即 $i > r$），由于 $R$ 是唯一的常返类，从 $i$ 出发最终必然会进入 $R$。
考虑从 $i$ 到达 $R$ 中任意状态的最短路径。在最坏的情况下，该路径可能会经过 $T$ 中的所有其他瞬态状态。
由于 $T$ 中共有 $M-r$ 个状态，从 $i \in T$ 到达某个状态 $k \in R$ 的路径中，经过的瞬态状态序列长度最多为 $M-r$。
因此，必然存在一个 $k \in R$ 以及步数 $m$，使得：
$$ P_{ik}^m > 0 $$
其中 $1 \le m \le M-r$。

#### 3. 综合证明

我们需要证明对于任意 $i \in \{1, \dots, M\}$ 和 $j \in R$，当 $n \ge (r-1)^2 + 1 + M - r$ 时，$P_{ij}^n > 0$。

**情况 1：起始状态 $i \in R$**
此时 $i$ 已经在常返类中。由于 $i$ 无法离开 $R$，我们只需考虑类内的转移。
已知 $n \ge (r-1)^2 + 1 + (M - r)$。
因为 $M \ge r$，所以 $M - r \ge 0$，从而：
$$ n \ge (r-1)^2 + 1 $$
根据步骤 1 中的 Wielandt 定理，直接可得 $P_{ij}^n > 0$。

**情况 2：起始状态 $i \in T$**
此时 $i$ 是瞬态状态。如步骤 2 所述，存在一条路径从 $i$ 到达某个 $k \in R$，步数为 $m$，且 $1 \le m \le M-r$。
利用 Chapman-Kolmogorov 方程：
$$ P_{ij}^n \ge P_{ik}^m \cdot P_{kj}^{n-m} $$
我们需要证明 $P_{kj}^{n-m} > 0$。
由于 $k \in R$ 且 $j \in R$，这是一个类内转移问题。我们需要检查剩余步数 $n-m$ 是否满足 Wielandt 界限。

计算剩余步数的下界：
$$ n - m \ge n - (M - r) $$
代入题目给定的 $n$ 的条件 $n \ge (r-1)^2 + 1 + M - r$：
$$ n - m \ge \left[ (r-1)^2 + 1 + M - r \right] - (M - r) $$
$$ n - m \ge (r-1)^2 + 1 $$

由于 $k, j \in R$ 且步数 $n-m$ 超过了本原指数的界限 $(r-1)^2 + 1$，根据步骤 1 的结论，有 $P_{kj}^{n-m} > 0$。
结合 $P_{ik}^m > 0$，可得：
$$ P_{ij}^n \ge P_{ik}^m \cdot P_{kj}^{n-m} > 0 $$

综上所述，无论是 $i \in R$ 还是 $i \in T$，只要 $n \ge (r-1)^2 + 1 + M - r$，均有 $P_{ij}^n > 0$。

---

### 答案

对于具有一个包含 $r$ 个状态的常返类和 $M-r$ 个瞬态状态的马尔可夫链（假设常返类非周期），对于所有 $j \le r$ 和 $n \ge (r-1)^2 + 1 + M - r$，均有：
$$ P_{ij}^n > 0 $$

---

### 知识延伸

1.  **Wielandt 定理**：这是非负矩阵理论中的一个重要定理。对于 $n \times n$ 的本原矩阵 $A$，使其幂 $A^k$ 全正的最小指数 $\gamma(A)$ 称为本原指数（exponent of primitivity）。Wielandt 证明了 $\gamma(A) \le n^2 - 2n + 2 = (n-1)^2 + 1$。
2.  **本原矩阵 (Primitive Matrix)**：一个非负方阵 $A$ 被称为本原的，如果存在正整数 $k$ 使得 $A^k$ 的所有元素都严格大于 0。在马尔可夫链中，这对应于不可约且非周期（Aperiodic）的链。
3.  **瞬态与常返态**：
    *   **常返 (Recurrent)**：从该状态出发，以概率 1 最终回到该状态。
    *   **瞬态 (Transient)**：从该状态出发，有正概率永远不再回到该状态。
    *   在有限马尔可夫链中，一旦离开瞬态集合进入闭合的常返类，就永远无法回到瞬态集合。
4.  **解题技巧**：处理此类“经过多少步后概率恒大于 0”的问题时，通常采用**分段路径法**：
    *   第一段：从瞬态进入常返类（消耗步数上限为瞬态状态个数）。
    *   第二段：在常返类内部混合（消耗步数上限为 Frobenius 数或 Wielandt 界）。

---
