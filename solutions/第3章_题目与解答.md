# 第 3 章 - 题目与解答

**本章共 16 道题目**

---

## 例题3.8

### 题目

设 $m , n$ 是互素的正整数，则存在正整数 $T_{0} ,$ 使所有的正整数 $T \geq T_{0}$ 都可以由 $m , \, \, n$ 的非负组合表示，即， $\forall T \geq T_{0}$ ， $\exists u , ~ v \in\mathbb{N}$ ，使得 $u m+v n=T$ 。 证明：由 $m , n$ 互素（不妨设 $m > n$ )，则存在正整数 $s , \, \, t$ ，使得 $s m-t n=1$ 。令 $T_{0}=t n^{2}$ ，则对于所有 $T \geq T_{0}$ ，由欧几里得算法，得 32 3.2，状态分类 所以 $$ T=q n+r ( s m-t n )=\left( q-r t \right) \cdot n+r s \cdot m_{\circ} $$ 【定理3.9】对于任意的马尔可夫链（无论其状态数是有限的还是可数无穷的)，同一个类中的所有状态具有相同的周期。 证明。设 $i$ 和 $j$ 是在一个类 $\mathit{C}$ 中任意的不同状态对。那么存在某个 $n$ 使得 $P_{i j}^{n} > 0$ ，同时存在某个 $m$ 使得 $P_{j i}^{m} > 0$ . ·由于存在一条长度为 $n+m$ 的路从 $i$ 到 $j$ 再返回到 $i$ ，所以 $n+m$ 必须能被 $d ( i )$ 整除。 ·设 $t$ 是一个使得 $P_{j j}^{t} > 0$ 的整数。由于存在一条长度为 $n+t+m$ 的路从 $i$ 到 $j$ 再返回到 $j$ ，最后到达 $i$ ，所 以 $n+t+m$ 能被 $d ( i )$ 整除，因此 $t$ 能被 $d ( i )$ 整除。 。由于这对于所有使得 $P_{j j}^{t} > 0$ 的 $t$ 都成立，因此 $d ( j )$ 能被 $d ( i )$ 整除。 ·反过来，交换 $i$ 和 $j$ 的角色，可以得知 $d ( i )$ 能被 $d ( j )$ 整除，因此 $d ( i )=d ( j )$ . □ 【定理3.10】如果一个有限状态马尔可夫链的常返类 $\mathit{C}$ 周期为 $d$ ，则可以将 $\mathit{C}$ 中的状态分成 $d$ 个子集， $S_{0} , S_{1} , \ldots, S_{d-1}$ ，使得从 $s_{\ell} \in S_{\ell}$ 一步转移进入 $s_{\ell+1} \in S_{\ell}$ 这里的下标 $\ell$ 指 $\ell\mod d$ 。 换句话说，从该类中的任何子类开始，该链将会循环经过 $d$ 个子类。 3.2.2 遍历类 【定义3.11】对于一个有限状态马尔科夫链，遍历类是指这类状态既是常返的又是非周期的。如果一个马尔科夫链只包含一个类并且是遍历类，称作遍历链。

### 解答

**Refining Proof Steps**

I'm currently focused on the "解题过程" section, particularly the proof of Example 3.8. I'm double-checking each step and ensuring the logic is airtight, especially the bounds used. I've also drafted the proof of Theorem 3.9, ensuring the implications between periodicity and communicating classes are clear. Next, I plan to finalize the "答案" and "知识延伸" sections.


### 题目分析

本段内容主要包含三个部分：一个数论引理（例题3.8）的证明、马尔可夫链状态分类中关于周期性的定理（定理3.9）的证明，以及常返类分解定理（定理3.10）和遍历类的定义（定义3.11）。

1.  **核心概念**：
    *   **数论性质**：互素整数的非负线性组合（Frobenius Coin Problem 的特例）。
    *   **马尔可夫链（Markov Chain）**：状态分类、周期性（Periodicity）、常返性（Recurrence）、遍历性（Ergodicity）。
2.  **数学符号**：
    *   $m, n$：互素的正整数。
    *   $d(i)$：状态 $i$ 的周期。
    *   $P_{ij}^n$：从状态 $i$ 经过 $n$ 步转移到状态 $j$ 的概率。
    *   $\mathcal{C}$：马尔可夫链的一个类（Class）。
3.  **目标**：
    *   证明对于互素的 $m, n$，存在阈值 $T_0$，使得所有 $T \ge T_0$ 均可表示为 $um+vn$（用于后续证明非周期状态在足够多步数后必可达）。
    *   证明同一类中的状态具有相同的周期。
    *   定义遍历类。

---

## 例题3.12

### 题目

假设 $[ P ]$ 是一个有限状态马尔可夫链的转移矩阵，状态 $i$ 是一个常返态。证明如果 $P_{i i} > 0$ ，则状态 $i$ 是非周期的。

### 解答

**Defining the Proof**

I am now focused on defining the period and return times formally. Subsequently, the proof will leverage the condition $P_{ii} > 0$, deducing that the greatest common divisor of the return times set is 1. The implication of this is aperiodic, based on the definition. After that, I'm thinking about extending the knowledge with some theorems about periodicity.


### 题目分析
本题考查离散时间马尔可夫链（Markov Chain）中状态分类的核心概念，具体涉及状态的**周期性（Periodicity）**。题目给出了转移矩阵 $P$ 和一个常返状态 $i$，关键条件是该状态的一步转移概率 $P_{ii} > 0$（即存在自环）。我们需要利用周期的定义，证明该状态是非周期的（Aperiodic）。

### 解题过程

**1. 定义回顾**

首先回顾马尔可夫链中状态 $i$ 的周期 $d(i)$ 的定义。周期 $d(i)$ 是所有使得 $n$ 步转移概率 $P_{ii}^{(n)} > 0$ 的正整数 $n$ 的最大公约数。

数学表达式为：
$$d(i) = \gcd\{n \ge 1 : P_{ii}^{(n)} > 0\}$$
其中：
- $P_{ii}^{(n)}$ 表示从状态 $i$ 出发，经过 $n$ 步后首次或再次回到状态 $i$ 的概率（此处指 $n$ 步转移概率）。
- $\gcd$ 表示最大公约数（Greatest Common Divisor）。
- 如果 $d(i) = 1$，则称状态 $i$ 是**非周期的（aperiodic）**。

**2. 分析已知条件**

题目给定条件为 $P_{ii} > 0$。
在马尔可夫链的记号中，$P_{ii}$ 等价于 $P_{ii}^{(1)}$，即从状态 $i$ 出发，经过 $1$ 步回到状态 $i$ 的概率。

**3. 推导过程**

令集合 $I_i$ 为状态 $i$ 所有可能的返回时间步长的集合：
$$I_i = \{n \ge 1 : P_{ii}^{(n)} > 0\}$$

根据已知条件 $P_{ii} > 0$，即 $P_{ii}^{(1)} > 0$，我们可以得出：
$$1 \in I_i$$

这意味着集合 $I_i$ 中包含整数 $1$。

**4. 计算最大公约数**

根据周期的定义，我们需要计算集合 $I_i$ 中所有元素的的最大公约数：
$$d(i) = \gcd(I_i)$$

由于 $1 \in I_i$，且任何包含 $1$ 的正整数集合的最大公约数必然是 $1$（因为 $1$ 只能被 $1$ 整除），因此：
$$d(i) = 1$$

**5. 结论**

因为状态 $i$ 的周期 $d(i) = 1$，根据非周期性的定义，状态 $i$ 是非周期的。

### 答案
$$d(i) = \gcd\{n \ge 1 : P_{ii}^{(n)} > 0\} = \gcd(\{1, \dots\}) = 1 \implies \text{状态 } i \text{ 是非周期的}$$

### 知识延伸

1.  **类性质（Class Property）**：
    周期性是一个类性质。如果状态 $i$ 和状态 $j$ 互通（即 $i \leftrightarrow j$），则它们具有相同的周期，即 $d(i) = d(j)$。因此，如果一个不可约马尔可夫链中有一个状态满足 $P_{ii} > 0$，则整个链的所有状态都是非周期的。

2.  **常返性与周期性的关系**：
    题目中提到“状态 $i$ 是常返态”，这保证了过程会无限次回到状态 $i$。虽然周期性的定义不依赖于常返性（瞬态也可以定义周期），但在研究极限分布 $\lim_{n \to \infty} P_{ij}^{(n)}$ 时，非周期性是至关重要的条件。
    - 对于**非周期、正常返**（遍历）的马尔可夫链，极限分布存在且独立于初始状态。
    - 对于**周期性**马尔可夫链（周期 $d > 1$），$P_{ii}^{(n)}$ 不会收敛到一个固定的常数，而是随 $n$ 的变化呈现周期性波动。

3.  **常见判定技巧**：
    - 只要观察到状态转移图中存在一个**自环**（Self-loop，即 $P_{ii} > 0$），该状态及其所在的互通类必定是非周期的。
    - 如果能找到两个互质的步长 $n_1, n_2$ 使得 $P_{ii}^{(n_1)} > 0$ 且 $P_{ii}^{(n_2)} > 0$，则 $\gcd(n_1, n_2) = 1$，该状态也是非周期的。

4.  **重要公式**：
    若状态 $i$ 是非周期的，则存在一个整数 $N$，使得对于所有 $n \ge N$，都有 $P_{ii}^{(n)} > 0$。这是数论中 Frobenius Coin Problem 的一个推论。

---

## 例题3.13

### 题目

证明每个 $M < \infty$ 状态马尔科夫链包含至少一个常返态集合。

### 解答

**Defining the Problem**

\n\n

I'm solidifying the problem's scope: demonstrating the existence of a recurrent state set in a finite Markov chain. I've broken down the goal into proving at least one recurrent state exists, and then the critical link to its closed communicating class, which constitutes the desired set. I'm focusing on the logical flow of a contradiction proof, ready to handle the finite nature of the state space.


### 题目分析
本题考查有限状态马尔可夫链（Finite State Markov Chain）中状态分类的核心性质。题目要求证明在状态空间大小 $M$ 为有限（$M < \infty$）的情况下，必然存在至少一个常返态集合（即一个闭的、不可约的常返状态集）。解题的关键在于利用暂态（Transient State）的极限性质以及有限状态空间中概率归一化的特点，通过反证法导出矛盾。

### 解题过程

设马尔可夫链的状态空间为 $S$，且状态总数 $|S| = M < \infty$。

**第一步：回顾暂态与常返态的定义及性质**

对于任意状态 $j \in S$，若 $j$ 是暂态（Transient），则意味着从该状态出发最终无法返回的概率大于0，或者等价地，系统访问状态 $j$ 的期望次数是有限的。
根据暂态的判别准则，若 $j$ 为暂态，则对于任意初始状态 $i$，经过 $n$ 步转移到 $j$ 的概率 $P_{ij}^{(n)}$ 满足：
$$ \sum_{n=1}^{\infty} P_{ij}^{(n)} < \infty $$
由于级数收敛，其通项必趋于零，即：
$$ \lim_{n \to \infty} P_{ij}^{(n)} = 0, \quad \forall i, j \in S \text{ 且 } j \text{ 为暂态} $$

**第二步：使用反证法**

假设状态空间 $S$ 中**所有**状态都是暂态。
这意味着对于 $S$ 中的每一个状态 $j$，都有：
$$ \lim_{n \to \infty} P_{ij}^{(n)} = 0, \quad \forall i \in S $$

**第三步：利用概率归一性导出矛盾**

考察任意固定的初始状态 $i$。在任意时刻 $n$，系统必然处于状态空间 $S$ 的某一个状态中。因此，对于任意 $n \ge 1$，转移概率之和必须为 1：
$$ \sum_{j \in S} P_{ij}^{(n)} = 1 $$

现在，我们对上式两边取 $n \to \infty$ 的极限：
$$ \lim_{n \to \infty} \sum_{j \in S} P_{ij}^{(n)} = 1 $$

由于状态空间 $S$ 是有限的（$|S| = M < \infty$），我们可以交换极限符号与求和符号的顺序（有限项求和的极限等于极限的求和）：
$$ \sum_{j \in S} \lim_{n \to \infty} P_{ij}^{(n)} = 1 $$

根据反证法的假设，所有状态 $j$ 均为暂态，故 $\lim_{n \to \infty} P_{ij}^{(n)} = 0$。代入上式得：
$$ \sum_{j \in S} 0 = 1 $$
$$ 0 = 1 $$

**第四步：结论**

上述结果显然是矛盾的。因此，假设不成立。
这证明了在有限状态马尔可夫链中，不可能所有状态都是暂态，即**至少存在一个状态是常返态（Recurrent State）**。

设这个常返态为 $r$。令 $C$ 为包含 $r$ 的不可约闭集（Communicating Class）。由于有限马尔可夫链中，常返态所在的不可约类必然是闭集且类中所有状态皆为常返态，因此集合 $C$ 即为所求的常返态集合。

### 答案
命题得证：每个 $M < \infty$ 状态马尔可夫链包含至少一个常返态集合。

### 知识延伸

1.  **状态空间分解定理**：
    对于任意马尔可夫链，状态空间 $S$ 可以唯一分解为：
    $$ S = T \cup C_1 \cup C_2 \cup \dots $$
    其中 $T$ 是暂态集合，$C_k$ 是互不相通的常返闭集（不可约闭集）。对于有限马尔可夫链，$T$ 可能为空，但常返部分 $\cup C_k$ 绝非空。

2.  **有限与无限的区别**：
    - **有限状态空间**：必有常返态，且非空闭集必常返。
    - **无限状态空间**：所有状态都可能是暂态（例如：一维非对称随机游走），或者所有状态形成一个闭集但仍为暂态（零常返）。

3.  **重要性质**：
    - 若状态 $i$ 是常返的，且 $i \leftrightarrow j$（$i$ 与 $j$ 互通），则 $j$ 也是常返的。
    - 在有限状态链中，不存在零常返态（Null Recurrent），所有常返态均为正常返态（Positive Recurrent）。

4.  **易错点**：
    在证明 $\sum \lim P = 1$ 时，必须强调状态数 $M$ 有限，否则极限与求和符号不能随意交换（例如在无限状态下，概率质量可能“逃逸”到无穷远）。

---

## 例题3.14

### 题目

考虑一个有限状态的马尔可夫链，其中某个给定的状态，比如状态1，可以从任何其他状态到达。证明该链恰好有一个常返类 $\mathcal{R}$ ，且状态 $1 \ \in\mathcal{R}$ 。（注意，此时该链是单链。） 【定理3.15】对于一个遍历的有 $M$ 状态的马尔科夫链，对于所有的 $i$ . $j$ 和 $m \geq( M-1 )^{2}+1$ ，满足 $P_{i j}^{m} > 0$ 。 证明.a）证明一个有 $M ( > 1 )$ 个状态的遍历马尔可夫链，它必然包含一个有 $\tau< M$ 状态的环。 b）假设 $\ell$ 是一个长度为 $\tau< M$ 的环中的某一状态。假设 ${\mathcal T} ( m )$ 是从状态 $\ell$ 经过 $m$ 步可达的状态集合。证明对于任意 $m \geq1 , \, \, \, \mathcal{T} ( m ) \subseteq\mathcal{T} ( m+\tau)$ ，我们有 $P_{\ell j}^{m} > 0$ 。西此， $P_{\ell j}^{m+\tau} \geq P_{\ell\ell}^{\tau} P_{\ell j}^{m}$ c）将 ${\mathcal T} ( 0 )$ 定义为单元素集合 $\{\ell\}$ 。 对于任意状态 $j \in{\mathcal T} ( m )$ ，并且证明 $$ \mathcal{T} ( 0 ) \subseteq\mathcal{T} ( \tau) \subseteq\mathcal{T} ( 2 \tau) \subseteq\dots\subseteq\mathcal{T} ( n \tau) \subseteq\dots\circ $$ d）证明如果上述包含关系中的一个等式成立，那么随后的所有包含关系都将等式成立。由此证明最多只有前 $M-1$ 个包含关系会严格不等式成立，且对于所有 $n \geqslant M-1$ ，都有 $\mathcal{T} ( n \tau)=\mathcal{T} ( ( M-1 ) \tau)$ . 。可以通过归纳法证明，如果对于某个 $k$ . $\mathcal{T} ( ( k+1 ) \tau)=\mathcal{T} ( k \tau)$ ，那么对于 $n \geqslant k \, , \, \, \, \mathcal{T} ( n \tau)=\mathcal{T} ( k \tau)$ . ·设 $k$ 是最小的整数，使得 $\mathcal{T} ( ( k+1 ) \tau)=\mathcal{T} ( k \tau)$ 成立。对于 $n \leqslant k , \ \mathcal{T} ( n \tau)$ 的大小必须随着 $n$ 的增加而增 加。由于 $| {\mathcal T} ( 0 ) |=1$ ，我们有 $k+1 \leqslant| \mathcal{T} ( k \tau) | \leqslant M$ 。 e）证明所有状态都包含在 $T ( ( M-1 ) \tau)$ 中。 f）证明对于所有 $i , ~ j$ ，有 $P_{i j}^{( M-1 )^{2}+1} > 0$ . 。对于包含在周期为 $\tau\leqslant M-1$ 的环中的状态 $\ell$ : 一设 $\ell^{\prime}$ 是在该环上有转移 $( \ell, \ell^{\prime} )$ 的状态，那么 ${\mathcal T} ( ( M-1 ) \tau+1 ) \supseteq{\mathcal T}^{\prime} ( ( M-1 ) \tau)={\mathcal S}_{\mathcal S}$ . 33 3.3.矩阵表示 SgAwiaNT $m \geqslant( M-1 ) \tau$ ，有 $\mathcal{T} ( m )=\mathcal{S}$ . $( M-1 )^{2}+1 > ( M-1 ) \tau$ ，所以 $P_{\ell j}^{( M-1 )^{2}+1} > 0$ 。 ·对于不包含在该环中的状态 $\ell^{*}$ ，它最多在 $( M-\tau)$ 步内可以到达该环。我们有： $$ \mathcal{T}^{*} ( ( M-1 )^{2}+1 ) \supseteq T ( ( M-1 )^{2}+1-( M-\tau) ) . $$ 由于 $$ ( M-1 )^{2}+1-( M-\tau)-( M-1 ) \tau=M ( M-1-\tau) \geqslant0 , $$ 我们有 $$ \mathcal{T}^{\ast} ( ( M-

### 解答

**Refining the Proof's Logic**

I'm now deeply immersed in structuring the solution, meticulously crafting the individual parts for clarity. Specifically, I'm focusing on the bound in Theorem 3.15. The prompt's logic in step (f) requires careful attention to the relationship between the cycle length, the number of states, and the reachability. I am also adjusting my understanding to fit the prompt's slightly unconventional approach to the proof's structure. It's becoming clear that adherence to the provided guide is crucial, even if it deviates from a canonical presentation.


### 题目分析

本题包含两个部分，主要考查**有限状态马尔可夫链**的结构性质与渐近行为：

1.  **例题 3.14**：考查马尔可夫链中**常返类（Recurrent Class）**与**可达性（Accessibility）**的关系。核心在于利用有限状态空间的性质证明常返类的唯一性。
2.  **定理 3.15**：考查**遍历（Ergodic）**马尔可夫链的**本原性（Primitivity）**。具体目标是证明一个关于混合时间（Mixing Time）的上界，即经过 $m \ge (M-1)^2 + 1$ 步后，转移矩阵的所有元素均严格大于 0。这涉及到图论中环的性质以及集合序列的扩张分析。

---

## 例题3.17

### 题目

考虑一个具有一个常返类的马尔可夫链，该常返类包含 $r$ 个状态，记为 $\{1 , ~ 2 , ~ \ldots, ~ r \}$ ，并且还有 $M-r$ 个其他瞬态状态。证明对于所有 $j \leq r$ 和 $n \geq( r-1 )^{2}+1+M-r$ ，有 $P_{i j}^{n} > 0$ 。

### 解答

**Proof Construction Begins**

The analysis of the problem statement is complete, leading to a structured proof. It requires a formal approach, using Wielandt's theorem and careful consideration of transient states. I'm focusing on ensuring all conditions are met, especially the aperiodicity of the recurrent class and the correct bounds for the paths. Finally, I will write the final solution in the format requested, and begin checking for any implicit assumptions.


### 题目分析

本题考查有限状态马尔可夫链的**遍历性**、**不可约性**以及**本原矩阵（Primitive Matrix）的指数界**。
题目中定义了一个包含 $M$ 个状态的马尔可夫链，分为两部分：
1.  一个大小为 $r$ 的常返类（Recurrent Class），记为 $R = \{1, 2, \dots, r\}$。由于题目指出是“一个”常返类，且要求 $P_{ij}^n > 0$ 对所有大的 $n$ 成立，隐含了该常返类是**不可约且非周期（Aperiodic）**的假设（即其转移矩阵限制在 $R$ 上是本原的）。
2.  其余 $M-r$ 个为瞬态状态（Transient States），记为 $T = \{r+1, \dots, M\}$。

**求解目标**：证明对于任意起始状态 $i$（隐含在题目语境中，通常指任意状态）和目标状态 $j \in R$，当步数 $n$ 满足 $n \ge (r-1)^2 + 1 + M - r$ 时，转移概率 $P_{ij}^n > 0$。

---

## 例题3.29

### 题目

考虑一个由 $\kappa> 1$ 个遍历集合组成的马尔可夫链。很容易看出，有 $\kappa$ 个不同的稳态向量。每个遍历集合将具有一个特征值等于1，其右特征向量在该集合的状态上为1，其他地方为0。因此，每个常返类的稳态向量在同一常返类的每个状态上都严格为正，而在所有其他状态上都为零。 然后， $[ P^{n} ]$ 将收敛到一个分块对角矩阵，其中每个遍历集合内的行是相同的。 38 3.5.具有报酬的马尔科夫链 矩阵的Jordan标准型情况 在某些情况下，矩阵 $[ P ]$ 的一个或多个特征值重复，但给定重复特征值的线性无关右特征向量的数量小于该特征值的重数。因此， $[ P ]$ 不能表示为 $[ U ] [ \Lambda] [ U^{-1} ]$ 的形式，其中 $\Lambda$ 是特征值按其重数重复的对角矩阵。 线性代数告诉我们存在一个可逆矩阵 $\left[ U \right]$ 和一个Jordan标准型 $[ J ]$ ，使得 $$ [ P ]=[ U ] [ J ] [ U^{-1} ]_{\circ} $$ 其中， $[ J ]$ 是具有关于特征值 $\lambda_{i}$ 的Jordan块的分块对角矩阵。 $$ [ J ]=\left[ \begin{matrix} {[ J_{1} ]} & {} & {} \\ {} & {\ddots} & {} \\ {} & {} & {[ J_{l} ]} \\ \end{matrix} \right] , \; \; \; \; [ J_{s} ]=\left[ \begin{matrix} {\lambda_{s}} & {1} & {} & {} \\ {} & {\lambda_{s}} & {\ddots} & {} \\ {} & {} & {\ddots} & {1} \\ {} & {} & {} & {\lambda_{s}} \\ \end{matrix} \right] . $$ 【定理3.30】一个有限状态的单链的转移矩阵具有唯一的特征值 $\lambda=1$ ，并伴随一个满足 $\boldsymbol{\pi} [ P ]=\boldsymbol{\pi}$ 的左特征向量 $\pi$ ，以及一个右特征向量 $\boldsymbol{e}=( 1 , ~ \ldots, ~ 1 )^{\mathrm{T}}$ . 其他特征值 $\lambda_{i}$ 满足 $| \lambda_{i} | \leqslant1$ 的不等式。 除非单链是周期性的，例如周期为 $d$ ，否则不等式是严格的。在这种情况下，有 $d$ 个幅度为1的特征值均匀分布在单位圆周上。 如果单链是遍历的，那么 $[ P^{n} ]$ 收敛到稳态 $e \pi$ ，每个分量的误差至少以 $n^{k} \lambda_{s}^{n}$ 的速度趋近于零，其中 $\lambda_{s}$ 是绝对值小于1的最大幅度的特征值， $k$ 是特征值 $\lambda_{s}$ 对应的最大Jordan块的尺寸。 -&3.5- 具有报酬的马尔科夫链 假设马尔可夫链的每个状态 $i$ 都与一个给定的报酬 $r_{i}$ 相关联。令随机变量 $X_{n}$ 表示时间 $n$ 时的状态，时间 $n$ 的报酬是随机变量 $R ( X_{n} )$ ，它将 $X_{n}=i$ 映射为 $r_{i}$ （对于每个 $i$ )。 我们只关注报酬期望，例如，在给定 $X_{0}=i$ 的情况下，时间 $n$ 的报酬期望是 $$ \mathrm{E} [ R ( X_{n} ) | X_{0}=i ]=\sum_{j} P_{i j}^{n} r_{j} . $$ 在给定 $X_{m}=i$ 的情况下，从第 $m$ 步到第 $m+n-1$ 步的 $n$ 步累计期望报酬为 $$ \begin{aligned} {v_{i} ( n )} & {{}=\operatorname{E} [ R ( X_{m} )+\cdots+R ( X_{m+n-1} ) | X_{m}=i ]} \\ {} & {{}=r_{i}+\sum_{j} P_{i j} r_{j}+\cdots+\sum_{j} P_{i j}^{n-1} r_{j} \circ} \\ \end{aligned} $$ 3.5.1 期望首次通过时间 假设对于某个任意的单链，我们想找到从给定状态 $i$ 开始，直到首次进入给定的常返态（比如状态1）的期望步数。假设 $i \neq1$ 。我们可以将这个问题看作是一个报酬问题，通过将每个连续状态分配一个单位的报酬，直到进入状态1。因此，我们可以修改这个链，将最终状态1转变为一个吸收态，即 $P

### 解答

**Reviewing Decomposition Strategies**

I'm currently fleshing out the "解题过程" section, detailing the solution process. My main focus is on meticulously explaining the transition from multiple ergodic sets to the implications of the Jordan Canonical Form, which is crucial for understanding the convergence rate in Theorem 3.30. I'm carefully constructing each step, ensuring logical flow and mathematical rigor, and I'll include LaTeX notations to format correctly.


### 题目分析

本题并非一道传统的计算题，而是一段关于**马尔可夫链谱理论（Spectral Theory of Markov Chains）**的理论综述。内容涵盖了三个核心部分：
1.  **多遍历集（Reducible Chains）的性质**：当马尔可夫链包含 $\kappa > 1$ 个遍历集（常返类）时，转移矩阵 $[P]$ 的谱结构及其极限行为。
2.  **Jordan 标准型（Jordan Canonical Form）的应用**：当转移矩阵不可对角化（存在非平凡 Jordan 块）时，矩阵幂 $[P^n]$ 的计算方法。
3.  **单链（Unichain）的收敛定理**：即【定理3.30】，探讨了有限状态单链的特征值分布、稳态分布的存在性以及收敛速度与次主特征值（Subdominant Eigenvalue）及 Jordan 块尺寸的关系。

本题的核心在于利用线性代数中的特征值分解和 Jordan 标准型来分析随机过程的渐近行为（Asymptotic Behavior）。

### 解题过程

#### 1. 多遍历集马尔可夫链的谱结构 ($\kappa > 1$)

考虑一个包含 $\kappa$ 个遍历集合（Ergodic Sets，记为 $E_1, \dots, E_\kappa$）的马尔可夫链。

*   **特征值 $\lambda=1$ 的重数**：
    对于每一个遍历集合 $E_i$，我们可以构造一个稳态分布向量 $\pi^{(i)}$，其在 $E_i$ 内的状态上严格为正，在 $E_i$ 之外为 $0$。由于这些集合互不相通，$\pi^{(1)}, \dots, \pi^{(\kappa)}$ 是线性无关的。
    根据马尔可夫链理论，$\pi^{(i)} [P] = \pi^{(i)}$。这意味着 $\lambda = 1$ 的**几何重数**（Geometric Multiplicity）至少为 $\kappa$。

*   **右特征向量**：
    对应于每个遍历集 $E_i$，存在一个右特征向量 $v^{(i)}$，使得：
    $$ [P] v^{(i)} = v^{(i)} $$
    其中 $v^{(i)}$ 在 $E_i$ 的状态上分量为 $1$，在其他状态上为 $0$。

*   **极限矩阵的形式**：
    通过适当排列状态索引，转移矩阵 $[P]$ 可以写成标准形式（Canonical Form）：
    $$ [P] = \begin{pmatrix} P_1 & 0 & \dots & 0 \\ 0 & P_2 & \dots & 0 \\ \vdots & \vdots & \ddots & \vdots \\ R_1 & R_2 & \dots & Q \end{pmatrix} $$
    其中 $P_i$ 对应第 $i$ 个遍历集，$Q$ 对应瞬态集（Transient States）。
    当 $n \to \infty$ 时，$[P^n]$ 收敛到一个分块对角矩阵（忽略瞬态部分的复杂性），每个遍历块内部收敛到其各自的稳态矩阵 $\mathbf{1} \pi^{(i)}$。

#### 2. 矩阵的 Jordan 标准型与收敛分析

当矩阵 $[P]$ 的某个特征值 $\lambda_i$ 的几何重数小于代数重数时，$[P]$ 不可对角化。此时需引入 Jordan 标准型：
$$ [P] = [U][J][U^{-1}] $$
其中 $[J]$ 是分块对角矩阵，由 Jordan 块 $[J_s]$ 组成：
$$ [J_s] = \begin{pmatrix} \lambda_s & 1 & 0 & \dots \\ 0 & \lambda_s & 1 & \dots \\ \vdots & \vdots & \ddots & \vdots \\ 0 & 0 & \dots & \lambda_s \end{pmatrix} $$

计算 $[P^n]$ 需要计算 $[J^n]$。对于一个尺寸为 $k \times k$ 的 Jordan 块 $[J_s]$，其 $n$ 次幂的元素涉及二项式系数。具体地，$[J_s^n]$ 的上三角元素形式为：
$$ (J_s^n)_{ij} = \binom{n}{j-i} \lambda_s^{n-(j-i)} $$
当 $n$ 很大时，二项式系数 $\binom{n}{m}$ 的增长速度约为 $n^m$。因此，该块的元素随 $n$ 的变化趋势由以下项主导：
$$ n^{k-1} \lambda_s^n $$
这解释了题目中提到的收敛速度包含多项式因子 $n^k$（注：严格数学推导通常为 $n^{k-1}$，但在大 $O$ 符号下或特定上下文中常简述为与块尺寸 $k$ 相关）。

#### 3. 单链（Unichain）的收敛定理（定理3.30解析）

单链是指只有一个遍历集（可能包含一些瞬态）的马尔可夫链。

*   **特征值 $\lambda=1$ 的性质**：
    由于只有一个遍历集，$\lambda=1$ 是唯一的模为 1 的特征值（假设非周期）。
    *   **左特征向量**：$\pi$（稳态分布），满足 $\pi [P] = \pi, \sum \pi_i = 1$。
    *   **右特征向量**：$e = (1, \dots, 1)^T$，满足 $[P] e = e$。

*   **其他特征值**：
    对于随机矩阵，所有特征值满足 $|\lambda_i| \le 1$。
    *   **非周期性（Aperiodic）**：除 $\lambda_1=1$ 外，所有其他特征值严格满足 $|\lambda_i| < 1$。
    *   **周期性（Periodic）**：若周期为 $d$，则有 $d$ 个特征值均匀分布在单位圆上，即 $\lambda_k = e^{i \frac{2\pi k}{d}}$。

*   **收敛速度**：
    若单链是遍历的（即非周期且不可约，或单遍历类非周期），则：
    $$ \lim_{n \to \infty} [P^n] = e \pi = \begin{pmatrix} \pi_1 & \dots & \pi_m \\ \vdots & & \vdots \\ \pi_1 & \dots & \pi_m \end{pmatrix} $$
    收敛的误差项由绝对值第二大的特征值（次主特征值）决定。设 $\lambda_s$ 为满足 $|\lambda_s| < 1$ 的最大模特征值。
    $$ [P^n] - e\pi \approx O(n^{k-1} \lambda_s^n) $$
    这里 $k$ 是对应于 $\lambda_s$ 的最大 Jordan 块的尺寸。
    *   若 $\lambda_s$ 可对角化（$k=1$），收敛速度为几何级数 $\lambda_s^n$。
    *   若 $\lambda_s$ 对应非平凡 Jordan 块（$k>1$），收敛速度会因多项式因子 $n^{k-1}$ 而略微变慢，但由于 $|\lambda_s|^n$ 的指数衰减占主导，整体仍趋于 0。

### 答案

对于定理 3.30 描述的遍历单链，其 $n$ 步转移矩阵 $[P^n]$ 的极限行为及收敛速率可表述为：

$$ \lim_{n \to \infty} [P^n] = \mathbf{1}\pi $$

其中 $\mathbf{1}$ 是全 1 列向量，$\pi$ 是唯一的稳态概率行向量。

对于有限 $n$，其与稳态的偏差（误差）主要由模最大的非 1 特征值 $\lambda_s$ 控制。若 $\lambda_s$ 对应的最大 Jordan 块尺寸为 $k$，则误差项 $E_n$ 的渐近行为满足：

$$ \| [P^n] - \mathbf{1}\pi \| \sim C \cdot n^{k-1} |\lambda_s|^n $$

题目文本中表述为“以 $n^k \lambda_s^n$ 的速度”，这在数量级分析上指出了多项式增长因子与指数衰减因子的耦合。

### 知识延伸

1.  **Perron-Frobenius 定理**：这是本题背后的核心数学支柱。对于不可约非负矩阵（如遍历链的转移矩阵），该定理保证了最大特征值实数正性、简单性（simple root）以及对应正特征向量的存在性。
2.  **谱隙（Spectral Gap）**：定义为 $\gamma = 1 - |\lambda_s|$。谱隙越大，马尔可夫链收敛到稳态的速度越快（混合时间 Mixing Time 越短）。
3.  **代数重数 vs 几何重数**：
    *   **代数重数**：特征多项式中根的重数。
    *   **几何重数**：对应特征值的线性无关特征向量的个数。
    *   当几何重数 < 代数重数时，必须使用 Jordan 标准型，这在马尔可夫链中较少见但理论上存在。
4.  **易错点**：
    *   混淆**周期性**与**收敛性**。周期链不收敛到静态矩阵，而是在 $d$ 个矩阵间循环。
    *   忽略 Jordan 块带来的 $n^k$ 因子。虽然在 $n \to \infty$ 时指数项 $|\lambda|^n$ 占主导，但在 $n$ 较小时，多项式因子可能显著影响收敛曲线。

---

## 习题3.1

### 题目

假设 $\mathrm{X}=( X_{n} , \; \; n \geq0 )$ 是一个状态空间为 $\{1 , \ 2 , \ 3 \}$ 的马尔可夫链，转移矩阵为 $$ \mathrm{P}=\left( \begin{array} {c c c} {0 . 3} & {0 . 2} & {0 . 5} \\ {0 . 5} & {0 . 1} & {0 . 4} \\ {0 . 5} & {0 . 2} & {0 . 3} \\ \end{array} \right) $$ 如果 $\boldsymbol{p}_{0}=( 0 . 5 , ~ 0 . 5 , ~ 0 )$ ，求 （1) $P ( X_{0}=2 , \, \, \, X_{1}=2 , \, \, \, X_{2}=1 ) .$ , (2) $P ( X_{1}=2 , \, \, \, X_{2}=2 , \, \, \, X_{3}=1 ) .$

### 解答

**Summarizing Calculations**

I've confirmed the matrix indices, initial distribution, and all calculations. The output is accurate, the notation is standard, and it directly addresses the prompt's requirements. Now, the final response is ready to be generated in the requested format.


### 题目分析

本题考查离散时间马尔可夫链（Discrete-time Markov Chain, DTMC）的基本性质。
题目给出了状态空间 $S=\{1, 2, 3\}$、一步转移概率矩阵 $P$ 以及初始分布 $\boldsymbol{p}_{0}$。
需要求解的目标是两个特定路径（有限维联合分布）的概率：
1.  从 $n=0$ 时刻开始的路径概率 $P ( X_{0}=2 , \, X_{1}=2 , \, X_{2}=1 )$。
2.  从 $n=1$ 时刻开始的路径概率 $P ( X_{1}=2 , \, X_{2}=2 , \, X_{3}=1 )$。

解题的核心在于利用马尔可夫性（无后效性）将联合概率分解为初始概率与转移概率的乘积。

### 解题过程

已知转移矩阵为：
$$
P = \begin{pmatrix} P_{11} & P_{12} & P_{13} \\ P_{21} & P_{22} & P_{23} \\ P_{31} & P_{32} & P_{33} \end{pmatrix} = \begin{pmatrix} 0.3 & 0.2 & 0.5 \\ 0.5 & 0.1 & 0.4 \\ 0.5 & 0.2 & 0.3 \end{pmatrix}
$$
初始分布为 $\boldsymbol{p}_{0}=( P(X_0=1) , ~ P(X_0=2) , ~ P(X_0=3) ) = ( 0.5 , ~ 0.5 , ~ 0 )$。

#### (1) 求解 $P ( X_{0}=2 , \, X_{1}=2 , \, X_{2}=1 )$

根据马尔可夫链的定义，有限维联合分布可以表示为：
$$
P(X_0=i_0, X_1=i_1, \dots, X_n=i_n) = P(X_0=i_0) P_{i_0 i_1} P_{i_1 i_2} \dots P_{i_{n-1} i_n}
$$
对于本题，令 $i_0=2, i_1=2, i_2=1$，则有：
$$
P ( X_{0}=2 , \, X_{1}=2 , \, X_{2}=1 ) = P(X_0=2) \cdot P_{22} \cdot P_{21}
$$
从已知条件中获取数值：
-   $P(X_0=2) = 0.5$ （由 $\boldsymbol{p}_{0}$ 给出）
-   $P_{22} = 0.1$ （矩阵 $P$ 第2行第2列）
-   $P_{21} = 0.5$ （矩阵 $P$ 第2行第1列）

代入计算：
$$
\begin{aligned}
P ( X_{0}=2 , \, X_{1}=2 , \, X_{2}=1 ) &= 0.5 \times 0.1 \times 0.5 \\
&= 0.025
\end{aligned}
$$

#### (2) 求解 $P ( X_{1}=2 , \, X_{2}=2 , \, X_{3}=1 )$

利用条件概率公式和马尔可夫性，该联合概率可写为：
$$
P ( X_{1}=2 , \, X_{2}=2 , \, X_{3}=1 ) = P(X_1=2) \cdot P(X_2=2 | X_1=2) \cdot P(X_3=1 | X_2=2)
$$
即：
$$
P ( X_{1}=2 , \, X_{2}=2 , \, X_{3}=1 ) = P(X_1=2) \cdot P_{22} \cdot P_{21}
$$
首先需要计算 $X_1$ 的边缘分布 $P(X_1=2)$。根据全概率公式（或矩阵乘法 $\boldsymbol{p}_{1} = \boldsymbol{p}_{0}P$）：
$$
\begin{aligned}
P(X_1=2) &= \sum_{i=1}^{3} P(X_0=i) P_{i2} \\
&= P(X_0=1)P_{12} + P(X_0=2)P_{22} + P(X_0=3)P_{32}
\end{aligned}
$$
代入数值：
$$
\begin{aligned}
P(X_1=2) &= 0.5 \times 0.2 + 0.5 \times 0.1 + 0 \times 0.2 \\
&= 0.1 + 0.05 + 0 \\
&= 0.15
\end{aligned}
$$
现在计算最终结果：
$$
\begin{aligned}
P ( X_{1}=2 , \, X_{2}=2 , \, X_{3}=1 ) &= P(X_1=2) \times P_{22} \times P_{21} \\
&= 0.15 \times 0.1 \times 0.5 \\
&= 0.15 \times 0.05 \\
&= 0.0075
\end{aligned}
$$

### 答案

(1) $P ( X_{0}=2 , \, X_{1}=2 , \, X_{2}=1 ) = 0.025$

(2) $P ( X_{1}=2 , \, X_{2}=2 , \, X_{3}=1 ) = 0.0075$

### 知识延伸

1.  **马尔可夫性（Markov Property）**：
    核心思想是“将来只与现在有关，而与过去无关”。数学表达为：
    $$P(X_{n+1}=j | X_n=i, X_{n-1}=i_{n-1}, \dots, X_0=i_0) = P(X_{n+1}=j | X_n=i) = P_{ij}$$
2.  **路径概率公式**：
    对于齐次马尔可夫链，任意路径的概率等于初始状态概率乘以路径上每一步转移概率的乘积。
3.  **状态分布的演化**：
    $n$ 时刻的状态分布 $\boldsymbol{p}_n$ 可以通过初始分布和转移矩阵的幂次计算：$\boldsymbol{p}_n = \boldsymbol{p}_0 P^n$。在第(2)问中，我们实际上计算了 $\boldsymbol{p}_1$ 的分量。
4.  **易错点提示**：
    -   混淆 $P(X_0=i)$ 和 $P(X_1=i)$。计算非 $0$ 时刻起始的路径时，必须先求出起始时刻的边缘分布。
    -   矩阵行列索引弄反。$P_{ij}$ 表示从 $i$ 到 $j$，对应矩阵的第 $i$ 行第 $j$ 列。

---

## 习题3.2

### 题目

假设 $\mathrm{X}=( X_{n} , \; \; n \geq0 )$ 是马尔可夫链，状态空间为 $\{1 , ~ 2 , ~ 3 \}$ ，4}，转移概率矩阵为 $$ \mathrm{P}=\left( \begin{matrix} {\frac{1} {2}} & {\frac{1} {2}} & {0} & {0} \\ {1} & {0} & {0} & {0} \\ {0} & {\frac{1} {3}} & {\frac{2} {3}} & {0} \\ {\frac{1} {2}} & {0} & {\frac{1} {2}} & {0} \\ \end{matrix} \right) $$ 问：哪些状态是常返的，哪些是瞬时的？并求每个状态的周期。

### 解答

**Reviewing Solution Steps**

I'm now consolidating the steps into a structured solution. I've focused on clearly defining communication relations, identifying closed classes for recurrence/transience determination, and correctly addressing the period calculation, including the special case of state 4. The LaTeX formatting is checked and ready for output.


### 题目分析

本题考查**离散时间马尔可夫链（Discrete-time Markov Chain, DTMC）**的状态分类与性质。
给定状态空间 $S=\{1, 2, 3, 4\}$ 和一步转移概率矩阵 $P$，需要解决两个核心问题：
1.  **状态分类**：判断哪些状态是常返（recurrent）的，哪些是瞬时（transient）的。这需要分析状态之间的相通性（communication）以及是否存在封闭集（closed set）。
2.  **求解周期**：计算每个状态的周期 $d(i)$，即该状态所有可能的返回时间步长的最大公约数。

### 解题过程

#### 1. 分析状态间的相通性与状态空间分解

首先，根据转移概率矩阵 $P$ 画出状态转移关系，或直接观察矩阵中的非零元素：
$$ \mathrm{P}=\left( \begin{matrix} {\frac{1} {2}} & {\frac{1} {2}} & {0} & {0} \\ {1} & {0} & {0} & {0} \\ {0} & {\frac{1} {3}} & {\frac{2} {3}} & {0} \\ {\frac{1} {2}} & {0} & {\frac{1} {2}} & {0} \\ \end{matrix} \right) $$

**观察各状态的转移情况：**
*   **状态 1**：$P_{11} > 0, P_{12} > 0$。状态 1 可以到达自身和状态 2。
*   **状态 2**：$P_{21} > 0$。状态 2 只能到达状态 1。
    *   由此可知：$1 \to 2$ 且 $2 \to 1$，故 $1 \leftrightarrow 2$（互通）。
    *   观察矩阵第 3 列和第 4 列，在第 1、2 行的元素均为 0。这意味着一旦进入集合 $\{1, 2\}$，就无法到达状态 3 或 4。因此，集合 $\{1, 2\}$ 是一个**封闭集（closed set）**。

*   **状态 3**：$P_{32} > 0, P_{33} > 0$。状态 3 可以到达状态 2 和自身。
    *   由于 $3 \to 2$，而 $2$ 无法到达 $3$（因为 $P_{23}=0$ 且 $P_{13}=0$，即从 $\{1,2\}$ 无法回到 3），所以 $3 \to 2$ 但 $2 \nrightarrow 3$。
    *   因此，状态 3 是非封闭的。

*   **状态 4**：$P_{41} > 0, P_{43} > 0$。状态 4 可以到达状态 1 和状态 3。
    *   观察矩阵第 4 列，所有元素均为 0（即 $P_{i4} = 0, \forall i$）。这意味着没有任何状态可以到达状态 4（包括它自己一步也回不来，且出去后也无法通过其他路径回来）。
    *   因此，状态 4 也是非封闭的。

**状态空间的分解：**
根据互通关系，状态空间 $S$ 可以分解为以下几个互通类（Communicating Classes）：
1.  $C_1 = \{1, 2\}$
2.  $C_2 = \{3\}$
3.  $C_3 = \{4\}$

#### 2. 判断常返性与瞬时性

根据马尔可夫链的性质：
*   在有限状态马尔可夫链中，**封闭的互通类是常返的（且为正常返）**。
*   **非封闭的互通类是瞬时的**。

具体分析如下：
*   **集合 $\{1, 2\}$**：这是一个封闭的互通类。一旦进入该集合，系统将永远停留在该集合内。由于状态空间有限，故状态 1 和 2 是**常返状态**。
*   **状态 3**：从状态 3 出发，有概率 $P_{32}=1/3$ 进入状态 2。一旦进入状态 2（属于封闭集 $\{1, 2\}$），就再也无法返回状态 3。存在不返回的路径，故状态 3 是**瞬时状态**。
*   **状态 4**：从状态 4 出发，必然进入状态 1 或 3。由于矩阵第 4 列全为 0，系统一旦离开状态 4 就永远无法返回。故状态 4 是**瞬时状态**。

#### 3. 求解每个状态的周期

状态 $i$ 的周期定义为 $d(i) = \mathrm{GCD}\{n \geq 1 : P_{ii}^{(n)} > 0\}$（最大公约数）。

*   **状态 1**：
    观察 $P_{11} = \frac{1}{2} > 0$。
    集合 $\{n : P_{11}^{(n)} > 0\}$ 包含 1。
    因此，$d(1) = \mathrm{GCD}\{1, \dots\} = 1$。

*   **状态 2**：
    周期是互通类的属性，互通的状态具有相同的周期。
    因为 $1 \leftrightarrow 2$，所以 $d(2) = d(1) = 1$。
    （验证：$2 \to 1 \to 2$ 步长为 2，$2 \to 1 \to 1 \to 2$ 步长为 3，GCD(2,3)=1）。

*   **状态 3**：
    观察 $P_{33} = \frac{2}{3} > 0$。
    集合 $\{n : P_{33}^{(n)} > 0\}$ 包含 1。
    因此，$d(3) = 1$。

*   **状态 4**：
    观察矩阵第 4 列全为 0，即对于任意 $n \geq 1$，都有 $P_{44}^{(n)} = 0$。
    集合 $\{n \geq 1 : P_{44}^{(n)} > 0\}$ 是空集 $\emptyset$。
    在数学定义上，如果不可能返回，通常认为周期未定义。但在某些教材中，若需强行分类，非周期的概念不适用于永远无法返回的状态。此处严谨回答为**未定义**（或不存在）。

### 答案

1.  **常返状态**：$\{1, 2\}$
2.  **瞬时状态**：$\{3, 4\}$
3.  **各状态的周期**：
    $$ d(1) = 1 $$
    $$ d(2) = 1 $$
    $$ d(3) = 1 $$
    $$ d(4) \text{ 未定义（集合为空）} $$

### 知识延伸

1.  **常返与瞬时的判定定理**：
    *   对于有限状态马尔可夫链，状态空间 $S$ 可以唯一分解为 $S = T \cup R_1 \cup R_2 \cup \dots$，其中 $T$ 是瞬时态集合，$R_k$ 是封闭的常返互通类。
    *   若 $i \to j$ 且 $j \nrightarrow i$，则 $i$ 必为瞬时状态。

2.  **周期的性质**：
    *   **类性质**：若 $i \leftrightarrow j$，则 $d(i) = d(j)$。
    *   若状态 $i$ 有自环（即 $P_{ii} > 0$），则该状态及其所在的互通类必定是**非周期的**（即周期 $d=1$）。

3.  **易错点提示**：
    *   不要混淆“瞬时”与“周期”。瞬时状态也可以有周期（只要它能返回自身，例如 $3 \to 3$）。只有当完全无法返回自身时（如本题的状态 4），周期才无定义。
    *   判断封闭集时，要检查该集合是否能到达集合外部的任何状态。只要有一条路径通向外部，该集合就不是封闭的。

---

## 习题3.4

### 题目

假设 $\mathrm{X}=( X_{n} , \; \; n \geq0 )$ 是马尔可夫链，请分别考虑以下两个转移矩阵 $$ \mathrm{P 1}=\left( \begin{matrix} {\frac{1} {2}} & {\frac{1} {2}} & {0} & {0} & {0} \\ {\frac{1} {4}} & {\frac{3} {4}} & {0} & {0} & {0} \\ {0} & {0} & {0} & {1} & {0} \\ {0} & {0} & {\frac{1} {2}} & {0} & {\frac{1} {2}} \\ {0} & {0} & {0} & {1} & {0} \\ \end{matrix} \right) \mathrm{P 2}=\left( \begin{matrix} {\frac{1} {2}} & {\frac{1} {2}} & {0} & {0} & {0} \\ {\frac{1} {4}} & {0} & {\frac{3} {4}} & {0} & {0} \\ {0} & {0} & {0} & {1} & {0} \\ {0} & {0} & {\frac{1} {2}} & {0} & {\frac{1} {2}} \\ {0} & {0} & {0} & {1} & {0} \\ \end{matrix} \right) $$ （1）分别对上述两个状态空间进行分类； (2）分别列出上述两个状态空间各自对应的连通类； （3）上述两个状态空间各自连通类之间互通吗？

### 解答

**Reviewing Output Strategy**

I'm now carefully examining the structured output I've constructed, verifying the formatting compliance and mathematical accuracy. The emphasis is on a concise, professional tone, ensuring LaTeX is correctly implemented, and that the analysis is free of any conversational filler. The states are classified according to their properties, and communicating classes and their relation to one another are properly presented.


### 题目分析

本题考查**离散时间马尔可夫链（Discrete-time Markov Chain, DTMC）**的状态分类与结构分析。
核心考点包括：
1.  **互通性与连通类（Communicating Classes）**：根据转移概率矩阵判断状态之间是否互通，并将状态空间划分为若干个连通类。
2.  **状态分类**：判断连通类的性质，包括**常返性（Recurrence）**与**瞬变性（Transience）**，以及**周期性（Periodicity）**。
3.  **类间关系**：分析不同连通类之间的可达性。

题目要求对给定的两个 $5 \times 5$ 转移矩阵 $P_1$ 和 $P_2$ 进行上述分析。我们将状态空间记为 $S = \{1, 2, 3, 4, 5\}$。

---

### 解题过程

#### 第一部分：分析矩阵 $P_1$

$$ \mathrm{P}_1=\left( \begin{matrix} {\frac{1} {2}} & {\frac{1} {2}} & {0} & {0} & {0} \\ {\frac{1} {4}} & {\frac{3} {4}} & {0} & {0} & {0} \\ {0} & {0} & {0} & {1} & {0} \\ {0} & {0} & {\frac{1} {2}} & {0} & {\frac{1} {2}} \\ {0} & {0} & {0} & {1} & {0} \\ \end{matrix} \right) $$

**1. 确定连通类**
观察矩阵 $P_1$ 的结构，可以看出它是一个分块对角矩阵。
-   **状态集合 $\{1, 2\}$**：
    -   $1 \to 2$ ($P_{12} > 0$)， $2 \to 1$ ($P_{21} > 0$)，故 $1 \leftrightarrow 2$。
    -   对于 $i \in \{1, 2\}$ 和 $j \in \{3, 4, 5\}$，有 $P_{ij} = 0$。即一旦进入 $\{1, 2\}$，永远不会离开。
    -   因此，$\{1, 2\}$ 是一个闭集（Closed Set），且是不可约的（Irreducible）。

-   **状态集合 $\{3, 4, 5\}$**：
    -   $3 \to 4$ ($P_{34}=1$)。
    -   $4 \to 3$ ($P_{43}=1/2$)，故 $3 \leftrightarrow 4$。
    -   $4 \to 5$ ($P_{45}=1/2$)， $5 \to 4$ ($P_{54}=1$)，故 $4 \leftrightarrow 5$。
    -   由传递性，$3 \leftrightarrow 5$。
    -   对于 $i \in \{3, 4, 5\}$ 和 $j \in \{1, 2\}$，有 $P_{ij} = 0$。
    -   因此，$\{3, 4, 5\}$ 也是一个闭集，且是不可约的。

**2. 状态分类（常返/瞬变，周期性）**
-   **类 $C_1 = \{1, 2\}$**：
    -   **常返性**：这是一个有限状态的闭集，因此其中的状态都是**正常返（Positive Recurrent）**的。
    -   **周期性**：检查状态 1，由于 $P_{11} = 1/2 > 0$，即一步可返回自身，故周期 $d(1) = 1$。因为周期性是类性质，故该类为**非周期（Aperiodic）**的。

-   **类 $C_2 = \{3, 4, 5\}$**：
    -   **常返性**：这是一个有限状态的闭集，因此其中的状态都是**正常返（Positive Recurrent）**的。
    -   **周期性**：
        -   从状态 3 出发返回 3 的路径：$3 \to 4 \to 3$（步数 2），$3 \to 4 \to 5 \to 4 \to 3$（步数 4）。
        -   从状态 4 出发返回 4 的路径：$4 \to 3 \to 4$（步数 2），$4 \to 5 \to 4$（步数 2）。
        -   集合 $\{3, 4, 5\}$ 具有二部图结构：$\{4\}$ 与 $\{3, 5\}$ 交替。从 $\{3, 5\}$ 必须去 $\{4\}$，从 $\{4\}$ 必须去 $\{3, 5\}$。
        -   所有回路的长度均为偶数，最大公约数 $d = \gcd\{2, 4, \dots\} = 2$。
        -   故该类是**周期为 2** 的。

---

#### 第二部分：分析矩阵 $P_2$

$$ \mathrm{P}_2=\left( \begin{matrix} {\frac{1} {2}} & {\frac{1} {2}} & {0} & {0} & {0} \\ {\frac{1} {4}} & {0} & {\frac{3} {4}} & {0} & {0} \\ {0} & {0} & {0} & {1} & {0} \\ {0} & {0} & {\frac{1} {2}} & {0} & {\frac{1} {2}} \\ {0} & {0} & {0} & {1} & {0} \\ \end{matrix} \right) $$

**1. 确定连通类**
-   **状态 1 和 2**：
    -   $1 \to 2$ ($P_{12} > 0$)， $2 \to 1$ ($P_{21} > 0$)，故 $1 \leftrightarrow 2$。
    -   但是，从状态 2 可以到达状态 3 ($P_{23} = 3/4 > 0$)。
    -   观察第 3、4、5 行，这三行前两列均为 0，说明一旦进入 $\{3, 4, 5\}$，无法返回 $\{1, 2\}$。
    -   因此，$\{1, 2\}$ 互通，但不是闭集。

-   **状态 3, 4, 5**：
    -   这部分的子矩阵结构与 $P_1$ 完全相同。
    -   $3 \leftrightarrow 4 \leftrightarrow 5$。
    -   这是一个闭集。

**2. 状态分类**
-   **类 $C_1 = \{1, 2\}$**：
    -   **常返性**：由于从该类出发（具体是从状态 2）可以到达类 $C_2$ 且无法返回，存在正概率逃离该集合，故该类中的状态是**瞬变（Transient）**的。
    -   **周期性**：虽然对于瞬变态讨论周期性意义较小，但根据定义 $d(1) = \gcd\{n \mid P_{11}^{(n)} > 0\}$。由于 $P_{11} > 0$，周期为 1。

-   **类 $C_2 = \{3, 4, 5\}$**：
    -   **常返性**：有限闭集，**正常返（Positive Recurrent）**。
    -   **周期性**：结构与 $P_1$ 中相同，**周期为 2**。

---

#### 第三部分：综合回答问题

**(1) 状态空间分类**
*   **对于 $P_1$**：
    *   状态 $\{1, 2\}$：正常返、非周期。
    *   状态 $\{3, 4, 5\}$：正常返、周期为 2。
*   **对于 $P_2$**：
    *   状态 $\{1, 2\}$：瞬变。
    *   状态 $\{3, 4, 5\}$：正常返、周期为 2。

**(2) 连通类**
*   **对于 $P_1$**：有两个连通类 $C_1 = \{1, 2\}$ 和 $C_2 = \{3, 4, 5\}$。
*   **对于 $P_2$**：有两个连通类 $C_1 = \{1, 2\}$ 和 $C_2 = \{3, 4, 5\}$。

**(3) 连通类之间是否互通**
*   **对于 $P_1$**：
    *   $C_1$ 与 $C_2$ **不互通**。
    *   即：从 $C_1$ 无法到达 $C_2$，从 $C_2$ 也无法到达 $C_1$。
*   **对于 $P_2$**：
    *   $C_1$ 与 $C_2$ **单向连通**（$C_1 \to C_2$），但**不互通**。
    *   即：从 $C_1$ 可以到达 $C_2$（通过 $2 \to 3$），但从 $C_2$ 无法到达 $C_1$。

### 答案

**(1) 状态分类：**
*   **$P_1$ 状态空间：**
    *   $\{1, 2\}$：正常返（Positive Recurrent），非周期（Aperiodic）。
    *   $\{3, 4, 5\}$：正常返（Positive Recurrent），周期（Periodic，周期 $d=2$）。
*   **$P_2$ 状态空间：**
    *   $\{1, 2\}$：瞬变（Transient）。
    *   $\{3, 4, 5\}$：正常返（Positive Recurrent），周期（Periodic，周期 $d=2$）。

**(2) 连通类：**
*   **$P_1$ 的连通类：** $C_1 = \{1, 2\}$， $C_2 = \{3, 4, 5\}$。
*   **$P_2$ 的连通类：** $C_1 = \{1, 2\}$， $C_2 = \{3, 4, 5\}$。

**(3) 连通类之间的互通性：**
*   **$P_1$：** 两个连通类之间**互不相通**（即 $C_1 \nleftrightarrow C_2$）。这是一个可约马尔可夫链，且由两个独立的闭集组成。
*   **$P_2$：** 两个连通类之间**不互通**，但存在单向可达性。具体为 $C_1$ 可到达 $C_2$，但 $C_2$ 不可到达 $C_1$（即 $C_1 \to C_2$ 但 $C_2 \nrightarrow C_1$）。

### 知识延伸

1.  **状态空间的分解定理**：
    对于任意马尔可夫链，状态空间 $S$ 可以唯一分解为 $S = T \cup C_1 \cup C_2 \cup \dots$，其中 $T$ 是所有瞬变状态的集合，$C_i$ 是互不相通的常返闭集。
    *   在本题 $P_2$ 中，$T=\{1, 2\}$，$C_1=\{3, 4, 5\}$。

2.  **有限状态马尔可夫链的性质**：
    *   不可能所有状态都是瞬变的。
    *   如果是不可约的（只有一个连通类），则所有状态都是正常返的。
    *   如果一个连通类是闭集且有限，则该类是常返的。
    *   如果一个连通类不是闭集（能出去回不来），则该类是瞬变的。

3.  **周期的判定技巧**：
    *   周期 $d_i = \gcd\{n \geq 1 \mid P_{ii}^{(n)} > 0\}$。
    *   只要发现矩阵对角线上有非零元素 $P_{ii} > 0$，则该状态（及其所在的类）必定是非周期的（$d=1$）。
    *   对于二部图结构（状态分为两组 $A, B$，只能 $A \to B \to A$），周期通常为 2 的倍数。

---

## 习题3.5

### 题目

某地区的天气状况可分为多云和阴天两种，分别记为1和2，并用马尔可夫链 $\mathrm{X}=( X_{n} , \; \; n \geq0 )$ 描述， 其转移概率矩阵为 $$ \mathrm{P}=\left( \begin{matrix} {\frac{1} {2}} & {\frac{1} {2}} \\ {\frac{1} {3}} & {\frac{2} {3}} \\ \end{matrix} \right) $$ 如果已知今天是多云，求3天、5天、10天及更长时间以后天气状况的分布规律。

### 解答

**Revising Solution Approach**

I've checked the eigenvector calculations and matrix inversions again, ensuring precision. The formula for the probability at each step seems accurate, confirmed against the limiting distribution. Preparing to write the formal solution with LaTeX, explicitly showing the probability vectors for n=3, 5, and 10, alongside the long-term probabilities, emphasizing the mathematical framework for the expert.


### 题目分析

本题考查的核心概念是**齐次马尔可夫链（Homogeneous Markov Chain）**的**$n$步转移概率**及**平稳分布（极限分布）**。
题目给出了状态空间 $S=\{1, 2\}$（1代表多云，2代表阴天）以及一步转移概率矩阵 $\mathrm{P}$。
已知初始状态为多云（即 $X_0=1$），求解目标是计算 $n$ 天后的状态分布概率向量 $\pi_n$，具体对应 $n=3, 5, 10$ 以及 $n \to \infty$ 的情况。
解题的关键在于计算矩阵的 $n$ 次幂 $\mathrm{P}^n$，通常利用**矩阵的谱分解（特征值分解）**方法来处理。

### 解题过程

#### 1. 设定模型与参数

设状态 1 为多云，状态 2 为阴天。
一步转移概率矩阵为：
$$ \mathrm{P}=\left( \begin{matrix} {\frac{1} {2}} & {\frac{1} {2}} \\ {\frac{1} {3}} & {\frac{2} {3}} \\ \end{matrix} \right) $$
已知今天是多云，即初始分布向量为 $\pi_0 = (1, 0)$。
$n$ 天后的天气分布 $\pi_n$ 由下式给出：
$$ \pi_n = \pi_0 \mathrm{P}^n $$
由于 $\pi_0 = (1, 0)$，$\pi_n$ 实际上就是矩阵 $\mathrm{P}^n$ 的第一行向量。

#### 2. 矩阵 $\mathrm{P}$ 的特征值分解

为了计算 $\mathrm{P}^n$，我们需要求出 $\mathrm{P}$ 的特征值和特征向量。
特征方程为 $|\lambda \mathrm{I} - \mathrm{P}| = 0$：
$$ \det\left( \begin{matrix} \lambda - \frac{1}{2} & -\frac{1}{2} \\ -\frac{1}{3} & \lambda - \frac{2}{3} \end{matrix} \right) = (\lambda - \frac{1}{2})(\lambda - \frac{2}{3}) - \frac{1}{6} = \lambda^2 - \frac{7}{6}\lambda + \frac{1}{3} - \frac{1}{6} = \lambda^2 - \frac{7}{6}\lambda + \frac{1}{6} = 0 $$
解得特征值为：
$$ \lambda_1 = 1, \quad \lambda_2 = \frac{1}{6} $$

求对应的特征向量：
1.  对于 $\lambda_1 = 1$，解方程 $(\mathrm{P} - \mathrm{I})x = 0$：
    $$ \left( \begin{matrix} -\frac{1}{2} & \frac{1}{2} \\ \frac{1}{3} & -\frac{1}{3} \end{matrix} \right) \left( \begin{matrix} x_1 \\ x_2 \end{matrix} \right) = 0 \implies x_1 = x_2 $$
    取特征向量 $u_1 = (1, 1)^T$。

2.  对于 $\lambda_2 = \frac{1}{6}$，解方程 $(\mathrm{P} - \frac{1}{6}\mathrm{I})x = 0$：
    $$ \left( \begin{matrix} \frac{1}{3} & \frac{1}{2} \\ \frac{1}{3} & \frac{1}{2} \end{matrix} \right) \left( \begin{matrix} x_1 \\ x_2 \end{matrix} \right) = 0 \implies \frac{1}{3}x_1 + \frac{1}{2}x_2 = 0 \implies 2x_1 + 3x_2 = 0 $$
    取特征向量 $u_2 = (3, -2)^T$。

构造相似变换矩阵 $\mathrm{U}$ 及其逆矩阵 $\mathrm{U}^{-1}$：
$$ \mathrm{U} = (u_1, u_2) = \left( \begin{matrix} 1 & 3 \\ 1 & -2 \end{matrix} \right) $$
$$ \det(\mathrm{U}) = -2 - 3 = -5 $$
$$ \mathrm{U}^{-1} = \frac{1}{-5} \left( \begin{matrix} -2 & -3 \\ -1 & 1 \end{matrix} \right) = \left( \begin{matrix} \frac{2}{5} & \frac{3}{5} \\ \frac{1}{5} & -\frac{1}{5} \end{matrix} \right) $$

#### 3. 计算 $\mathrm{P}^n$ 的通项公式

利用公式 $\mathrm{P}^n = \mathrm{U} \Lambda^n \mathrm{U}^{-1}$：
$$ \mathrm{P}^n = \left( \begin{matrix} 1 & 3 \\ 1 & -2 \end{matrix} \right) \left( \begin{matrix} 1^n & 0 \\ 0 & (\frac{1}{6})^n \end{matrix} \right) \left( \begin{matrix} \frac{2}{5} & \frac{3}{5} \\ \frac{1}{5} & -\frac{1}{5} \end{matrix} \right) $$
$$ = \left( \begin{matrix} 1 & 3(\frac{1}{6})^n \\ 1 & -2(\frac{1}{6})^n \end{matrix} \right) \left( \begin{matrix} \frac{2}{5} & \frac{3}{5} \\ \frac{1}{5} & -\frac{1}{5} \end{matrix} \right) $$
我们只需要计算 $\mathrm{P}^n$ 的第一行元素（对应初始状态为多云）：
$$ p_{11}^{(n)} = 1 \cdot \frac{2}{5} + 3\left(\frac{1}{6}\right)^n \cdot \frac{1}{5} = \frac{2}{5} + \frac{3}{5}\left(\frac{1}{6}\right)^n $$
$$ p_{12}^{(n)} = 1 \cdot \frac{3}{5} + 3\left(\frac{1}{6}\right)^n \cdot \left(-\frac{1}{5}\right) = \frac{3}{5} - \frac{3}{5}\left(\frac{1}{6}\right)^n $$

因此，$n$ 天后天气分布的通项公式为：
$$ \pi_n = \left( \frac{2}{5} + \frac{3}{5 \cdot 6^n}, \quad \frac{3}{5} - \frac{3}{5 \cdot 6^n} \right) $$

#### 4. 具体计算各时间点的分布

**（1）3天后 ($n=3$)：**
$$ P(X_3=1) = \frac{2}{5} + \frac{3}{5 \cdot 6^3} = 0.4 + \frac{3}{5 \cdot 216} = 0.4 + \frac{1}{360} \approx 0.4028 $$
$$ P(X_3=2) = 1 - P(X_3=1) \approx 0.5972 $$
分布为：$(\frac{145}{360}, \frac{215}{360}) = (\frac{29}{72}, \frac{43}{72})$

**（2）5天后 ($n=5$)：**
$$ P(X_5=1) = \frac{2}{5} + \frac{3}{5 \cdot 6^5} = 0.4 + \frac{1}{5 \cdot 2592} = 0.4 + \frac{1}{12960} \approx 0.400077 $$
$$ P(X_5=2) \approx 0.599923 $$

**（3）10天后 ($n=10$)：**
$$ P(X_{10}=1) = \frac{2}{5} + \frac{3}{5 \cdot 6^{10}} = 0.4 + \frac{1}{5 \cdot 60466176} \approx 0.400000003 $$
$$ P(X_{10}=2) \approx 0.599999997 $$

**（4）更长时间以后 ($n \to \infty$)：**
由于 $|\lambda_2| = 1/6 < 1$，当 $n \to \infty$ 时，$(\frac{1}{6})^n \to 0$。
$$ \lim_{n \to \infty} \pi_n = \left( \frac{2}{5}, \frac{3}{5} \right) = (0.4, 0.6) $$

### 答案

已知今天是多云，未来 $n$ 天的天气分布规律为：
$$ P(X_n=\text{多云}) = \frac{2}{5} + \frac{3}{5}\left(\frac{1}{6}\right)^n, \quad P(X_n=\text{阴天}) = \frac{3}{5} - \frac{3}{5}\left(\frac{1}{6}\right)^n $$

具体数值如下：
1.  **3天后**：多云概率 $\frac{29}{72} \approx 0.4028$，阴天概率 $\frac{43}{72} \approx 0.5972$。
2.  **5天后**：多云概率 $0.4 + \frac{1}{12960} \approx 0.4001$，阴天概率 $\approx 0.5999$。
3.  **10天后**：多云概率极接近 $0.4$，阴天概率极接近 $0.6$（偏差量级为 $10^{-9}$）。
4.  **更长时间以后**：天气状况趋于稳定分布，多云的概率为 $0.4$，阴天的概率为 $0.6$。

### 知识延伸

1.  **平稳分布（Stationary Distribution）**：
    本题中求得的极限分布 $\pi = (0.4, 0.6)$ 即为该马尔可夫链的平稳分布。它满足方程 $\pi \mathrm{P} = \pi$ 且 $\sum \pi_i = 1$。对于遍历的马尔可夫链，无论初始状态如何，系统最终都会收敛到这个分布。

2.  **收敛速度**：
    收敛速度取决于第二大特征值（按模长）的大小。本题中 $\lambda_2 = 1/6$，由于该值很小（接近0），说明系统收敛到平稳分布的速度非常快。这也是为什么仅3天后，概率就已经非常接近极限值 $0.4$ 的原因。

3.  **解题技巧**：
    *   对于 $2 \times 2$ 的随机矩阵 $\mathrm{P}=\left( \begin{matrix} {1-a} & {a} \\ {b} & {1-b} \\ \end{matrix} \right)$，其平稳分布公式为 $\pi = (\frac{b}{a+b}, \frac{a}{a+b})$。本题中 $a=1/2, b=1/3$，代入可直接验证 $\pi = (\frac{1/3}{1/2+1/3}, \frac{1/2}{1/2+1/3}) = (\frac{2}{5}, \frac{3}{5})$。
    *   计算 $\mathrm{P}^n$ 时，务必检查行和是否为1，这是检验计算正确性的简单方法。

---

## 习题3.7

### 题目

假定球逐个地被分配到8个瓮中，各球以相等的可能放到其中任意一个瓮中。间在分配9次后，其中恰有3个瓮不是空的概率是多少？

### 解答

**Evaluating the Problem**

I've carefully analyzed the problem, modeled it mathematically, and determined the total outcomes and the event of interest. I'm currently drafting the solution steps, including defining the sample space, identifying favorable outcomes via a combinatorial approach and the inclusion-exclusion principle. The formula is now almost complete, with the final fraction in LaTeX format.


### 题目分析
本题属于经典的**占位问题（Occupancy Problem）**或**球盒模型（Balls and Bins Model）**。题目考查的核心概念是**古典概型**与**组合数学**中的**容斥原理**（或第二类斯特林数）。具体来说，需要计算将 $n$ 个可辨球放入 $m$ 个可辨瓮中，使得恰好有 $k$ 个瓮非空的概率。

### 解题过程

**1. 建立数学模型**

设球的个数为 $n=9$，瓮的个数为 $m=8$。
由于球是逐个分配的，且每个球落入任意一个瓮的可能性相等，我们可以将球视为**可辨（distinct）**，瓮也是**可辨（distinct）**的。

**2. 计算样本空间总数**

每一个球都有 8 种选择。由于有 9 个球，且各球的选择是独立的，因此样本空间 $\Omega$ 的总样本点数为：
$$|\Omega| = 8^9$$

**3. 计算有利事件样本数**

设事件 $A$ 为“分配 9 次后，恰有 3 个瓮不是空的”。计算该事件包含的样本点数可以分为两步：

*   **第一步：选出非空的瓮**
    从 8 个瓮中任选 3 个作为非空瓮。选法总数为组合数：
    $$\binom{8}{3} = \frac{8 \times 7 \times 6}{3 \times 2 \times 1} = 56$$

*   **第二步：将球放入选定的瓮中且无空瓮**
    现在的问题转化为：将 9 个不同的球全部放入选定的 3 个不同的瓮中，且每个瓮至少有一个球。这等价于求从 9 个元素的集合到 3 个元素的集合的**满射（Surjection）**函数的个数。

    我们可以使用**容斥原理**来计算这种情况的数量。
    设选定的 3 个瓮为 $U_1, U_2, U_3$。
    - 9 个球任意放入这 3 个瓮的方法数为 $3^9$。
    - 减去至少有 1 个瓮为空的情况：$\binom{3}{1} \times 2^9$（选 1 个瓮为空，球放入其余 2 个）。
    - 加上至少有 2 个瓮为空的情况：$\binom{3}{2} \times 1^9$（选 2 个瓮为空，球放入其余 1 个）。
    - 减去 3 个瓮都为空的情况：$\binom{3}{3} \times 0^9 = 0$。

    因此，将 9 个球放入 3 个瓮且无空瓮的方法数 $N$ 为：
    $$N = 3^9 - \binom{3}{1}2^9 + \binom{3}{2}1^9$$
    $$N = 19683 - 3 \times 512 + 3 \times 1$$
    $$N = 19683 - 1536 + 3 = 18150$$

    *注：这也等价于 $3! \times S_2(9, 3)$，其中 $S_2(n, k)$ 是第二类斯特林数。*

*   **综合有利样本数**
    事件 $A$ 的样本点总数为选瓮的方法数乘以放球的方法数：
    $$|A| = \binom{8}{3} \times (3^9 - 3 \times 2^9 + 3) = 56 \times 18150 = 1,016,400$$

**4. 计算概率**

根据古典概型公式，所求概率 $P(A)$ 为：
$$P(A) = \frac{|A|}{|\Omega|} = \frac{\binom{8}{3} (3^9 - 3 \cdot 2^9 + 3)}{8^9}$$

代入数值计算：
$$P(A) = \frac{1,016,400}{134,217,728}$$

约分化简（可选，通常保留公式形式即可，若需数值解）：
$$P(A) \approx 0.00757277$$

### 答案
分配 9 次后，其中恰有 3 个瓮不是空的概率为：
$$ \frac{\binom{8}{3} (3^9 - 3 \times 2^9 + 3)}{8^9} $$
或者写作数值形式：
$$ \frac{1,016,400}{134,217,728} \approx 0.00757 $$

### 知识延伸

1.  **一般公式**：
    将 $n$ 个可辨球放入 $m$ 个可辨盒中，恰好有 $k$ 个盒非空的概率公式为：
    $$ P(X=k) = \frac{\binom{m}{k} \sum_{j=0}^{k} (-1)^j \binom{k}{j} (k-j)^n}{m^n} $$
    其中分子部分的求和项 $ \sum_{j=0}^{k} (-1)^j \binom{k}{j} (k-j)^n $ 等于 $k! S_2(n, k)$。

2.  **第二类斯特林数（Stirling Numbers of the Second Kind）**：
    符号 $S_2(n, k)$ 或 $\left\{ \begin{matrix} n \\ k \end{matrix} \right\}$ 表示将 $n$ 个不同元素拆分为 $k$ 个非空集合的方法数。本题中球是不同的，瓮也是不同的，所以需要乘以 $k!$（瓮的排列）。

3.  **易错点**：
    -   **球的可辨性**：题目中“逐个分配”暗示了球是有次序或可区分的。如果球不可区分（Bose-Einstein统计），分母将变为 $\binom{n+m-1}{m-1}$，解法完全不同。
    -   **空瓮的处理**：直接计算“恰好 3 个非空”比较困难，必须先选定哪 3 个，然后利用容斥原理排除掉这 3 个中还有空瓮的情况，不能简单地认为是 $3^9$。

---

## 习题3.8

### 题目

在一系列独立抛掷一个公平硬币的试验中，以 $N$ 记直至出现连续3 次正面时的抛掷次数。求 (1) $P ( N \leq8 )$ (2) $P ( N=8 )$

### 解答

**Formulating the Presentation**

I'm now carefully structuring the solution, considering the user's specific output format. I'm focusing on concise titles and clear step-by-step explanations, utilizing LaTeX formatting for mathematical expressions. I've also incorporated the self-corrections I identified regarding the explanation of the recurrence relation and the expectation. All is ready to generate the final response.


### 题目分析

本题考查**伯努利试验（Bernoulli Trials）**中的**模式等待时间（Waiting Time for Patterns）**问题。
- **核心概念**：独立重复试验、互斥事件、递推关系（Recurrence Relations）。
- **数学模型**：可以将问题转化为计数问题，即计算长度为 $n$ 且不包含特定模式（连续3次正面，记为 HHH）的序列数量。
- **求解目标**：
  1.  $P(N \leq 8)$：在前8次抛掷中，出现过连续3次正面的概率。
  2.  $P(N = 8)$：恰好在第8次抛掷时，首次完成连续3次正面的概率。

### 解题过程

设每次抛掷硬币的结果为 H (正面) 或 T (反面)，且 $P(H) = P(T) = 1/2$。
令 $a_n$ 表示长度为 $n$ 的抛掷序列中，**不包含**连续3次正面（HHH）的序列总数。
总的可能序列数为 $2^n$。

#### 1. 建立递推关系

对于一个长度为 $n$ 且不含 HHH 的序列，我们考察其结尾情况：
- 如果第 $n$ 次是 T，则前 $n-1$ 次必须是不含 HHH 的合法序列。此类序列数为 $a_{n-1}$。
- 如果第 $n$ 次是 H，则必须向前看：
    - 如果结尾是 HT，则前 $n-2$ 次必须是合法序列。此类序列数为 $a_{n-2}$。
    - 如果结尾是 HHT，则前 $n-3$ 次必须是合法序列。此类序列数为 $a_{n-3}$。
    - 结尾不能是 HHH，因为题目要求序列不含 HHH。

因此，对于 $n \geq 3$，递推公式为：
$$a_n = a_{n-1} + a_{n-2} + a_{n-3}$$

#### 2. 计算 $a_n$ 的值

我们需要计算 $n$ 从 0 到 8 的 $a_n$ 值：
- $n=0$: 空集，视为合法，$a_0 = 1$
- $n=1$: H, T，均合法，$a_1 = 2$
- $n=2$: HH, HT, TH, TT，均合法，$a_2 = 4$
- $n=3$: HHH 不合法，其余 $2^3 - 1 = 7$ 个合法，$a_3 = 7$

验证递推：$a_3 = a_2 + a_1 + a_0 = 4 + 2 + 1 = 7$（成立）。

继续计算后续项：
$$a_4 = a_3 + a_2 + a_1 = 7 + 4 + 2 = 13$$
$$a_5 = a_4 + a_3 + a_2 = 13 + 7 + 4 = 24$$
$$a_6 = a_5 + a_4 + a_3 = 24 + 13 + 7 = 44$$
$$a_7 = a_6 + a_5 + a_4 = 44 + 24 + 13 = 81$$
$$a_8 = a_7 + a_6 + a_5 = 81 + 44 + 24 = 149$$

#### 3. 求解 (1) $P(N \leq 8)$

事件 $\{N \leq 8\}$ 等价于“前8次试验中出现了 HHH”。
其对立事件 $\{N > 8\}$ 等价于“前8次试验中**没有**出现 HHH”。

根据定义，长度为 8 且不含 HHH 的序列数为 $a_8 = 149$。
总序列数为 $2^8 = 256$。

$$P(N > 8) = \frac{a_8}{2^8} = \frac{149}{256}$$

因此：
$$P(N \leq 8) = 1 - P(N > 8) = 1 - \frac{149}{256} = \frac{107}{256}$$

#### 4. 求解 (2) $P(N = 8)$

事件 $\{N = 8\}$ 意味着第 8 次抛掷完成了首次 HHH。这要求：
1.  第 6, 7, 8 次抛掷结果必须是 H, H, H。
2.  为了保证这是**首次**出现，第 5 次抛掷必须是 T（否则 HHH 会在第 7 次或更早完成）。
3.  前 4 次抛掷构成的序列必须不包含 HHH。

因此，满足条件的序列结构为：
$$ \underbrace{X_1 X_2 X_3 X_4}_{\text{不含HHH}} \quad \underbrace{T}_{X_5} \quad \underbrace{H \quad H \quad H}_{X_6, X_7, X_8} $$

满足条件的序列数等于长度为 4 且不含 HHH 的序列数，即 $a_4$。
我们已知 $a_4 = 13$。

所以：
$$P(N = 8) = \frac{a_4}{2^8} = \frac{13}{256}$$

---

### 答案

(1) $P(N \leq 8) = \frac{107}{256}$

(2) $P(N = 8) = \frac{13}{256}$

---

### 知识延伸

1.  **Tribonacci 数列**：本题中 $a_n$ 的递推关系 $a_n = a_{n-1} + a_{n-2} + a_{n-3}$ 类似于斐波那契数列，被称为 Tribonacci 数列（三波那契数列）的变体。
2.  **通用公式**：对于首次出现连续 $k$ 次正面的等待时间 $N$，其概率分布满足：
    $$P(N=n) = \frac{a_{n-k-1}}{2^n}, \quad \text{对于 } n > k$$
    其中 $a_m$ 是长度为 $m$ 不含该模式的序列数。
3.  **期望值**：首次出现连续 $k$ 次正面的平均等待时间公式为 $E[N] = 2^{k+1} - 2$。对于本题 $k=3$，期望值为 $2^4 - 2 = 14$。
4.  **易错点**：计算 $P(N=n)$ 时，容易直接认为是在 $a_{n-1}$ 的基础上加一个 H，而忽略了必须确保 HHH 是**首次**出现，因此必须强制第 $n-k$ 位为 T（反面）。

---

## 习题3.10

### 题目

甲， $\mathrm{Z}$ ，丙三人玩游戏。试讨论规则的公平性：丙是仲裁，掷一均匀硬币多次。 （1）若第一次出现正面，则甲胜；否则，乙胜。 （2）若前三次出现的是“正正反”，则甲胜；若前三次出现的是“正正正”，则乙胜；其他情形，和。 （3）依次记录掷硬币结果，若“正正反”先出现，则甲胜；若“正正正”先出现则乙胜。 (4）依次记录掷硬币结果，若“正正反”先出现，则甲胜；若“正反反”先出现，则乙胜。

### 解答

**Refining the Approach**

The analysis of the problem is complete. I'm now transitioning to formalizing the solutions, especially for scenarios 3 and 4, employing state diagrams and conditional probability. Further, I am confirming the findings using Conway's algorithm for scenario 4 to validate the probabilities and ensure accuracy. All LaTeX commands are checked.


### 题目分析

本题主要考查**古典概型**、**独立重复试验（伯努利试验）**以及**随机过程中的模式匹配（Pattern Matching）**问题。
1.  第（1）和（2）问属于基础的古典概率计算，通过列举样本空间即可求解。
2.  第（3）和（4）问涉及无穷序列中的“首达时间”或“模式竞争”问题，本质上是**Penney's Game（彭尼游戏）**的变种。解决这类问题通常采用**条件概率法**、**马尔可夫链（Markov Chain）状态分析**或**鞅（Martingale）**的方法。
3.  目标是计算甲、乙获胜的概率，从而判断游戏规则是否公平（即判断获胜概率是否相等）。

---

## 习题3.11

### 题目

某人有 $M$ 把伞并在办公室和家之间往返：出门上班时下雨并家里有伞就带把伞去办公室；下班回家时下雨且办公室有伞就带把伞回家，其它时候都不带伞。假设每天上下班时是否下雨是独立同分布的，下雨的概率为 $p$ ，不下雨的概率为 $1-p$ ，问此人出门上班时碰到下雨且没有雨伞的概率。

### 解答

**Problem Refinement**

The model is now solidified; the state space and transitions are confirmed to be accurate. The stationary distribution has been derived and verified for the general case, and a specific check for M=1 was performed. Analysis, solution, answer, and knowledge extension will now be written.


### 题目分析

本题考查**离散时间马尔可夫链（Discrete-time Markov Chain, DTMC）** 的建立与平稳分布的求解。

*   **符号识别**：$M$ 为雨伞总数，$p$ 为下雨概率，$1-p$ 为不下雨概率（通常记为 $q$）。
*   **核心概念**：通过定义状态（当前地点的雨伞数量），构建状态转移矩阵，利用马尔可夫链的遍历性求出平稳分布（Stationary Distribution）。
*   **求解目标**：计算“出门上班时碰到下雨且没有雨伞”的概率，即求出长远来看当前地点没有雨伞的平稳概率 $\pi_0$，再乘以发生下雨的概率 $p$。

### 解题过程

**1. 建立马尔可夫链模型**

设 $X_n$ 表示第 $n$ 次行程开始前，**当前出发地点**（家或办公室）拥有的雨伞数量。
状态空间为 $S = \{0, 1, 2, \dots, M\}$。

**2. 分析状态转移概率**

记 $q = 1-p$ 为不下雨的概率。
假设当前地点有 $i$ 把伞，则目的地有 $M-i$ 把伞。
我们分析从当前状态 $i$ 转移到下一次行程出发时的状态 $j$（即到达目的地后的雨伞数量）：

*   **情形 1：当前没有伞 ($i=0$)**
    无论是否下雨，都无法带伞。
    到达目的地后，目的地原有的伞数为 $M-0 = M$。
    因此，下一次出发时的状态必然是 $M$。
    $$P_{0, M} = 1$$

*   **情形 2：当前有伞 ($i \in \{1, 2, \dots, M\}$)**
    *   **如果下雨（概率 $p$）**：带走 1 把伞。
        到达目的地时，目的地原有的伞数为 $M-i$，加上带来的 1 把，共 $M-i+1$ 把。
        即转移到状态 $M-i+1$。
    *   **如果不下雨（概率 $q$）**：不带伞。
        到达目的地时，目的地原有的伞数为 $M-i$。
        即转移到状态 $M-i$。

综上，转移概率 $P_{ij}$ 为：
$$
\begin{cases}
P_{0, M} = 1 \\
P_{i, M-i+1} = p, & i \neq 0 \\
P_{i, M-i} = q, & i \neq 0
\end{cases}
$$

**3. 建立平稳分布方程**

设平稳分布为 $\pi = (\pi_0, \pi_1, \dots, \pi_M)$。根据平稳方程 $\pi_j = \sum_{i} \pi_i P_{ij}$ 列出方程组：

*   **对于状态 $0$**：
    只有当 $i=M$ 且不下雨（转移到 $M-M=0$）时才会进入状态 0。
    $$\pi_0 = \pi_M \cdot q \quad \cdots\cdots (1)$$

*   **对于状态 $M$**：
    当 $i=0$（必然转移到 $M$）或 $i=1$ 且下雨（转移到 $M-1+1=M$）时进入状态 $M$。
    $$\pi_M = \pi_0 \cdot 1 + \pi_1 \cdot p \quad \cdots\cdots (2)$$

*   **对于中间状态 $k$ ($1 \le k < M$)**：
    进入状态 $k$ 有两种可能：
    1. 从状态 $i$ 不下雨转移而来：$M-i = k \Rightarrow i = M-k$。
    2. 从状态 $i$ 下雨转移而来：$M-i+1 = k \Rightarrow i = M-k+1$。
    $$\pi_k = \pi_{M-k} \cdot q + \pi_{M-k+1} \cdot p \quad \cdots\cdots (3)$$

**4. 求解平稳分布**

将 $(1)$ 代入 $(2)$：
$$
\pi_M = q \pi_M + p \pi_1 \implies \pi_M(1-q) = p \pi_1 \implies p \pi_M = p \pi_1
$$
由于 $p > 0$，可得：
$$\pi_1 = \pi_M$$

接下来利用方程 $(3)$ 递推。
当 $k=1$ 时：
$$\pi_1 = \pi_{M-1} \cdot q + \pi_M \cdot p$$
因为 $\pi_1 = \pi_M$，代入得：
$$\pi_M = \pi_{M-1} \cdot q + \pi_M \cdot p \implies \pi_M(1-p) = \pi_{M-1} \cdot q \implies q \pi_M = q \pi_{M-1}$$
由于 $q > 0$，可得：
$$\pi_{M-1} = \pi_M$$

同理，假设 $\pi_{k+1} = \dots = \pi_M$，代入方程 $(3)$ 可归纳得出所有非零状态概率相等：
$$\pi_1 = \pi_2 = \dots = \pi_M$$

设 $\pi_1 = \pi_2 = \dots = \pi_M = C$。
由方程 $(1)$ 可知：
$$\pi_0 = q C$$

利用归一化条件 $\sum_{k=0}^M \pi_k = 1$：
$$
\pi_0 + \sum_{k=1}^M \pi_k = 1 \\
q C + M \cdot C = 1 \\
C(q + M) = 1 \implies C = \frac{1}{M+q}
$$

因此，当前地点没有雨伞的平稳概率为：
$$\pi_0 = \frac{q}{M+q}$$

**5. 计算目标概率**

题目要求“出门上班时碰到下雨且没有雨伞”的概率。
设事件 $A$ 为“下雨”，事件 $B$ 为“当前地点没有雨伞”。
由于下雨与当前雨伞数量独立（雨伞数量取决于之前的过程，当次下雨是独立的随机事件）：
$$P(\text{淋雨}) = P(A \cap B) = P(A) \cdot P(B) = p \cdot \pi_0$$

代入 $\pi_0$ 的值：
$$P(\text{淋雨}) = p \cdot \frac{q}{M+q}$$

将 $q = 1-p$ 代入：
$$P(\text{淋雨}) = \frac{p(1-p)}{M + 1 - p}$$

### 答案

此人出门上班时碰到下雨且没有雨伞的概率为：
$$ \frac{p(1-p)}{M + 1 - p} $$

### 知识延伸

1.  **马尔可夫链的遍历性**：本题中的马尔可夫链是不可约且非周期的（当 $0 < p < 1$ 时），因此存在唯一的平稳分布，且该分布与初始状态无关。
2.  **对称性分析**：由于家和办公室的规则完全对称，$\pi_i$ 既表示在家的雨伞数为 $i$ 的概率，也表示在办公室雨伞数为 $i$ 的概率。
3.  **边界情况检查**：
    *   若 $M$ 很大，$\pi_0 \to 0$，淋雨概率趋近于 0，符合直觉。
    *   若 $p=0$ 或 $p=1$，淋雨概率均为 0。$p=0$ 不下雨自然不淋雨；$p=1$ 每次都带伞，只要 $M \ge 1$，伞会在两地间搬运，永远不会缺伞（注：当 $p=1$ 时链变为周期性，需特殊讨论，但公式极限成立）。
4.  **易错点**：容易混淆“平稳分布 $\pi_0$”与“最终答案”。$\pi_0$ 仅表示没伞的概率，必须乘以“下雨”的概率 $p$ 才是淋雨的概率。

---

## 习题3.12

### 题目

假设 $\mathrm{X}=( X_{n} , \; \; n \geq0 )$ 是马尔可夫链是Markov 链，状态空间为 $\{1 , ~ 2 , ~ \dots, ~ m \}$ ，转移概率矩阵为 $$ \mathrm{P}=\left( \begin{matrix} {p_{0}} & {p_{1}} & {p_{2}} & {\cdots} & {p_{m}} \\ {p_{m}} & {p_{1}} & {p_{2}} & {\cdots} & {p_{m-1}} \\ {\vdots} & {\vdots} & {\vdots} & {} & {\vdots} \\ {p_{1}} & {p_{2}} & {p_{3}} & {\cdots} & {p_{0}} \\ \end{matrix} \right) $$ 共中 $0 < p_{0} < 1 , \; \; p_{0}+p_{1}+\; \cdot\; \cdot\; \cdot\;+p_{m}=1$ * $\operatorname* {l i m}_{n \rightarrow\infty} p_{i j}^{( n )}$ 以及平稳分布。

### 解答

**Reviewing Solution Draft**

I'm now revising my draft, focusing on clarity and precision. The core logic is sound: recognizing the matrix's doubly stochastic nature leads to the uniform stationary distribution, which determines the long-term behavior. I'm verifying the LaTeX formatting and clarifying the connection between the matrix structure and its implications for the limit. I'm also adding a Chinese translation of "Circulant Matrix" to improve the final response. Finally, I'm ensuring there's a smooth flow of logic from analysis to final answer.


### 题目分析

本题考查的是**有限状态齐次马尔可夫链**的**极限性质**与**平稳分布**。

1.  **符号识别**：题目给出的转移概率矩阵 $P$ 的元素下标从 $0$ 到 $m$，且满足 $\sum_{k=0}^m p_k = 1$。这意味着状态空间的大小为 $N = m+1$（尽管题目文字描述为 $\{1, \dots, m\}$，但根据矩阵结构和概率归一化条件，状态空间应理解为 $m+1$ 个状态，不妨记为 $\{0, 1, \dots, m\}$）。
2.  **矩阵结构**：观察矩阵的第一行 $(p_0, p_1, \dots, p_m)$ 和最后一行 $(p_1, p_2, \dots, p_0)$，结合此类习题的常规设置，该矩阵为一个**循环矩阵**（Circulant Matrix）。此类矩阵的一个关键性质是**双随机性**（Doubly Stochastic），即不仅行和为1，列和也为1。
3.  **核心考点**：
    *   马尔可夫链的遍历性（Irreducibility）和非周期性（Aperiodicity）。
    *   双随机矩阵的平稳分布特性。
    *   极限分布 $\lim_{n \to \infty} p_{ij}^{(n)}$ 的计算。

### 解题过程

#### 1. 确定马尔可夫链的性质

设状态空间为 $S = \{0, 1, 2, \dots, m\}$，状态总数为 $N = m+1$。
转移概率矩阵 $P$ 为循环矩阵，其一般形式为 $P_{ij} = p_{(j-i) \pmod{N}}$。

**（1）非周期性 (Aperiodicity)**
题目给定条件 $0 < p_0 < 1$。
由于 $P_{ii} = p_0 > 0$，即状态存在自环，马尔可夫链的周期 $d=1$。因此，该链是**非周期**的。

**（2）不可约性 (Irreducibility)**
在一般的循环随机游走问题中，只要 $p_k$ 的分布不集中在某个子群上，链即为不可约的。鉴于 $p_0 > 0$ 且通常假设 $p_k$ 的分布能遍历所有状态（这是此类教科书习题的默认假设），该链是**不可约**的。

综上，该马尔可夫链是**遍历的**（Ergodic），因此极限 $\lim_{n \rightarrow\infty} p_{i j}^{( n )}$ 存在且与初始状态 $i$ 无关。

#### 2. 验证矩阵的双随机性

观察矩阵 $P$ 的结构：
$$ \mathrm{P}=\left( \begin{matrix} {p_{0}} & {p_{1}} & {p_{2}} & {\cdots} & {p_{m}} \\ {p_{m}} & {p_{0}} & {p_{1}} & {\cdots} & {p_{m-1}} \\ {\vdots} & {\vdots} & {\vdots} & {} & {\vdots} \\ {p_{1}} & {p_{2}} & {p_{3}} & {\cdots} & {p_{0}} \\ \end{matrix} \right) $$
*(注：修正了题目中第二行的排版错误，使其符合循环矩阵的标准形式)*

*   **行和**：由定义知 $\sum_{j=0}^m P_{ij} = \sum_{k=0}^m p_k = 1$。
*   **列和**：对于任意第 $j$ 列，其元素由向量 $(p_0, p_1, \dots, p_m)$ 的某种循环排列组成。因此，第 $j$ 列的元素之和为：
    $$ \sum_{i=0}^m P_{ij} = p_0 + p_1 + \dots + p_m = 1 $$

因为行和与列和均为 1，所以 $P$ 是一个**双随机矩阵**（Doubly Stochastic Matrix）。

#### 3. 求解平稳分布

设平稳分布为 $\boldsymbol{\pi} = (\pi_0, \pi_1, \dots, \pi_m)$。
平稳分布需满足方程组：
$$ \begin{cases} \boldsymbol{\pi} = \boldsymbol{\pi} P \\ \sum_{j=0}^m \pi_j = 1 \end{cases} $$

分量形式为：
$$ \pi_j = \sum_{i=0}^m \pi_i P_{ij}, \quad j = 0, 1, \dots, m $$

对于双随机矩阵，我们尝试验证**均匀分布**是否为解。
设 $\pi_i = C$（常数），代入方程右边：
$$ \sum_{i=0}^m C \cdot P_{ij} = C \sum_{i=0}^m P_{ij} $$
利用列和为 1 的性质：
$$ C \sum_{i=0}^m P_{ij} = C \cdot 1 = C $$
即 $\pi_j = C$ 成立。

由归一化条件 $\sum_{j=0}^m \pi_j = 1$ 得：
$$ \sum_{j=0}^m C = (m+1)C = 1 \implies C = \frac{1}{m+1} $$

因此，平稳分布为：
$$ \pi_j = \frac{1}{m+1}, \quad j=0, 1, \dots, m $$

#### 4. 求解极限概率

根据马尔可夫链的极限定理，对于有限状态、不可约且非周期的马尔可夫链，有：
$$ \lim_{n \rightarrow\infty} p_{i j}^{( n )} = \pi_j $$

代入我们求得的平稳分布：
$$ \lim_{n \rightarrow\infty} p_{i j}^{( n )} = \frac{1}{m+1} $$

### 答案

1.  **平稳分布**为均匀分布：
    $$ \boldsymbol{\pi} = \left( \frac{1}{m+1}, \frac{1}{m+1}, \dots, \frac{1}{m+1} \right) $$

2.  **极限概率**为：
    $$ \lim_{n \rightarrow\infty} p_{i j}^{( n )} = \frac{1}{m+1} $$

### 知识延伸

1.  **双随机矩阵（Doubly Stochastic Matrix）**：
    *   定义：所有元素非负，且每一行之和为1，每一列之和也为1的方阵。
    *   **重要性质**：如果一个有限状态马尔可夫链的转移矩阵是双随机的，且该链是不可约和非周期的，那么其平稳分布一定是**均匀分布**。这是解此类题目的捷径。

2.  **循环矩阵（Circulant Matrix）**：
    *   本题中的矩阵是循环矩阵，它是双随机矩阵的一种特例。
    *   在随机过程中，这通常对应于“圆周上的随机游走”（Random Walk on a Circle）。

3.  **易错点提示**：
    *   **状态空间大小**：题目中下标从 $0$ 到 $m$，共有 $m+1$ 个状态。计算均匀分布概率时分母应为 $m+1$ 而非 $m$。
    *   **非周期性判定**：只要对角线元素 $P_{ii} > 0$（即 $p_0 > 0$），链就是非周期的，无需计算复杂的最大公约数。

---

## 习题3.13

### 题目

N 个总体中的任一个个体在每个时可能极也可能消极。如果一个个体在某时段积极，那么与所有其他个体独立。他在下一个时也积极的概率是 $\alpha$ 。类似地，如果一个个体在某时段消极，那么与所有其他个体独立， 他在下一个时段也消积的概率是 $\beta$ 。令 $\mathrm{X}_{n}$ 表在时段 $n$ 积极的个体数 (a)证明 $\{X_{n} , \; \; n \geq0 \}$ 是马尔可夫链 (b)求 $\operatorname{E} [ X_{n} | X_{0}=i ]$ (c)推导转移概率得表达式 (d）求恰有 $j$ 个个体积极的长程时间比例。提示:首先考 $N=1$ 的情形

### 解答

**Revising Solution Approach**

I'm now focusing on refining the solution process.  Specifically, I'm verifying the independence argument for the stationary distribution, and double-checking that the binomial convolution in part (c) is properly formulated and written up. Also, ensuring that all LaTeX commands are correctly embedded for a readable output.


### 题目分析

本题考察的是**离散时间马尔可夫链（DTMC）**的建模与性质分析。
1.  **系统模型**：由 $N$ 个相互独立的个体组成，每个个体的状态在“积极”与“消极”之间按给定概率转移。
2.  **核心变量**：$X_n$ 表示时刻 $n$ 处于“积极”状态的个体总数。
3.  **数学工具**：
    *   马尔可夫性的定义。
    *   二项分布（Binomial Distribution）及其卷积。
    *   条件期望与线性递推关系。
    *   马尔可夫链的平稳分布（Stationary Distribution）。
4.  **求解目标**：证明马尔可夫性、计算条件期望、推导转移概率矩阵、求解平稳分布。

---

