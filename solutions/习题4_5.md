# 习题4.5

## 题目

以 $S_{n}$ 记具有到达间隔分布函数 $\mathit{F}$ 的更新过程 $\{N ( t ) , ~ t \geq0 \}$ 的第 $n$ 个事件时刻。 (1）间 $P \{N ( t )=n | S_{n}=y \}$ 是什么？ (2)从 $P \{N ( t )=n \}=\int_{0}^{\infty} P \left\{N \left( \mathbf{t} \right)=n | S_{n}=y \right\} \! f_{S_{n}} \left( y \right) \mathrm{d} y$ 开始，利用 $n$ 个速率为 $\lambda$ 的独立指数随机变量的和具有参数为 $( n , ~ \lambda)$ 的伽马分布，当 $F ( y )=1-e^{-\lambda y}$ 时计算 $P \{N ( t )=n \}$ .

## 解答

**Refining Solution Process**

\n\n

I've just finished meticulously working through the integration in Part (2), confirming the derivation leads directly to the Poisson probability mass function. The LaTeX is checked and ready. I am now formulating the concise answer and will add the extensions and concepts, then I will edit the formatting and tone. The goal is to provide a comprehensive, concise, and mathematically rigorous solution.


### 题目分析

本题考查**更新过程（Renewal Process）**的基本性质以及**泊松过程**的特性。
1.  题目首先要求建立计数过程 $N(t)$ 的取值与第 $n$ 个到达时刻 $S_n$ 之间的条件概率关系。这是理解更新过程核心关系 $\{N(t) = n\} \iff \{S_n \leq t < S_{n+1}\}$ 的关键。
2.  其次，题目要求在到达间隔服从指数分布（即泊松过程）的特定情况下，利用全概率公式和伽马分布（Gamma Distribution）的概率密度函数，推导出 $N(t)$ 服从泊松分布的结论。这验证了泊松过程定义的等价性。

### 解题过程

#### (1) 求解 $P \{N ( t )=n | S_{n}=y \}$

根据更新过程的定义，$N(t)$ 表示到时刻 $t$ 为止发生的事件总数，$S_n$ 表示第 $n$ 个事件发生的时刻。
事件 $\{N(t) = n\}$ 等价于第 $n$ 个事件发生在时刻 $t$ 之前（或时刻 $t$），且第 $n+1$ 个事件发生在时刻 $t$ 之后。即：
$$ \{N(t) = n\} \iff \{S_n \leq t < S_{n+1}\} $$

我们需要计算条件概率 $P \{N ( t )=n | S_{n}=y \}$。
将上述等价关系代入，得到：
$$ P \{N ( t )=n | S_{n}=y \} = P \{S_n \leq t < S_{n+1} | S_{n}=y \} $$

这里需要分两种情况讨论 $y$ 与 $t$ 的关系：

**情况 1：** 当 $y > t$ 时
由于已知 $S_n = y > t$，说明第 $n$ 个事件在时刻 $t$ 之后才发生，因此在时刻 $t$ 时事件发生的次数必定小于 $n$，即 $N(t) < n$。
所以此时：
$$ P \{N ( t )=n | S_{n}=y \} = 0 $$

**情况 2：** 当 $y \leq t$ 时
代入 $S_n = y$，条件变为：
$$ P \{y \leq t < S_{n+1} | S_{n}=y \} $$
由于 $y \leq t$ 是已知条件（常数比较），不等式左半部分 $y \leq t$ 恒成立，只需考虑右半部分：
$$ P \{S_{n+1} > t | S_{n}=y \} $$
根据更新过程的定义，$S_{n+1} = S_n + X_{n+1}$，其中 $X_{n+1}$ 是第 $n+1$ 个到达间隔，且 $X_{n+1}$ 与之前的到达时刻 $S_n$ 相互独立。
$$ \begin{aligned} P \{S_{n+1} > t | S_{n}=y \} &= P \{S_n + X_{n+1} > t | S_{n}=y \} \\ &= P \{y + X_{n+1} > t | S_{n}=y \} \\ &= P \{X_{n+1} > t - y \} \quad (\text{利用独立性}) \end{aligned} $$
设到达间隔的分布函数为 $F(x) = P(X \leq x)$，则互补累积分布函数（生存函数）为 $\bar{F}(x) = 1 - F(x)$。
因此：
$$ P \{X_{n+1} > t - y \} = 1 - F(t - y) $$

**综上所述：**
$$ P \{N ( t )=n | S_{n}=y \} = \begin{cases} 1 - F(t - y), & \text{若 } y \leq t \\ 0, & \text{若 } y > t \end{cases} $$

---

#### (2) 计算 $P \{N ( t )=n \}$ （当 $F(y) = 1 - e^{-\lambda y}$ 时）

已知到达间隔 $X_i$ 服从参数为 $\lambda$ 的指数分布，即 $F(y) = 1 - e^{-\lambda y}$ ($y \geq 0$)。
此时，$1 - F(t-y) = e^{-\lambda(t-y)}$。

根据题目提示，$S_n = X_1 + \dots + X_n$ 是 $n$ 个独立同分布的指数随机变量之和，服从参数为 $(n, \lambda)$ 的伽马分布（Gamma Distribution）。其概率密度函数 $f_{S_n}(y)$ 为：
$$ f_{S_n}(y) = \frac{\lambda e^{-\lambda y} (\lambda y)^{n-1}}{(n-1)!} = \frac{\lambda^n}{(n-1)!} y^{n-1} e^{-\lambda y}, \quad y \geq 0 $$

利用全概率公式：
$$ P \{N ( t )=n \} = \int_{0}^{\infty} P \{N ( t )=n | S_{n}=y \} f_{S_n} ( y ) \mathrm{d} y $$

根据第 (1) 问的结果，当 $y > t$ 时条件概率为 0，因此积分上限由 $\infty$ 变为 $t$。当 $0 \leq y \leq t$ 时，条件概率为 $e^{-\lambda(t-y)}$。
代入公式：
$$ \begin{aligned} P \{N ( t )=n \} &= \int_{0}^{t} \left( e^{-\lambda(t-y)} \right) \left( \frac{\lambda^n}{(n-1)!} y^{n-1} e^{-\lambda y} \right) \mathrm{d} y \\ &= \int_{0}^{t} e^{-\lambda t} e^{\lambda y} \cdot \frac{\lambda^n}{(n-1)!} y^{n-1} e^{-\lambda y} \mathrm{d} y \\ &= \frac{\lambda^n e^{-\lambda t}}{(n-1)!} \int_{0}^{t} y^{n-1} \underbrace{e^{\lambda y} e^{-\lambda y}}_{1} \mathrm{d} y \\ &= \frac{\lambda^n e^{-\lambda t}}{(n-1)!} \int_{0}^{t} y^{n-1} \mathrm{d} y \end{aligned} $$

计算积分部分：
$$ \int_{0}^{t} y^{n-1} \mathrm{d} y = \left[ \frac{y^n}{n} \right]_{0}^{t} = \frac{t^n}{n} $$

将积分结果代回原式：
$$ \begin{aligned} P \{N ( t )=n \} &= \frac{\lambda^n e^{-\lambda t}}{(n-1)!} \cdot \frac{t^n}{n} \\ &= \frac{(\lambda t)^n}{n!} e^{-\lambda t} \end{aligned} $$

这正是参数为 $\lambda t$ 的泊松分布的概率质量函数。

### 答案

(1)
$$ P \{N ( t )=n | S_{n}=y \} = \begin{cases} 1 - F(t - y), & 0 \leq y \leq t \\ 0, & y > t \end{cases} $$

(2)
$$ P \{N ( t )=n \} = \frac{(\lambda t)^n}{n!} e^{-\lambda t} $$

### 知识延伸

1.  **更新过程基础关系**：本题利用了更新过程中最基本的对偶关系 $N(t) \geq n \iff S_n \leq t$。由此推导出 $N(t)=n \iff S_n \leq t < S_{n+1}$。
2.  **Erlang 分布**：$n$ 个独立同分布的指数随机变量（参数 $\lambda$）之和服从 Erlang 分布（伽马分布的特例，参数为 $n, \lambda$）。这是排队论和可靠性理论中常用的结论。
3.  **泊松过程的定义**：本题实际上是从“到达间隔服从指数分布”这一构造性定义出发，推导出了“任意时刻 $t$ 的计数 $N(t)$ 服从泊松分布”这一性质，验证了泊松过程定义的等价性。
4.  **解题技巧**：在处理涉及 $S_n$ 和 $N(t)$ 的混合概率问题时，条件概率法（Conditioning on arrival times）是非常有力的工具。注意积分区间的截断（由指示函数或条件概率为0的区域决定）是易错点。

---
